2021-01-30  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/tmac.am ($(TMACSTRIPFILES)):
	($(TMACMDOCSTRIPFILES)): Remove unidiomatic for loop which
	frustrated parallel make operation.

	Thanks to an anonymous contributor for the report and patch.

	Fixes <https://savannah.gnu.org/bugs/?59958>.

2021-01-29  G. Branden Robinson <g.branden.robinson@gmail.com>

	* doc/ms.ms (Document control settings): Document old FAM string
	and new FR string.

2021-01-29  T. Kurt Bond <tkurtbond@gmail.com>

	[ms]: Add new string FR to hold an expression for computing the
	footnote length relative to the line length, consistently for
	single- and multi-column modes, which \n[FL] has never done.

	* tmac/s.tmac: Initialize FR string to "11/12".
	(@MC): Compute footnote column width using \*[FR] instead of a
	hard-coded "11/12" expression.
	(par@init): Compute default \n[FL] using \*[FR] instead of a
	hard-coded "11/12" expression.

	* doc/groff.texi (Macro Packages/ms/Document control settings):
	* tmac/groff_ms.7.man (Usage/Document control registers):
	Document it.

	Fixes <https://savannah.gnu.org/bugs/?59605>.

2021-01-25  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/troff/env.cpp: Add ADJUST_MAX enumeration constant to
	record maximum valid numerical adjustment mode.
	(adjust): Verify numeric argument against ADJUST_MAX instead of
	a numeric literal.  Ignore excessively large values instead of
	setting adjustment mode to "right".  Update warning diagnostic.

2021-01-25  G. Branden Robinson <g.branden.robinson@gmail.com>

	Add regression test for .ad and .na requests.

	* src/roff/groff/tests/adjustment_works.sh: Do it.
	* src/roff/groff/groff.am (groff_TESTS): Run test.

2021-01-24  G. Branden Robinson <g.branden.robinson@gmail.com>

	* doc/groff.texi (Manipulating Filling and Adjustment):
	* man/groff.7 (Requests/Request short reference): Clarify
	behavior of ".na" and ".ad l".

	Thanks to Bjarni Ingi Gislason for pointing out the potential
	for confusion and for his careful review of the new text.

	Fixes <https://savannah.gnu.org/bugs/?59795>.

2021-01-20  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/grog/grog.pl: Report program name in fatal error
	diagnostics.  Also drop sentence-ending punctuation since Perl
	supplies additional information.

	Continues the long process of fixing Savannah #52463.

2021-01-19  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-old.tmac (RE): Style-warn if macro arguments are out
	of range or redundant.

	Fixes <https://savannah.gnu.org/bugs/?55320>.

2021-01-15  G. Branden Robinson <g.branden.robinson@gmail.com>

	Improve style of troffrc{,-end} files.  Follow established
	idioms and make them consistent with each other.

	* tmac/troffrc:
	* tmac/troffrc-end:
	  - Identify files in header comments as part of GNU troff.

	* tmac/troffrc:
	  - Clarify purpose of .do request.
	  - Identify .X (set by groff -X) as a register, not a string.
	  - Remove temporary registers one per line to make
	    synchronization with foregoing logic easier.  Fixes name
	    space management nits: an undefined string troffrc!Xps was
	    being removed, and troffrc!{ascii,latin1,utf8,cp1047} were
	    not being removed despite being defined.

	* tmac/troffrc-end:
	  - Clarify that file is read after -m file arguments (not "all
	    macro sets", which can be loaded with .mso after this file
	    is processed).
	  - Advise usage of .do for groff extensions.
	  - Line-break one-off conditionals as troffrc does.
	  - Add empty string comment to empty string definitions.

2021-01-14  Dave Kemper <saint.snit@gmail.com>

	Commit 87edb525, from 2003, added character U+2026 (HORIZONTAL
	ELLIPSIS) to most base groff fonts, but there has been no
	kerning information for this character.  To produce consistent
	typography, it should be kerned the same way as the period,
	which is in 818 kern pairs across all the devps fonts.

	Apply the following shell command to the groff description files
	of the PostScript fonts.

	  for file in font/devps/*[A-Z]
	    do sed -Ei\~ 's/(.*)(^| )\. (.*)/&\n\1\2u2026 \3/' $file
	  done

	* font/devps/AB:
	* font/devps/ABI:
	* font/devps/AI:
	* font/devps/AR:
	* font/devps/BMB:
	* font/devps/BMBI:
	* font/devps/BMI:
	* font/devps/BMR:
	* font/devps/HB:
	* font/devps/HBI:
	* font/devps/HI:
	* font/devps/HNB:
	* font/devps/HNBI:
	* font/devps/HNI:
	* font/devps/HNR:
	* font/devps/HR:
	* font/devps/NB:
	* font/devps/NBI:
	* font/devps/NI:
	* font/devps/NR:
	* font/devps/PB:
	* font/devps/PBI:
	* font/devps/PI:
	* font/devps/PR:
	* font/devps/TB:
	* font/devps/TBI:
	* font/devps/TI:
	* font/devps/TR:
	* font/devps/ZCMI: Apply above script.

	Fixes <https://savannah.gnu.org/bugs/?58897>.  However, this
	will need to be done again if afmtodit is used to regenerate the
	above files, or afmtodit will need to be modified to add this
	kerning information itself.

2021-01-12  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/libs/libgroff/relocate.cpp (set_current_prefix) [WIN32]:
	Move declaration of `pathextstr` to lie within preprocessor
	conditional, since it is dereferenced only there.

2021-01-10  G. Branden Robinson <g.branden.robinson@gmail.com>

	Add support for strsignal().

	POSIX.1-2008 added strsignal() to the C library and recommended
	its use over sys_siglist[], but groff's pipeline management
	hadn't been updated in that respect since that time.

	* configure.ac: Check for strsignal().
	* src/roff/groff/pipeline.c (xstrsignal): Return strsignal() if
	it is defined.

	Thanks to an anonymous contributor for the report and the patch.

	Fixes <https://savannah.gnu.org/bugs/?59835>.

2021-01-06  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/libs/libgroff/relocate.cpp (relocatep): Add assertion to
	identify logic error if `curr_prefix` is unexpectedly a null
	pointer.
	(set_current_prefix) [_WIN32]: Allocate memory from heap for
	`curr_prefix` only on Windows; on other systems, this file's
	searchpath() is used to populate `curr_prefix`, and that
	function (except on Windows) performs its own allocation.  Fixes
	memory leak noted by Ingo Schwarze.
	(set_current_prefix) [!_WIN32]: Move logic attempting to set
	`curr_prefix` by calling searchpathext() from here...
	[WIN32]: ...to here.  The PATHEXT environment variable has
	semantics only under Windows, not POSIX systems, so the
	placement of this code seemed erroneous.

	See <https://savannah.gnu.org/bugs/?55475>.

2021-01-06  Colin Watson <cjwatson@debian.org>

	* contrib/glilypond/glilypond.pl:
	* contrib/gperl/gperl.pl:
	* contrib/gpinyin/gpinyin.pl:
	* tmac/hyphenex.pl: Avoid Perl's unsafe "<>" operator.

	The "<>" operator is implemented using the two-argument form of
	"open", which interprets magic such as pipe characters, allowing
	execution of arbitrary commands which is unlikely to be
	expected.  Perl >= 5.22 has a "<<>>" operator which avoids this,
	but also forbids the use of "-" to mean the standard input,
	which is a facility that the affected groff programs document.

	ARGV::readonly would probably also fix this, but I fundamentally
	dislike the approach of escaping data in preparation for a
	language facility to unescape it, especially when the required
	escaping is as non-obvious as it is here.  (For the same reason,
	I prefer to use subprocess invocation facilities that allow
	passing the argument list as a list rather than as a string to
	be interpreted by the shell.)  So I've abandoned this dubious
	convenience and changed the affected programs to iterate over
	command-line arguments manually using the three-argument form of
	open.

	glilypond doesn't need the initial unshift since that's already
	handled in contrib/glilypond/args.pl.

	Fixes <https://savannah.gnu.org/bugs/?55557>.

2021-01-06  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/s.tmac: Set footnote line length in multi-column
	environments to 11/12ths of the text line length for consistency
	with earlier change to FL register default.

	Thanks to T. Kurt Bond for bringing this issue to my attention.

2021-01-04  John Gardner <gardnerjohng@gmail.com>

	* tmac/strip.sed: Escape '.' wildcard when matching lines using
	.as and .ds requests.

	Fixes <https://savannah.gnu.org/bugs/?59498>.

2021-01-04  G. Branden Robinson <g.branden.robinson@gmail.com>

	Document use of SOURCE_DATE_EPOCH and TZ.

	The semantics of SOURCE_DATE_EPOCH to groff were not established
	with respect to time zone selection, prompting divergent
	interpretations; Debian and distributions derived from it have
	for several years patched groff to implicitly use UTC as the
	time zone when interpreting the current time (or
	SOURCE_DATE_EPOCH) as a local time.  While a convenient and
	defensible choice for reproducible build efforts[1], it runs
	against the grain of user expectations.  Systems programmers
	like monotonically increasing clocks; the broader user base
	usually prefers a clock that follows an applicable civil
	calendar.  To the latter audience, a difference between
	  $ date "+%Y-%M-%d %H:%m:%S"
	and
	  $ groff <<EOF
	  .af year 0000
	  .af mo 00
	  .af dy 00
	  .af hours 00
	  .af minutes 00
	  .af seconds 00
	  .tm \n[year]-\n[mo]-\n[dy] \n[hours]:\n[minutes]:\n[seconds]
	  EOF
	is difficult to explain.

	* doc/groff.texi (Environment):
	* src/devices/grohtml/grohtml.1.man (Environment):
	* src/devices/gropdf/gropdf.1.man (Environment):
	* src/devices/grops/grops.1.man (Environment):
	* src/roff/groff/groff.1.man (Environment):
	* src/roff/troff/troff.1.man (Environment): Expand description
	of use of SOURCE_DATE_EPOCH to note that it converts the time
	{as seconds since the Epoch} to local time, which motivates
	documentation of the TZ environment variable.  Explain what the
	time stamps are used for: troff merely stores the human-readable
	time components in registers; the grohtml, gropdf, and grops
	output drivers write the information to the output in comments.

	Fixes <https://savannah.gnu.org/bugs/?57218>.

	[1] https://reproducible-builds.org/docs/source-date-epoch/

2020-12-25  G. Branden Robinson <g.branden.robinson@gmail.com>

	* doc/doc.am (.texi.dvi): Call texi2dvi with FORCE_SOURCE_DATE=1
	in the environment, avoiding an embedded timestamp in the
	generated groff.dvi file, which frustrated reproducible builds.
	Thanks to Werner Lemberg for the suggestion.

	* src/roff/groff/tests/string_case_xform_unicode_escape.sh: Fix
	test to no longer use Bash process substitution, resulting in
	nondeterministic file descriptor numbers appearing in test logs,
	frustrating reproducible builds.

	* contrib/pdfmark/pdfmark.am (PDFROFF): Call pdfroff without
	`--keep-temporary-files` option.  Temporary directories are
	created with mktemp(1) and files with an embedded process
	identifier, which frustrates reproducible builds.

	See <https://savannah.gnu.org/bugs/?57218>.

2020-12-21  Dorai Sitaram <ds26gte@yahoo.com>

	* tmac/s.tmac (@IP): Handle inter-sentence space correctly in
	paragraph tags by copying \n[.sss] from the enclosing
	environment to that used to format the paragraph tag.

	Fixes <https://savannah.gnu.org/bugs/?59742>.

2020-12-21  G. Branden Robinson <g.branden.robinson@gmail.com>

	Add regression test for Savannah #59742.

	* tmac/tests/s_IP_respects_inter-sentence_space_in_tags.sh: Do
	it.
	* tmac/tmac.am (tmac_TESTS): Run it.

2020-12-21  Bjarni Ingi Gislason <bjarniig@rhi.hi.is>

	* src/utils/addftinfo/addftinfo.cpp (usage): Use size_t for loop
	index when iterating over a count of size_t items.  Quiets
	signedness mismatch compiler warning.

	Fixes <https://savannah.gnu.org/bugs/?59583>.

2020-12-20  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/doc.tmac-u (Mt): Emit a usage diagnostic and return if
	called with no arguments.  This introduces an incompatiblility
	with mandoc(1), but the existing behavior (print an italicized
	tilde, because Mt is implemented as a wrapper around Pa, which
	prints pathnames) made no sense.

2020-12-20  Colin Watson <cjwatson@debian.org>

	* src/devices/gropdf/gropdf.pl:
	* src/utils/afmtodit/afmtodit.pl: Sort Perl hash keys.  Hash
	iteration order may differ between runs, which makes builds
	harder to reproduce.  Sort hash keys in gropdf and afmtodit
	output to avoid this.

2020-12-20  G. Branden Robinson <g.branden.robinson@gmail.com>

	* doc/ms.ms (Basic Information): Tweak unit definitions.  groff
	defines a typesetter's point as precisely 1/72 inches.  Also use
	the correct symbol for inch units--strictly, it's the same as
	that for "seconds" as in subdivisions of the degree, and not a
	typographical quote of any sort.

	Fixes <https://savannah.gnu.org/bugs/?59463>.

2020-12-20  G. Branden Robinson <g.branden.robinson@gmail.com>

	[ms]: Set footnote line length to AT&T default.

	groff ms has since its initial implementation used a default
	footnote line length of 5/6ths of the text line length; this may
	correspond to an early AT&T ms default (perhaps documented in
	the 1974 version of the M. E. Lesk paper, "Typing Documents on
	the UNIX System"[1], published by the ACM).  However, as early
	as V6 Unix (1975), AT&T ms actually used a footnote line length
	of 11/12ths of the text line length instead[2].

	Heirloom Doctools and neatroff ms also use this default.

	* tmac/s.tmac: Set default footnote line length to 11/12ths of
	the text line length.

	* doc/groff.texi (ms Document Control Settings):
	* doc/ms.ms (Document control registers): Document new default.

	[1] https://www.troff.org/using-ms.pdf
	[2] https://minnie.tuhs.org/cgi-bin/utree.pl?file=V6/usr/lib/tmac.s

2020-12-09  G. Branden Robinson <g.branden.robinson@gmail.com>

	Lower new unplanted trap error to 'mac' warning.

	* src/roff/troff/div.cpp (top_level_diversion::change_trap):
	Change error upon invalid attempt to move an unplanted trap into
	a warning of type 'mac'.

	* doc/groff.texi (Warnings):
	* src/roff/troff/troff.1.man (Warnings): Recast description of
	'mac' warning type to include the above scenario.

	Thanks to Bjarni Ingi Gislason for reporting the diagnostic
	arising in real life, and to Peter Schaffter for the discussion
	and recommendation.  Some bike sheds get painted quickly!

	Fixes <https://savannah.gnu.org/bugs/?59573>.

2020-12-05  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/groff_mdoc.7.man: Tweak mandatory macro explanations.

	Update descriptions and template of .Dd, .Dt, .Os usage to
	reflect recent changes and recommended conventions.

	Thanks to Ingo Schwarze, Colin Watson, and Alan D. Salewski for
	the discussion, and Florent Rougon and Robert Bihlmeyer (many
	years ago) for the original report.

	Fixes <https://bugs.debian.org/284002>.

2020-12-01  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/utils/xtotroff/xtotroff.c (MapFont): Avoid writing past
	the end of a static buffer.  Problem found and patch supplied by
	Bjarni Ingi Gislason.  I tweaked it to comment it differently
	{in case the buffer ever needs to grow, but the prospects of
	future X11 server-side font rendering development seem dim} and
	use snprintf() instead of retaining the existing sprintf().

	Fixes <https://savannah.gnu.org/bugs/?55257>.

2020-12-01  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/utils/xtotroff/xtotroff.c (CanonicalizeFontName,
	FontNamesAmbiguous, MapFont, main): Format diagnostic messages
	more consistently with GNU Coding Standards.  Prefix with name
	of complaining command.  Put argument literals in quotation
	marks.  Put each messge on one line only.

2020-11-28  G. Branden Robinson <g.branden.robinson@gmail.com>

	* doc/groff.texi (Parameters): Fix error in example.  Arguments
	to .als were in the wrong order (.als is not ln(1)).  Also mark
	output to the standard error stream using the @error Texinfo
	command instead of @result.

	Thanks to Dorai Sitaram for finding this error.

	Fixes <https://savannah.gnu.org/bugs/?59566>.

2020-11-28  G. Branden Robinson <g.branden.robinson@gmail.com>

	* doc/groff.texi (Debugging): Update with a more helpful
	introduction, summarizing available procedures.  Mention
	backtracing since it is much more useful now (post-groff
	1.22.4.)

	* man/groff.7 (Debugging): Add new section summarizing
	material added to our Texinfo manual.

	* man/groff_diff.7.man (Debugging): Add new section describing
	groff extensions.

2020-11-22  G. Branden Robinson <g.branden.robinson@gmail.com>

	* doc/groff.texi (Traps): Update.  Organize subsubsections "Page
	Location Traps" and "Diversion Traps" under new subsection node
	"Vertical Position Traps" to make the conceptual organization
	more clear.  Define and discuss trap visibility earlier.
	Document unit used for page location trap reporting.  Introduce
	analogy of .wh and .ch requests as queue operations.  Document
	what happens when the same macro is planted as a trap in
	multiple locations; supply example.  Supply example of .itc
	usage.  Consistently refer to an end-of-input macro as such, to
	contrast it with the "end macro" that be used with, e.g., .de
	and .ig requests.

	* man/groff.7 (Traps): Add new section summarizing
	language feature.

2020-11-18  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/mdoc/doc-common-u (doc-footer): When performing
	double-sided page layout, set page number on outside of _recto_
	{odd-numbered} pages, as is conventional and for consistency
	with man(7).

	* tmac/groff_mdoc.7.man
	(Formatting with groff, troff, and nroff): Document what
	double-sided layout (not "printing") means.  Also correct
	description of continuous rendering, which implied that page
	headers and footers were not written at all, and used an
	incorrect groff driver name.

	Fixes <https://bugs.debian.org/919890>.  Also see:
	https://lists.gnu.org/archive/html/groff/2019-01/msg00021.html
	Thanks to Ralph Corderoy for the discussion.

	* tmac/tests/doc-D_places_page_numbers_correctly.sh: Test it.
	* tmac/tmac.am (tmac_TESTS): Run test.

2020-11-18  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/mdoc/doc-common-u (doc-header): Fix infinite loop when
	attempting to trim header string (like "FTP(1)") to fit when the
	available title length won't allow even extreme shortening.
	Measure the string before and after calling .substring on it,
	and break out of loop if it didn't get shorter.

	Problem dates back to at least
	ed63b0ae76a611b581601a1afc192f6a7367be6f (7 July 2002), possibly
	as far as the Great Mdoc Rewrite of
	058f72af832fc68488d33cd09ec819e5c560fa09 (23 March 2001).

	One can never check loop invariants too many times...

	Fixes <https://bugs.debian.org/411227>.

	* tmac/tests/\
	doc-do_not_loop_infinitely_when_shortening_headers.sh: Test it.
	* tmac/tmac.am (tmac_TESTS): Run test.

2020-11-18  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/nroff/nroff.sh: Recognize -b and -z options and pass
	them through to troff.  Document them in usage message.
	* src/roff/nroff/nroff.1.man: Document new -b and -z options.

2020-11-17  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/troff/div.cpp (top_level_diversion::change_trap):
	Emit error diagnostic if an attempt is made to move an unplanted
	macro.  This could have been a warning, as it's pretty harmless
	{though possibly a big surprise to anyone who was wondering why
	their .ch was a no-op}, but there's no good warning category for
	this kind of problem and I am not about to start a bike shed
	discussion about it right now.

2020-11-15  G. Branden Robinson <g.branden.robinson@gmail.com>

	* doc/groff.texi: Update.  Add introductory material.  Rewrite
	the first section of the "gtroff Reference" chapter of our
	Texinfo manual.  It is written as an introduction for readers
	who want to go straight to "raw" troff without knowing much or
	anything about existing macro packages.  Thanks to Dave Kemper
	and John Gardner for feedback and support.

	Clarify whitespace usage.  "Whitespace" is defined in this
	manual as "spaces, tabs, and newlines".  Say only "spaces and
	tabs" when newlines should not be included.

	Rename "Font Files" to "Device and Font Files".

	Rename "Manipulating Filling and Adjusting" to "Manipulating
	Filling and Adjustment".

	Update discussion of "copy mode".  Rename from "copy-in mode",
	which I don't think eludicdated anything; is there a "copy-out
	mode"?  Rename nodes accordingly.  Attempt to explain more
	clearly.  Recast to shift emphasis to what _isn't_ merely copied
	in copy mode, since that is what seems to cause confusion among
	the inexperienced.

	Update "Conditionals and Loops".  Add introductory paragraph.
	Add nodes/subsections "if-then" and "Conditional Blocks".  Add
	subsection "Conditional Blocks" to explain the behavior of the
	\{ and \} escapes much more precisely.  I don't think this
	syntactical area is well understood.  Supply examples.

2020-11-14  G. Branden Robinson <g.branden.robinson@gmail.com>

	Add style checks to man(7) macro package.

	Not otherwise documented yet; experimental--subject to change.

	* tmac/an-old.tmac: Initialize CHECKSTYLE to false if not
	already set.
	(an-style-warn): New macro emits diagnostic of type "style" when
	called if CHECKSTYLE register is true.
	(TH): Call an-style-warn if fewer than two or more than five
	arguments are seen.
	(RI, IR, IB, BI, RB, BR): Call an-style-warn if fewer than two
	arguments are seen.

2020-11-11  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Update copyright.

	* update-copyright.sh: use gnulib's 'update-copyright' script.
	Pass this script in directories 'arch', 'contrib', 'font',
	'man', 'tmac', 'src' and on a list of extra files.

	* FOR-RELEASE: mention this point.

2020-11-11  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/preproc/preconv/preconv.1.man (Description): Fix error;
	groff's -K option, not -k, specifies a character econding (and
	overrides GROFF_ENCODING in the environment).  Also explain how
	valid encoding strings are determined.

	Thanks to Bjarni Ingi Gislason for the report.

	Fixes <https://savannah.gnu.org/bugs/?59445>.

2020-11-11  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/preproc/tbl/table.cpp (table::compute_separation_factor):
	Add word "table" to diagnostic message to better cue the user
	that it is produced by roff that has been injected into the
	document by the tbl(1) preprocessor.  The other 3 such possible
	diagnostic messages already do this.  Thanks to Bjarni Ingi
	Gislason for bringing the inconsistency to light.

	Fixes <https://savannah.gnu.org/bugs/?59443>.

2020-11-07  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/groff_mdoc.7.man (Predefined strings): Ensure the table
	fits even on ASCII and Latin-1 terminals.  Thanks to Bjarni Ingi
	Gislason for the report.

	Fixes <https://savannah.gnu.org/bugs/?59424>.

2020-11-01  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/groff_mdoc.7.man (General text domain/Enclosure and
	Quoting Macros): Fix errors in macro descriptions.
	<.Dq>: Encloses its arguments in directional double quotes where
	available.
	<.Eq>: Misrendered example; say "XstringY" rather than
	"XXstring".
	<.Sq>: Encloses its arguments in directional single quotes where
	available.

2020-10-31  G. Branden Robinson <g.branden.robinson@gmail.com>

	Add support for CS and CT registers to mdoc(7), just like in
	man(7), from a year ago.

	* tmac/doc.tmac-u (doc-print-recursive): Call .stringup on each
	argument if register doc-do-capitalize is true.
	* tmac/mdoc/doc-common-u (Dt): Call .stringup on
	doc-document-title if \n[CT] is true.
	(Sh): Set doc-do-capitalize to value of \n[CS].  Set
	doc-do-capitalize false before returning.
	* tmac/mdoc/doc-ditroff-u:
	* tmac/mdoc/doc-nroff-u: Set CS and CT registers to 0 (false)
	if the user has not defined them.

	* tmac/groff_mdoc.7.man \
	(Formatting with groff, troff, and nroff): Document it.

	* tmac/tests/doc-CS_works.sh:
	* tmac/tests/doc-CT_works.sh: Test it.
	* tmac/tmac.am (tmac_TESTS): Run tests.

2020-10-31  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/troff/input.cpp (do_overstrike, do_bracket,
	do_name_test, do_expr_test, do_zero_width, do_width, do_special,
	do_if_request, read_color_draw_note): Improve diagnostic
	messages for missing closing delimiters by describing the
	incomplete structure and the problem token.
	(read_rgb, read_cmy, read_cmyk, read_gray): Improve English
	syntax of diagnostic message when color definition missing.

2020-10-31  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/mdoc/doc-ditroff-u:
	* tmac/mdoc/doc-nroff-u: Recognize but ignore the groff_man(7)
	string HF and registers FT, IN, P, SN, and X (by initializing
	them empty or zero if they are not set).  This reserves them so
	that they don't become used for divergent purposes.  man(1)
	programs set these and other parameters already handled (like
	LL) to configure page rendering, and it would break the
	macro-package agnosticism afforded by andoc.tmac to expose
	different externally-programmable registers and strings.
	* tmac/groff_mdoc.7.man \
	(Formatting with groff, troff, and nroff): Document this.

2020-10-31  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/s.tmac: Implement \*< and \*> strings for subscripting.
	groff ms has had (extension) strings for superscripting since
	1991 at the latest, and the asymmetry possessed me of a madness.
	Both pairs of string names follow similar usage in Eric Allman's
	"me" macros.

	* NEWS:
	* doc/groff.texi:
	* tmac/groff_ms.7.man: Document it.

2020-10-31  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/groff_mdoc.7.man (Predefined strings): Fix error; the
	\*[Lq] and \*[Rq] strings degrade to neutral double quotes (")
	on "nroff" devices (-Tascii and -Tlatin1), not "``" and "''".

2020-10-31  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/s.tmac (ds*end!0): Improve diagnostic to mention .RD.

2020-10-30  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/s.tmac: Revise diagnostic messages.  Define a common
	prefix string, starting all such messages with "s.tmac".
	Continues the long process of fixing Savannah #52463.  Drop the
	word "macro" from diagnostic since this will now be clear from
	the prefix.  Prefix every macro name in a diagnostic message
	with a leading dot; this was already done in four cases.
	(cov*first-page-init): Use temporary string to avoid multi-line
	diagnostic message.
	(@NH): Use temporary string to prevent overlength line.

	A further benefit of this revision is that index information
	produced by ms's .IX macro (which writes to the standard error
	stream) will now be trivially easy to extract even for documents
	that cause diagnostic messages.  One can simply filter them with
		grep -v '^s\.tmac:'
	or similar.

2020-10-28  Ingo Schwarze <schwarze@openbsd.org>

	* man/roff.7.man, tmac/groff_man.7.man.in: Correct man(7)
	history.

2020-10-26  G. Branden Robinson <g.branden.robinson@gmail.com>

	Fix ms .R macro to work as documented, by handling its arguments
	instead of ignoring them.

	* tmac/s.tmac (R): Delete.  During set up, call
	par*define-font-macro for R font just as we do for B, I, and BI.

	Problem dates back at least to groff 1.02, June 1991.

	* tmac/tests/s_R-handles-its-arguments.sh: Test it.
	* tmac/tmac.am (tmac_TESTS): Run test.

	Fixes <https://savannah.gnu.org/bugs/?59348>.

2020-10-25  G. Branden Robinson <g.branden.robinson@gmail.com>

	Fix ms .TC macro by allowing it to actually use lowercase Roman
	numerals for the page(s) of the table of contents when a custom
	title (header or footer) is defined containing '%'.

	As a side effect, eliminate the PN register, which was
	apparently misused because it was undocumented and had a name
	just long enough to be both suggestive and ambiguous.  Another
	pin goes into my Ken Thompson voodoo doll.

	* tmac/s.tmac (IX): Write out page number of index term(s) using
	the % register (instead of PN), obtaining whatever format is
	assigned to the register at that time.
	(CH): Similarly, output %, not PN, in the center of the default
	heading.
	(PT): Save the format of %, set it to decimal, copy its value to
	a new register, pg*page-number-in-decimal, then restore %'s
	previous format.  Compare the new register, not %, to 1 to
	determine whether special page one behavior should be used.
	(pg*end-page): Assign pg*next-format to %, not PN.
	(XA): Define toc*num with the interpolation of %, not PN.

	* tmac/tests/s_TC-works-with-percent-in-custom-titles.sh: Test.
	* tmac/tmac.am (tmac_TESTS): Run test.

	Problem appears to be very old; as I read it, Larry Kollar was
	complaining of it in his ms.ms document over 20 years ago.

	Fixes <https://savannah.gnu.org/bugs/?59345>.

2020-10-25  G. Branden Robinson <g.branden.robinson@gmail.com>

	* man/groff.7 (Requests/Request short reference) <.af>: Fix
	error; "l" is not a valid register format.  Explain what the
	request does, and the default format, as tersely as possible.

2020-10-22  G. Branden Robinson <g.branden.robinson@gmail.com>

	Use only malloc() and free() to manage memory of paths opened by
	the parser instead of mixing in C++ new/delete management under
	some runtime-dependent circumstances.

	* src/libs/libgroff/relocate.cpp (relocatep): Use malloc(), not
	new.
	* src/roff/troff/input.cpp (process_macro_file,
	process_startup_file, macro_source): Use free(), not (a_)delete.

	Thanks to an anonymous contributor for the report and patch.

	Fixes <https://savannah.gnu.org/bugs/index.php?56694>.

2020-10-22  G. Branden Robinson <g.branden.robinson@gmail.com>

	* man/groff_char.7.man (Description/Special character escape
	forms): Clarify discussion of Unicode Normalization Form D and
	its applicability to code points acceptable in Unicode numeric
	special character escapes.  Also document that these escapes
	must use uppercase hexadecimal digits.

	Attempts once again to slay the unkillable beast that is
	<https://savannah.gnu.org/bugs/index.php?57618>.

2020-10-21  Ingo Schwarze <schwarze@openbsd.org>

	On systems without NAME_MAX, use FILENAME_MAX as a last resort.

	Problem reported by Eli Zaretskii <eliz at gnu dot org>
	on MS Windows in https://savannah.gnu.org/bugs/?55449

2020-10-20  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/troff/env.cpp (environment::possibly_break_line):
	Emit break warning and return if the output width is not
	positive.  The code assumes that it will be and loops infinitely
	if it isn't.  I _think_ this is because we're not able to get
	width data for (some?) CJK glyphs.  Based on a patch by Osamu
	Sayama.

	* src/roff/groff/tests/\
	do_not_loop_infinitely_when_breaking_cjk.sh: Test it.
	* src/roff/groff/groff.am: Run test.

	Fixes <https://savannah.gnu.org/bugs/index.php?44018>.

2020-10-20  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/preproc/tbl/table.cpp (table::init_output): Save the value
	of \n[.tabs] when starting a table.  In the reset macro, restore
	the saved value.

	Based on a patch by Bjarni Ingi Gislason (tweaked to use a more
	normative preprocessor symbol; "REG"s aren't "NAME"s).

	* src/preproc/tbl/tests/save-and-restore-tab-stops.sh: Test it.
	* src/preproc/tbl/tbl.am (tbl_TESTS): Run test.

	Fixes <https://savannah.gnu.org/bugs/index.php?42978>.

2020-10-20  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/nroff/nroff.sh: Recognize -E option and pass it
	through to troff.  Document it in usage message.
	* src/roff/nroff/nroff.1.man: Document new -E option.

	Based on a patch by Ingo Schwarze.

	Fixes <https://savannah.gnu.org/bugs/index.php?44289>.

2020-10-18  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-old.tmac: Stop remapping ` and '.  Our own pages now
	appear to be clear of wrong-quote problems, so let's make them
	visible if they recur.  Those who don't want to fix bad man
	pages (distributors, site admins) can restore the mappings in
	their man.local files.

2020-10-18  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-old.tmac (an-warn): New; emits warning diagnostic.
	(R): Use new macro instead of .tm* requests directly.

2020-10-18  Ingo Schwarze <schwarze@openbsd.org>

	#include "config.h" before <stdio.h>

	Required with e.g. gcc 4.2.1 because gnulib/lib/stdio.in.h
	uses the "restrict" keyword since this gnulib commit:
	commit 182afcba2635cbff91240656c7fb3742dd23ab6f
	Author: Bruno Haible <bruno@clisp.org>
	Date: Sat Feb 22 20:57:30 2020 +0100

	Otherwise, the build may die from the declaration of
	various printf-like functions with messages like:
	./lib/stdio.h:851: error: expected ',' or '...' before 'fp'

	* src/libs/libgroff/assert.cpp, src/libs/libgroff/errarg.cpp,
	src/libs/libgroff/error.cpp, src/preproc/eqn/eqn.ypp:
	#include "config.h".

2020-10-18  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	hpftodit: incorrect 'delete' after new[]

	* src/utils/hpftodit/hpftodit.cpp (output_font_name): use
	'delete[]'.

	Fixes bug #55331. Found by David Binderman, fixed by Ingo
	Schwarze.

2020-10-18  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	preconv: don't use libuchardet if input is stdin

	* src/preproc/preconv/preconv.cpp (do_file): don't call
	detect_file_encoding if input file is "-"

	This fixes the failure on MS-Windows described #55334, however
	this does not fix the encoding detection with uchardet if the
	input is stdin (the user would have to pass with -D the correct
	encoding as explained in the man page).

2020-10-17  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/preproc/eqn/lex.cpp (troff_defs): Set the "..." token on
	the baseline, not vertically centered, aligning the actual
	behavior with what our eqn(1) man page has claimed since 2007.

	Fixes <https://savannah.gnu.org/bugs/index.php?59285>.

2020-10-17  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/devices/grops/grops.1.man
	(Usage/TrueType and other font formats): Remove dead URL to
	ttftot42 utility.  Update URL to fontforge tool.  Replace much
	of the discussion with an example, motivated by Jordan Torbiak's
	"groff-install-font" script on GitHub Gist, of how to add the
	Roboto Slab Regular font to a user-local groff font directory
	{and how to test it, too}.

	Fixes <https://savannah.gnu.org/bugs/index.php?58077>.

2020-10-17  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/utils/afmtodit/afmtodit.pl: Report program name in warning
	diagnostics.

	Continues the long process of fixing Savannah #52463.

2020-10-17  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-old.tmac: Add fallback for lq, rq strings.

	Define \*(lq and \*(rq as '"' if the output device has no \(lq
	or \(rq special character escapes defined (respectively).

	This is a bit belt-and-suspenders for groff since our output
	devices all guarantee availability of these glyphs, but if this
	macro file gets used with other implementations (and if they
	support the 'c' conditional), it should prevent the strings from
	producing empty output.

	Man page writers should simply use \(lq and \(rq unless they are
	aiming for pathological levels of portability (e.g., composing
	man pages today for consumption on simulators of 1980s Unix
	systems).

2020-10-16  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-old.tmac: Define an-end with .de1.  We need to define
	an-end with de1 (execute macro with compatibility mode off)
	because, as of 37b4180a27a6eeaea429e40ec278abefcda7f3a7 (11
	October), it can now be called from a trap executing in a
	context whence compatibility mode might be on (namely,
	"reload-doc" in andoc.tmac).

2020-10-16  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/preproc/eqn/main.cpp (main):
	* src/preproc/pic/main.cpp (main):
	* src/preproc/tbl/main.cpp (main):
	* tmac/eqnrc:
	* tmac/troffrc: Perform checks of register and macro definitions
	with a .do request, since we might be in compatibilty mode.

2020-10-16  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/troff/input.cpp (do_if_request): Emit warning of type
	"syntax" if a groff conditional expression extension is used
	when compatibility mode is active.

	* doc/groff.texi:
	* src/roff/troff/troff.1.man: Update description of "syntax"
	warning type to be more general.  It was inaccurate, referring
	only to "dubious syntax in numeric expressions", which was not
	the case.  Instead it was being used only for poor construction
	of character classes with the .class request.

2020-10-16  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/preproc/tbl/main.cpp (main): Stop ignoring -T.  GNU tbl
	was undocumentedly ignoring the -T option; apparently IRIX tbl
	implemented it, something on the system called tbl with that
	option (I'm guessing IRIX's man(1)) and its users spammed James
	Clark with bug reports.  We can probably weather the volume of
	such spurious reports from IRIX users today.

2020-10-16  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/preproc/tbl/main.cpp (main): Clarify fatal diagnostic in
	generated document by informing the user that the program is
	aborting, and also that it is groff extensions that are required
	rather than GNU troff per se (since Heirloom Doctools troff
	claims groff extension support via the .g register).

2020-10-14  Ingo Schwarze <schwarze@openbsd.org>

	In groff(1), fix the combination of -v with -k, -j, and -J.

	* src/roff/groff/groff.cpp: Pass the -v option through to the
	preconv, chem, and ideal preprocessors, just like for all
	other preprocessors, to print the version of the preprocessor
	and to avoid garbage output.

	Bugfix patch from Eli Zaretskii <eliz at gnu dot org>
	submitted in: https://savannah.gnu.org/bugs/?55297

2020-10-12  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Update 'gnulib' submodule.

	* gnulib: now points on d60a35e94c4f5b8f09f15828242418f5073d46e7
	from 'gnulib' repository.

	* configure.ac: minimum autoconf version is now 2.64 due to
	gnulib upgrade.

	* FOR-RELEASE: add the gnulib update to the checklist.

2020-10-11  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/andoc.tmac: When switching between macro packages in
	andoc and using continuous-rendering mode, flush any partially
	collected output line and write page footer.
	(reload-doc): Call an-end if it is defined.
	(reload-man): Call doc-end-macro if it is defined.
	* tmac/tests/andoc-flush-between-packages.sh: Add regression
	test.
	* tmac/tmac.am (tmac_TESTS): Run test.

	Fixes <https://savannah.gnu.org/bugs/index.php?59106>.

2020-10-11  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/andoc.tmac: Remove traps set by mdoc package by the names
	they actually use.
	* tmac/tests/andoc-clear-doc-traps.sh: Add regression test.
	* tmac/tmac.am (tmac_TESTS): Run test.

	Fixes <https://savannah.gnu.org/bugs/index.php?59246>.

2020-10-10  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/preproc/tbl/table.cpp (table::init_output): In the release
	macro written to the output, reword the warning diagnostic that
	is emitted when a table row is to be output without enough room
	before the next page location trap.  The former wording said
	that a "text block" would not fit on the page, and that is
	normally how table rows grow longer than one line in the first
	place.  However, there are other ways the conditional can be
	satisfied, as witnessed in Savannah #57665, so simply say what
	is known; that the table _row_ overruns the space to the next
	trap (we say the row won't "fit on [the] page").

	Fixes <https://savannah.gnu.org/bugs/index.php?59233>.

2020-10-10  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/preproc/tbl/table.cpp
	(double_line_entry::double_line_entry):
	(double_line_entry::simple_print): Remove garbage lines
	inadvertently added in previous commit.

2020-10-09  G. Branden Robinson <g.branden.robinson@gmail.com>

	Stop tbl from injecting spurious blank lines (and emitting
	spurious warnings about tables and "text blocks" not "fitting on
	a page") into long tables in man pages when continuous rendering
	is used (the default for nroff output devices).

	* src/preproc/tbl/table.cpp (USE_KEEPS_REG): New preprocessor
	symbol stores name of groff register for dynamic determination
	of keep usage.
	(table::init_output): If the NOKEEP flag is not set, then in
	generated groff output, see if the usekeeps register is defined;
	if not, define it and enable usage of keeps.
	(table::do_row): In groff output, check usekeeps register before
	calling keep and release macros.
	(table::do_bottom): In groff output, check usekeeps register
	before calling release macro.

	* tmac/an-old.tmac (TS): Set the usekeeps register used by tbl
	to the logical complement of the man(7) cR (continuous
	rendering) register.

	* tmac/tests/an-old_TS_do_not_keep_tables_when_cR_set.sh: Add
	regression test.
	* tmac/tmac.am (tmac_TESTS): Run test.

	Problem appears to date back to the introduction of continuous
	rendering in groff 1.17 (3 May 2001).

	Fixes <https://savannah.gnu.org/bugs/index.php?57665>.

2020-10-09  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/preproc/tbl/table.cpp (simple_entry::position_vertically):
	(block_entry::position_vertically):
	(table::determine_row_type):
	(printfs): Update assertions to indicate what actually went
	wrong.

2020-10-02  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/troff/node.cpp: Make diagnostics slightly more
	informative in unusual error cases.
	(real_output_file::~real_output_file): If ferror() reports error
	status on a stream say that, instead of "error writing".  If it
	does not, but fflush() fails on the stream, describe the flush
	as failing, and use strerror() since fflush() sets errno.  If
	pclose() fails, say that we were unable to close a pipe instead
	of repeating the name of the C library function to the user, who
	might not be a C programmer.  Report sterror() in this case and
	for a failing fclose().
	(real_output_file::flush): Repeat updated fflush() logic from
	previous function.

2020-09-30  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-old.tmac (register setup): Make interaction of \n[C]
	register and HTML output more clear in code and comments.

2020-09-30  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/groff/tests/regression_savannah_59202.sh: Reduce test
	case.

2020-09-29  G. Branden Robinson <g.branden.robinson@gmail.com>

	Fix SEGV arising from recursing destructor.

	* src/roff/troff/node.h (output_file): Add class member
	`is_dying` to track whether destructor has already been entered;
	initialize false.
	* src/roff/troff/node.cpp (real_output_file::~real_output_file):
	Set `is_dying` true when destructor entered.
	* src/roff/troff/div.cpp (cleanup_and_exit): Only delete
	`the_output` object if it is not already being destroyed.
	* src/roff/groff/tests/regression_savannah_59202.sh: Add test.
	* src/roff/groff/groff.am (groff_TESTS): Run test.

	Thanks to "hackerb9" for reporting the problem.  Problem appears
	to date back to groff 1.02 (June 1991) or earlier.

	Fixes <https://savannah.gnu.org/bugs/index.php?59202>.

2020-09-28  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-old.tmac (register setup): Condition decisions on
	\n[an-html] rather than a string comparison using \*[.T]; that
	is what the register is there for.

2020-09-28  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/andoc.tmac: Save alias to .ne request.
	(reload-doc): Restore .ne request, which an-old.tmac meddles
	with if continuous rendering is used.  (The meddling ultimately
	dates back to 777e2d262862621966c18d685a000cc88f432bc6, 26
	January 2002, which simply redefined .ne as empty on nroff
	devices.)

2020-09-27  G. Branden Robinson <g.branden.robinson@gmail.com>

	Ship tests in distribution archive.

	* src/preproc/preconv/preconv.am (EXTRA_DIST):
	* src/roff/groff/groff.am (EXTRA_DIST):
	* src/roff/nroff/nroff.am (EXTRA_DIST):
	* tmac/tmac.am (EXTRA_DIST): Add
	$({preconv,groff,nroff,tmac}_TESTS), as appropriate.

	* src/roff/nroff/nroff.am (MOSTLYCLEANFILES): Stop adding
	$(nroff_TESTS), which can only have unhappy consequences.

2020-09-27  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/tmac.am: Fix problem with recently-relocated mdoc macro
	files not ending up in the right place in the distribution
	archive.
	(dist_tmac_DATA): Also include $(TMACUNSTRIPFILES).
	(TMACMDOCSTRIPFILES): Rename from $(TMACMDOCFILES).  Update
	interpolation sites.
	(TMACMDOCUNSTRIPFILES): New variable holds mdoc macro files in
	the tmac/mdoc subdirectory.  Stop adding these files to
	$(TMACUNSTRIPFILES) since those reside in tmac/ directly.
	(EXTRA_DIST): Add $(TMACMDOCUNSTRIPFILES).
	($(TMACSTRIPFILES)): Depend only on $(TMACUNSTRIPFILES).
	($(TMACMDOCSTRIPFILES)): Add new rule, much like the foregoing.
	Depend on $(TMACMDOCUNSTRIPFILES) and copy files into tmac/mdoc.
	(dist-hook, tmac-dist-hook): Remove; they no longer do any
	distinct work.

	Fixes <https://savannah.gnu.org/bugs/index.php?59186>.

2020-09-26  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/preproc/tbl/table.cpp (table::init_output):
	(table::compute_expand_width):
	(table::compute_separation_factor): Use consistent format for
	diagnostic messages.
	  - Do not spread a single diagnostic across multiple lines.
	  - Report messages in GNU Coding Standards format, that is:
	  - Report the name of the file the problem is in...
	  - ...then the line number...
	  - ...then the diagnostic severity level...
	  - ...then the specific problem.

2020-09-26  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-old.tmac: Emit warnings when configuration registers
	are ignored when producing output for HTML.

2020-09-25  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-old.tmac (an-p-footer): Define \*[an-page-string] if
	(1) the output device is not HTML; (2) \n[X] has been defined;
	and (3) the page number has not yet reached the threshold
	defined by \n[X].

	Fixes <https://savannah.gnu.org/bugs/index.php?59179>.

2020-09-25  G. Branden Robinson <g.branden.robinson@gmail.com>

	Add regression test for Savannah #59179.

	* tmac/tests/an-old_X_register_works.sh: Do it.
	* tmac/tmac.am (tmac_TESTS): Run it.

2020-09-25  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-old.tmac:
	* tmac/doc.tmac-u: Emit more informative fatal diagnostic when
	installed version of groff is too old.  Report the version found
	and explicitly note consequent abort.

2020-09-25  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/tmac.am: Regenerate stripped macro files upon changes to
	any of their unstripped counterparts.  This is crude, but they
	weren't being regenerated at _all_.  Defeating a central
	function of Make is bad.
	(TMACUNSTRIPFILES): New variable.  Populate with -u files.
	($(TMACMDOCFILES) $(TMACSTRIPFILES)): Depend on
	$(TMACUNSTRIPFILES).

2020-09-25  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-old.tmac:
	* tmac/andoc.tmac:
	* tmac/doc.tmac-u:
	* tmac/s.tmac: Clarify fatal diagnostics by informing the user
	that the program is aborting.

2020-09-25  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/www.tmac.in: Revise diagnostic message handling.
	(www:fatal): New macro handles fatal macro usage errors.
	(www:lenstr): Use www:fatal instead of writing to standard error
	with .tm (rather than www:error) and then calling .ab without
	arguments, which produces an unsightly "User Abort." message.
	(www:lenstr):
	(www:splitstr):
	(www:url_breaks):
	(www:url_breaks_split):
	(LINKSTYLE): Report expected number of arguments in diagnostics.
	(www:fontstyle): Shorten diagnostic message.

2020-09-25  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/troff/div.cpp
	(top_level_diversion::clear_diversion_trap): Fix copy and paste
	error in diagnostic, which wrongly reported that a top-level
	diversion trap couldn't be "set" when "clear"ed was meant.

2020-09-19  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/preproc/grn/main.cpp (conv):
	* src/roff/troff/node.cpp (suppress_node::tprint): Remove
	embedded newlines from diagnostic messages.

2020-09-18  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-old.tmac: Move setup of remaining rendering option
	parameters (registers C, D, P, and X) to end of file.

2020-09-17  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-old.tmac (TH): Move setup of rendering parameter
	registers IN and SN from here to the end of the file.  Update
	comments.

2020-09-17  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-old.tmac: Drop \*[an-empty] string.  This string is
	documented as preventing "looping" (presumably infinitely) if
	someone calls a two-font macro with an inconvenient parameter;
	the example shown is ".RB ( \\ )".  This string was being
	interpolated at the end of each argument pair to the two-font
	macros BI, BR, IB, RB, and RI.  This code dates back to groff
	1.10 (dc5351364982f78f8c630f1e856d692d4a82666f, 26 November
	1995).  Did you notice a two-font macro missing?  It was: IR.
	Using it with the proscribed input fails to cause a problem; the
	others similarly operate just fine when the empty string
	interpolation is removed.  Presumably at some point in the past
	25 years, this workaround became unnecessary.
	(BI, BR, IB, RB, RI): Remove interpolations of string.

	* tmac/tests/an-old_avoid_two-font_denial_of_service.sh: Add
	regression test.
	* tmac/tmac.am (tmac_TESTS): Run test.

2020-09-16  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-old.tmac: Refactor continuous rendering handling.
	Relocate set up of \n[cR] to end of file in parallel with other
	rendering parameter management.  Instead of conditionally
	defining the an-ne and an-bp macros, define them
	unconditionally.  Also define them with .de instead of .de1,
	since they will only be called within the contexts of macros
	that are already running with compatibility mode off (i.e., the
	public interface macros).  Relocate definition of an-end to sit
	alongside these other continuous-rendering-mode specific macros
	and avoid a forward reference and scattering of \n[cR]
	conditionals around the file.
	(an-set-up-continuous-rendering): Define new macro to move
	macros (and end macro) into place.  Call it at the end of the
	file only if cR eventually winds up being true.

2020-09-16  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-old.tmac: Improve name space management.  Rename .ne
	request to .an-ne instead of outright clobbering it (and in
	parallel with .an-bp).  Rename 'an-ne' register to 'an-need' to
	prevent confusion with renamed request.

2020-09-16  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-old.tmac: Drop .ll hack for LL register.

	Drop the .ll hack for setting the line length on nroff devices.

	Once upon a time, the only way to get man pages to render on a
	terminal at any width other than the nroff default of 65n was to
	put an .ll request into the page--a mortal sin against
	portability--or your man(1) program could sneak such a request
	into nroff's input stream.

	Also, long ago, John Eaton of UT Austin wrote a man(1) program.
	In a few years this implementation branched into two lines of
	development, which I'll call man-db man (Wilford/Polacco/Watson)
	and another, Brouwer/Lucifredi man, which as of this writing saw
	its last release in 2011 (1.6g).

	The man and mdoc macros of groff 1.18 (July 2002) introduced an
	LL register to configure the line length, respecting an -rLL
	command-line option.  The source change was made by Werner
	Lemberg on 3 May 2002 and Colin Watson updated man-db man(1)--on
	the same day!--to synthesize the option when calling groff.

	Later, in August 2005, Keith Marshall, a user of vesion 1.5m of
	Brouwer/Lucifredi man(1), which did not set the LL register,
	suggested that the existing .ll setting (technically, the value
	of \n[.l], the only way the result of an .ll request could be
	introspected) be honored in the absence of the LL register.
	However, it is impossible to distinguish a user-supplied ".ll
	65n" request from nroff's default setting, which was in that
	case overridden to the modern default of 78n.

	And so, in what is now git commit
	f9d5df4aebd3d834b4084ffefa52a115e00dce38 (1 September 2005), it
	was done.

	This led to (1) surprising behavior for users accustomed to old
	methods and desirous of the nroff default and (2) lengthy
	apologia in groff source code comments and the groff_man(7) man
	page.

	Ironically, Brouwer/Lucifredi man(1) had already added support
	for the LL register by the time of its 1.6 release two months
	earlier (20 June 2005).  (Curiously, it did so similarly to the
	old .ll hack, by injecting an '.nr LL' request into groff's
	input stream, rather than using the -r command-line option.)
	Moreover, Marshall and the groff list were already aware of
	this, but the change was accepted anyway because version 1.6
	was "too new"!  (Distributions are slow sometimes, true...)

	Let us survey the field in 2020.  man-db man(1) has supported
	the LL register for eighteen years, and Brouwer/Lucifredi man(1)
	for fifteen.  Heirloom Doctools's man macros set the line length
	to 78n on nroff devices unconditionally.  mandoc(1) similarly
	also always formats for 78 columns on terminals.  groff's
	mdoc(7) macros grew support for LL in parallel with man(7) in
	2002 and never added the \n[.l] introspection at all.

	There no longer seems to be any reason to preserve this hack.

	* tmac/an-old.tmac (initialization): Drop complex setup of LL
	register.
	(TH): Relocate line length reset; no behavior change.
	(after .mso man.local): Initialize LL only if the user hasn't;
	use device default in troff mode, and 78n in nroff mode.

	* tmac/groff_man.7.man.in (Options) <-rLL>: Stop documenting .ll
	hack.

	Fixes <https://savannah.gnu.org/bugs/index.php?58992>.

2020-09-16  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/tests/an-old_LL_init_sanely.sh: Add test.
	* tmac/tmac.am (tmac_TESTS): Run test.

2020-09-15  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/devices/xditview/GXditview.ad: Widen the default geometry
	to accommodate the width of a page rendered using the X100-12
	device.  Display devices these days have much greater horizontal
	resolution than they did 20 years ago.

2020-09-14  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-old.tmac: Use correct point size default for
	X{75,100}-12 devices.

2020-09-14  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/mdoc/doc-common-u (doc-prepare-section-heading): New
	macro defines new string doc-sec-head to enable recognition of
	mixed-case section headings in mdoc man pages.  For example,
	"Name" and "Description" are now recognized in addition to
	"NAME" and "DESCRIPTION".
	(doc-section-{name,synopsis,library,description,see-also,files,
	authors}): Redefine strings to be mixed-case.  Add trailing
	comment guard per recommended best practice.
	(Sh): Call doc-prepare-section-heading instead of
	doc-first-parameter, and compare predefined section strings to
	doc-sec-head instead of doc-str-dfp.

	* tmac/tests/doc-accept-mixed-case-section-headings.sh: Test it.
	* tmac/tmac.am (tmac_TESTS): Run test.
	* tmac/tests/doc-smoke-test.sh: Use mixed-case section headings.

2020-09-03  G. Branden Robinson <g.branden.robinson@gmail.com>

	* makevarescape.sed: Use \[] form of special character escapes.

	The only man page we have that doesn't turn compatibility mode
	off (neqn) also doesn't use any sed-substituted patterns where
	characters replaced by a \[] special character escape form are
	likely to be used.

	The @g@ command prefix is the main avenue for intrusion of such
	escapes, but I think it improbable that many people are going to
	include apostrophes, double quotes, carets, grave accents, or
	tildes in the command prefix; some or all of these will pick
	fights with the shell and require quoting that we don't
	represent in man page text anyway.

	On top of that, neqn is largely a stub page.

	If it's a problem, a better fix than reverting this is to make
	neqn switch out of compatibility mode like our other man pages.

2020-09-03  G. Branden Robinson <g.branden.robinson@gmail.com>

	* FOR-RELEASE: Start a release checklist.  We probably should
	have done the afmtodit.tables update for 1.22.4.  There were no
	AGL changes and the Unicode decomposition changes were limited
	to additions for Balinese (11), CJK compatibility ideographs
	(5), and 13 code points outside the Basic Multilingual Plane.

2020-09-02  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/utils/afmtodit/afmtodit.tables: Regenerate using Unicode
	13.0.0.

2020-09-02  G. Branden Robinson <g.branden.robinson@gmail.com>

	make-afmtodit-tables: Automate AGL reassignments.

	Automate the procedure done manually in
	b72b91e85e80a69304e6569db535bcca0e0ecab5 (9 April 2007), so that
	it doesn't regress when we regenerate afmtodit.tables.

	* src/utils/afmtodit/make-afmtodit-tables: Do it.
	* src/utils/afmtodit/afmtodit.tables: Regenerate it.

2020-09-02  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/groff/groff.1.man (Options) <-E>:
	* src/roff/troff/troff.1.man (Options) <-E>: Document that -E
	implies -Ww.

	Fixes <https://savannah.gnu.org/bugs/index.php?59030>.

2020-09-01  G. Branden Robinson <g.branden.robinson@gmail.com>

	* man/groff_char.7.man: Revise glyph descriptions.

	Fixes <https://savannah.gnu.org/bugs/index.php?59031>.

2020-09-01  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/tty.tmac: Define fallback glyphs for Bell Systems logo
	{non-breaking adjustable space} and radical extension and square
	root extension (both non-printing input breaks) to suppress
	warnings from groff_char(7).  As none of these are encoded in
	Unicode it seems unlikely they will become supported soon.

2020-08-30  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/troff/troff.1.man (Options) <-I>: The current working
	directory is searched _last_, not first, unless the order is
	altered with "-I .".

	* src/roff/groff/groff.1.man (Options) <-I>: Rearrange
	description.

2020-08-25  G. Branden Robinson <g.branden.robinson@gmail.com>

	Update mdoc package to honor HY register as man does now, per
	suggestion from Colin Watson.  Recognize but ignore AD string
	for man package compatibility (essentially "reserving" it),
	though mdoc intentionally does not permit configuration of
	adjustment.

	* tmac/mdoc/doc-ditroff-u:
	* tmac/mdoc/doc-nroff-u: Do it.

	* tmac/mdoc/doc-common-u: Initialize \n[doc-hyphen-flags] from
	\n[HY].

	* tmac/groff_mdoc.7.man \
	(FORMATTING WITH GROFF, TROFF, AND NROFF): Document it.

2020-08-25  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-old.tmac (TH): Reset inter-word and inter-sentence
	spacing to default with each new page rendered.

	{To observe the problem prior to this change,
	  $ groff -mandoc groff_mmse.7 $any_other_man_page
	groff_mmse(7) loads sv.tmac, which changes the sentence
	spacing.}

2020-08-25  G. Branden Robinson <g.branden.robinson@gmail.com>

	* PROBLEMS: Undocument the problem with test-groff and mdoc.
	It's resolved.

	Fixes <https://savannah.gnu.org/bugs/index.php?51073>.

2020-08-25  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/tmac.am (NORMALFILES, MDOCFILES): Drop unused variables.
	($(TMACMDOCFILES) $(TMACSTRIPFILES)): Scrub trailing whitespace.
	Wrap long line.

2020-08-25  G. Branden Robinson <g.branden.robinson@gmail.com>

	mdoc: Relocate within build tree.

	The (modern) mdoc macro package has not been usable within the
	build tree, unlike the others.  This makes it more troublesome
	to test changes, and frustrates deploying our test
	infrastructure against it.  Re-arrange the build tree to
	resemble an installation tree closely enough for the macro
	package to load.

	* tmac/doc-common-u:
	* tmac/doc-ditroff-u:
	* tmac/doc-nroff-u:
	* tmac/doc-syms-u: Rename to...
	* tmac/mdoc/doc-common-u:
	* tmac/mdoc/doc-ditroff-u:
	* tmac/mdoc/doc-nroff-u:
	* tmac/mdoc/doc-syms-u: ...these.

	* tmac/tmac.am (TMACMDOCFILES): Look for files in tmac/mdoc.
	($(TMACMDOCFILES)): Create tmac/mdoc in build tree.

	Fixes <https://savannah.gnu.org/bugs/index.php?51003>.

2020-08-25  G. Branden Robinson <g.branden.robinson@gmail.com>

	Add regression test for usable in-tree mdoc.

	* tmac/tests/doc-smoke-test.sh: Add test.
	* tmac/tmac.am (tmac_TESTS): Run test.

2020-08-22  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/tests/an-old_TH_repairs_ad_damage.sh:
	* tmac/tests/an-old_TH_repairs_hy_damage.sh: Add tests.
	* tmac/tmac.am (tmac_TESTS): Run tests.

2020-08-22  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-old.tmac (TH): Set hyphenation mode to user preference
	with each new page rendered, in case a hostile page meddled with
	'.hy' or '.nh'.
	(after .mso man.local): Relocate setting of default hyphenation
	mode here (instead of just before .mso man.local).  Eliminate
	conditional on \n[an-html]; this doesn't matter because
	grohtml(1) doesn't support hyphenation anyway.  If it does learn
	to hyphenate, we should treat it the same as other output
	devices in any case.  Add comment explaining why we fall back to
	different defaults depending on \n[cR].

2020-08-22  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-old.tmac (TH): Set adjustment to user preference with
	each new page rendered, in case a hostile page meddled with
	'.ad' or '.na'.
	(after .mso man.local): Set the default adjustment mode only if
	a -d option or man.local did not.  Also do the same for the HF
	string; relocate its definition here and make it similarly
	conditional.  Also update comment on setting of CS and CT
	registers and style their conditionals consistently with the
	rest of the package.

	* tmac/groff_man.7.man.in (Strings) <\*(AD>: Document it.
	(Strings) <\*(HF>: Parallelize language with new \*(AD.
	(Options) Expand introductory sentence to discuss -d and -r
	options.
	(Options) <-dAD>: Document default and likely values.  Nobody
	right-justifies or centers man page text; send the curious to
	groff(7) for '.ad' request documentation.
	(Options) <-dHF>: Document default and steer people to groff(7)
	for '.ft' request documentation.

2020-08-21  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-old.tmac (set-an-margin): Rename...
	(an-set-margin): ...to this.  It was the only package-internal
	register, macro, string, or diversion that wasn't named using
	the "an-*" schema.
	(TH, SH, SS): Update call sites.

2020-08-16  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-ext.tmac (.ME, .UE): Restore hyphenation after
	"punctuation" arguments have been output.  The next token will
	always be a space node, the end of the document, or similar.

	* tmac/tmac.am (tmac_XFAIL_TESTS): Mark the punctuation
	hyphenation tests as expected to fail, because they now do.

2020-08-16  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/ps.tmac: Define ordinary hyphen-minus as fallback
	character for U+2011 (non-breaking hyphen).  Prompted by
	discussion with Dave Kemper in Savannah #58390.

2020-08-15  G. Branden Robinson <g.branden.robinson@gmail.com>

	Fix hyphenation bug.  The UR/UE and MT/ME macros were much too
	aggressive about turning hyphenation off.  Disable it only when
	writing the actual URL or email address.

	* tmac/an-ext.tmac (.MT, .UR): Stop disabling hyphenation here.
	(.ME, .UE): Disable hyphenation right before output of
	URL/address; restore it right before output of supplementary
	arguments ("punctuation").

	* tmac/tests/an-ext_ME_punct_hyphenates.sh:
	* tmac/tests/an-ext_MT_body_hyphenates.sh:
	* tmac/tests/an-ext_UE_punct_hyphenates.sh:
	* tmac/tests/an-ext_UR_body_hyphenates.sh: Test behavior.

	* tmac/tmac.am (tmac_TESTS): Run tests.

2020-08-15  G. Branden Robinson <g.branden.robinson@gmail.com>

	Adapt to the fact that \: renables hyphenation.  Rename
	"hyphenless [discretionary] break" to "non-printing break point"
	in documentation.

	* doc/groff.texi (Manipulating Hyphenation): Rename "hyphenless
	break" to "non-printing break point".  Clarify that it is the
	soft hyphen glyph, not necessarily a hyphen, that is ordinarily
	written to the output on hyphenation breaks.  Note that the
	remainder of a word after \: is subject to hyphenation as
	normal.  Note (new) '\:\%' idiom for getting what people will
	want at least some of the time.  Update example to use it.
	* makevarescape.sed: Insert \% after we insert \: to rewrite
	slashes in filenames, to protect later portions of the filename
	from hyphenation.
	* man/groff.7.man (Escape Sequences/Escape short reference):
	Rename "hyphenless break" to "non-printing break point".
	* man/groff_diff.7.man (Language/Escape sequences): Resync with
	our Texinfo manual.
	* tmac/groff_man.7.man.in (Description/Hyperlink and email
	macros): Rename "hyphenless break" to "non-printing break
	point".

2020-08-15  G. Branden Robinson <g.branden.robinson@gmail.com>

	documentation: Re-christen 'ESCAPE_AMPERSAND'.

	s/zero[- ]width space character/non-printing input break/

	* doc/groff.texi (Requests): Rename.  Update conceptual index
	entries; retain old name (with an appended "[sic]") to aid
	readers accustomed to it.
	(Ligatures and kerning): Update conceptual index entries.
	Supply context ("effect on kerning").
	(Drawing requests): Update conceptual index entries.  Supply
	context ("effect on '\l'").
	* man/groff.7.man (Description): Rename in macro-advice-writing
	shorthand.
	(Escape Sequences/Escape short reference): Rename.
	* tmac/groff_man.7.man.in (Description/Command synopsis macros
	[style]: Rename.
	(Description/Portability) [style]: Rename.
	* tmac/groff_mdoc.7.man (TROFF IDIOSYNCRASIES/Macro Usage):
	Rename.
	(TROFF IDIOSYNCRASIES/Other Possible Pitfalls): Rename.

2020-08-14  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/groff_man.7.man.in (Description/{Document structure
	macros/.TH, Horizontal and vertical spacing}): Fix erroneous use
	of "flush left".  The current uses were introduced by me, but
	the page has borne incorrect uses of it as far back as 1999 (in
	the description of .TP).  Simply say "with no indentation"
	instead.

2020-08-13  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/groff_man.7.man.in (Description/Number registers): Inform
	reader that registers can be set in man.local file and
	cross-reference it.
	(Files/*/man.local): [style] Supply example of man.local
	customizations, prompted by recent discussions on groff,
	linux-man, and man-db mailing lists.

2020-08-12  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/tmac.am: Use a stamp file for m4 keyword check.
	(M4CHECK): Add stamp file variable.
	($(M4CHECK)): Create stamp file if check succeeds.

2020-08-12  G. Branden Robinson <g.branden.robinson@gmail.com>

	Split groff_man(7) into two pages; one a (relatively) terse
	reference and the other a tutorial and style guide.  Both are
	generated from the same source, which is processed by m4 into
	two man page sources.

	* tmac/groff_man.7.man: Rename...
	* tmac/groff_man.7.man.in: ...to this.

	* tmac/groff_man.7.man.in: Add m4 directives and define macros.
	Protect m4 keywords in English from unintended expansion (this
	affected the word "include").  Add new .TH and apropos lines for
	style guide.  Convert marker comments into m4 macros for content
	control.  Uncomment material intended only for basic reference
	page.

	* tmac/tmac.am (man7_MANS): Add groff_man_style.7.
	(EXTRADIST) Add groff_man.7.man.in.
	(MOSTLYCLEANFILES): Add m4-generated man page sources
	tmac/groff_man{,_style}.7.man.
	Add targets to generate those same two pages from the renamed
	file.  Add target to grep the page for unprotected English m4
	keywords and halt the build if they are found.  Make generation
	of those pages depend on this new target.

2020-08-11  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/groff_man.7.man: Add material on hooks and encoding.
	(Description, ./Deprecated features): Stop identifying .BT and
	.DT as "deprecated"; they shouldn't ever be called in man pages,
	but that has never been their intention.
	(Description): Identify character encoding and line-ending
	requirements (tutorial/style-guide material).
	(Description/Hooks): Add new subsection to house descriptions of
	.BT and .DT.  Add mnemonic expansions for both.

2020-07-31  G. Branden Robinson <g.branden.robinson@gmail.com>

	* man/groff.7.man (Control Characters): Incorrect claims were
	made.  Double quotes can indeed be used to enclose arguments to
	string interpolations.  The statement about a leading " in a
	string definition (or appendment with .as) was stated too
	generally.  The leading quote is not necessary to include
	leading tab characters, which can be input as-is, even in
	compatibility mode.

2020-07-28  G. Branden Robinson <g.branden.robinson@gmail.com>

	* man/groff.7.man (Requests/Request short reference/.ft): Fix
	some outright damage in the description of the request; the
	escape sequences that are synonymous with a nullary .ft had been
	wrongly removed.

2020-07-25  G. Branden Robinson <g.branden.robinson@gmail.com>

	* doc/meintro.me:
	* doc/meref.me:
	* tmac/e.tmac-u: Remove postal address for Eric Allman.  It's
	probably decades out of date.  Adjust footnote symbols.  Thanks
	to Dave Kemper for the bug report and the patch.  Fixes
	<https://savannah.gnu.org/bugs/?58726>.

2020-07-23  G. Branden Robinson <g.branden.robinson@gmail.com>

	Migrate macro packages from font CW to CR.  The font name "CW"
	{"constant-width"} is a legacy item we can dispose of (except
	for the DVI device, which also has CWI for "constant-width
	italic"), and much of the groff codebase already did starting
	with commit 0de1d6d79cdb959ffa7dac3af77c2a36ef31873f {October
	2017}.  Courier is available in the usual four styles {roman,
	bold, italic, bold+italic}.

	* tmac/an-ext.tmac (.EX): Set font to R, not CW.  The existing
	.ft request was somewhat redundant with the '.do fam C'
	immediately before, which set the font family to Courier.
	* tmac/s.tmac (.UC): Use font CR, not CW.

2020-07-23  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/tty.tmac: Stop suppressing nonexistent font warning.
	Prompted by a 2017 suggestion and patch from Bjarni Ingi
	Gislason.  Documents and macro packages that want to change the
	font family should do so in awareness that this is meaningless
	on terminal (nroff) devices (and -Thtml as well).

	Fixes <https://savannah.gnu.org/bugs/?51364>.

2020-07-18  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/groff_man.7.man (.PP, .LP, .P): Fix error; these macros
	do not reset the left margin.

2020-07-16  G. Branden Robinson <g.branden.robinson@gmail.com>

	* doc/groff.texi (Strings): Document behavior of .ds request
	when only one argument is supplied.  (The string is defined as
	empty.)  Thanks to Dave Kemper for the report and the patch.

	Fixes <https://savannah.gnu.org/bugs/index.php?58746>.

2020-07-16  G. Branden Robinson <g.branden.robinson@gmail.com>

	* doc/groff.texi (Using Symbols): Fix error in .rfschar
	description, which should refer to "font f" rather than "glyph
	f".  Thanks to Dave Kemper for the report and the patch.

	Fixes <https://savannah.gnu.org/bugs/index.php?58767>.

2020-07-12  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/groff_man.7.man (.EE, .YS): Fix error; refer to "initial
	hyphenation setting" instead of "previous hyphenation mode".
	Incidentally, this fact points out why putting ".hy 0" or ".nh"
	in your man page is futile.

2020-06-28  G. Branden Robinson <g.branden.robinson@gmail.com>

	* man/groff.7.man (Requests/Request short reference): Fix error
	in description of .hc; it changes the hyphenation character
	rather than supplying an additional one.

2020-06-12  G. Branden Robinson <g.branden.robinson@gmail.com>

	* doc/groff.texi (Groff Options): Remove editorial comment about
	'-a' option being "useless".  It isn't.  Update example for
	contemporary systems (like Debian) and to reflect the fact that
	the GNU troff(1) man page needs to be preprocessed with tbl(1).
	(Invoking grotty): Recast discussion of -c option, importing
	much language from grotty(1) page rewrite from a year ago.  Add
	program index entries for col, more, and ul.  Fix transposition
	error in ISO document number.

	* src/devices/grotty/grotty.1.man (Description/Legacy output
	format): Make slight wording changes prompted by content of
	parallel section in our Texinfo manual.

	* src/roff/groff/groff.1.man (Options/-a): Parallelize with
	first sentence of corresponding material in our Texinfo
	manual.

	* src/roff/troff/troff.1.man (Options/-a): Parallelize with
	our Texinfo manual.

	Fixes the rest of
	<https://savannah.gnu.org/bugs/index.php?55278>.

2020-06-12  G. Branden Robinson <g.branden.robinson@gmail.com>

	* man/groff_diff.7.man (Language/Long names): Fix error; groff
	adds three new requests with short names, not two.  List them in
	an adjacent comment.

2020-06-04  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-ext.tmac (.ME, .UE): Fix portability issue.  While
	widely supported, the \$* escape is not documented in CSTR #54.
	If groff is not the typesetter, append macro arguments using
	\$1, \$2, ..., \$9 instead.

2020-05-19  G. Branden Robinson <g.branden.robinson@gmail.com>

	* man/groff.7.man (Numerical Expressions): Fix error: negative
	expressions evaluate false, not true as was implied.
	Parallelize descriptions with our Texinfo manual and
	groff_diff(7) (in abbreviated form).

2020-05-18  G. Branden Robinson <g.branden.robinson@gmail.com>

	* doc/groff.texi (Manipulating Filling and Adjusting): Fix error
	in code sample: missing 'n' in number register interpolation.

2020-05-14  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/preproc/preconv/tests/smoke-test.sh: Make BOM detection
	override less hinky (i.e., use more normative input).  Add tests
	for all five detected BOMs.

2020-05-09  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/troff/env.cpp (space_size): Prevent assertion
	failure.  If an argument to the .ss request is negative, throw a
	range warning and ignore it.
	* src/roff/groff/tests/regression_savannah_58337.sh: Add test.
	* src/roff/groff/groff.am (groff_TESTS): Run test.

	Fixes https://savannah.gnu.org/bugs/index.php?58337.

2020-05-08  G. Branden Robinson <g.branden.robinson@gmail.com>

	Update documentation of .ss request.

	* doc/groff.texi (Manipulating Filling and Adjusting): Rewrite
	documentation of .ss request and \n[.ss] and \n[.sss] escapes.
	Note that negative values are not permitted in either argument
	to .ss.  Use new terminology, "minimal inter-word spacing" and
	"additional inter-sentence spacing" for clarity.  Clarify that
	additional inter-sentence spacing is only used when the output
	line is not full when the end of a sentence occurs.  Add index
	nodes to help readers find discussion of details of spacing
	between words and sentences.  Move discussion of differences
	from AT&T troff to section "Implementation Differences".  Update
	example to more closely resemble a real-world case, use second
	argument to .ss request, and eliminate hackish use of .nop
	request.

	* man/groff_diff.7.man (New number registers): Recast in
	parallel with the foregoing.

	* man/groff.7.man (Read-only registers): Use new terminology and
	describe \n[.ss] and \n[.sss] in meaningful terms, not by
	reference to arguments to the .ss request (which wasn't even
	accurate, because these registers have default values).

	Fixes https://savannah.gnu.org/bugs/index.php?54101.

2020-05-06  G. Branden Robinson <g.branden.robinson@gmail.com>

	Undocument plans to support end-of-file GNU Emacs coding tags.

	* src/preproc/preconv/preconv.cpp (check_coding_tag):  Update
	comments.
	(detect_file_encoding): Alter debugging output so it's easier to
	grep and verify Emacs coding tag detection.

	* src/preproc/preconv/preconv.1.man (Bugs): Delete; its sole
	concern was the absence of this feature.
	(Usage): Document detection algorithm in more detail.  Note
	which detection methods don't work on unseekable input (pipes).
	Offer recommendations for those struggling with encoding
	detection.
	(Usage/Coding Tags): Stop manipulating line adjustment.  Use
	hyphen-minus (\- escape) characters in coding tag names, since
	they are literals that one might copy and paste.  Stop
	referencing XEmacs, whose development appears moribund.
	(See Also): Add cross-references to iconv(3) and locale(7) man
	pages.

	* src/preproc/preconv/tests/smoke-test.sh: Test each of the
	steps in the detection algorithm.
	* src/preproc/preconv/preconv.am: Run test.
	(preconv_TESTS): Add new variable.
	(TESTS): Append $(preconv_TESTS).

2020-05-05  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/utils/afmtodit/afmtodit.pl: Format usage message with
	full capitals for parameters, and break out -v option in a
	separate "synopsis".

2020-05-05  G. Branden Robinson <g.branden.robinson@gmail.com>

	* font/devpdf/util/BuildFoundries.pl: Stop throwing away
	diagnostics from afmtodit.  This results in only one extra line
	of build output:

		both Upsilon1 and Upsilon map to *U at .../afmtodit line
		6413.

2020-05-05  G. Branden Robinson <g.branden.robinson@gmail.com>

	Correct documentation of .pm request.

	* man/groff.7.man (Requests/Request short reference): The .pm
	request's classical behavior was described instead of groff's,
	and omitted mention of strings and diversions; correct it.

	* man/groff_diff.7.man (Implementation Differences): Document
	this difference between AT&T troff and groff.

	* doc/groff.texi (Debugging): Relocate description of .pm
	behavioral difference...
	(Implementation Differences): ...hither.

2020-04-30  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/utils/addftinfo/addftinfo.cpp (usage):
	* src/utils/tfmtodit/tfmtodit.cpp (usage): Add "usage:" prefix
	to messages documenting auxiliary modes of invoking the program.
	The output doesn't look right without one, and it feels
	dishonest to not document the relevant options (-v, --version)
	disjunctively.  I'm trying to strike a balance between the
	ultra-terse BSD approach and the ultra-garrulous GNU one (see,
	e.g., ls(1)).  Likely both camps will be unhappy.  :-/

2020-04-30  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/utils/tfmtodit/tfmtodit.cpp (read_map): Report invalid
	character code from map file in diagnostic.
	(main): Report invalid skew character position in diagnostic.
	Explicitly report insufficient arguments in addition to usage
	message.  Lift invariant computed expressions out of loops (more
	to shorten long lines than because I think the compiler won't
	figure it out).  Give content to "impossible assertion".
	(tfm::load): Capitalize TFM initialism in diagnostics.
	(usage): Use full capitals for parameters as is conventional.
	Document disjunction of -v/--version flag from other
	invocations.

2020-04-29  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/utils/addftinfo/addftinfo.cpp (usage): Add overloaded
	version that accepts a constant string argument, which emits the
	argument as a diagnostic and then calls usage().
	(main): Add diagnostics to usage message where the problem is
	clear.  Add comment explaining why it sometimes isn't.
	(usage): Refactor main usage message (which prints the summary)
	to report the actual names of the accepted option arguments
	instead of just "-param", which is not literally accepted.

	Sort param_table alphabetically for use by the usage message.

2020-04-22  G. Branden Robinson <g.branden.robinson@gmail.com>

	Delete groffer.

	Per discussion on the groff development mailing list, there is
	no desire to retain the maintenance of this portion of the groff
	distribution.

	See
	<https://lists.gnu.org/archive/html/groff/2020-04/msg00051.html>
	et seq.

	* contrib/groffer: Recursively delete.

	* Makefile.am:
	* arch/mingw/mingw.am: Stop building groffer.

	* m4/groff.m4 (GROFF_GROFFERDIR_DEFAULT):
	(GROFF_GROFFERDIR_OPTION): Delete; remove "--with-grofferdir"
	configuration option.
	* configure.ac: Stop calling these macros.

	* MANIFEST:
	* NEWS:
	* PROJECTS:
	* TODO:
	* contrib/chem/chem.1.man:
	* contrib/chem/examples/122/README.txt:
	* contrib/chem/examples/README.txt:
	* contrib/glilypond/glilypond.1.man:
	* contrib/gperl/gperl.1.man:
	* contrib/gpinyin/gpinyin.1.man:
	* contrib/groff_filenames/groff_filenames.5.man:
	* man/groff_font.5.man:
	* man/roff.7.man:
	* src/roff/groff/groff.1.man:
	* src/roff/grog/grog.1.man:
	* src/utils/addftinfo/addftinfo.1.man:
	* tmac/groff_trace.7.man: Delete references to groffer.

2020-04-19  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/include/curtime.h: #include <time.h> if we're returning
	a time_t from current_time().

	* src/libs/libgroff/curtime.cpp (current_time): Quote
	$SOURCE_DATE_EPOCH variable content in diagnostics produced due
	to bad input since it's under user control and could have all
	kinds of bogosity in it (like whitespace).

2020-04-19  G. Branden Robinson <g.branden.robinson@gmail.com>

	* **/*.{man,tmac}: Save compatibility mode robustly.

	Use new \n[.cp] register to save compatibilty mode.

	Use register names based on the filename (at the source
	maintenance level) to avoid clobbering other files' saved
	compatibility modes.

	* tmac/html.tmac: Eliminate test of saved-compatibility
	register by moving its body inside the block where compatibility
	mode is off.  This is the only part of this changeset that was
	not automated.

	Fixes <https://savannah.gnu.org/bugs/index.php?58162>.

2020-04-16  G. Branden Robinson <g.branden.robinson@gmail.com>

	Implement new read-only .cp register.

	Within a .do request, \n[.cp] holds the saved value of
	compatibility mode.

	The register \n[.cp] is specialized and may require a statement
	of rationale.  When writing macro packages or documents that use
	groff features and which may be mixed with other packages or
	documents that do notcommon scenarios include serial processing
	of man pages or use of the .so or .mso requestsyou may desire
	correct operation regardless of compatibility mode in the
	surrounding context.  It may occur to you to save the existing
	value of \n(.C into a register, say, _C, at the beginning of
	your file, turn compatibility mode off with .cp 0, then
	restore it from that register at the end with .cp \n(_C.  At
	the same time, a modular design of a document or macro package
	may lead you to multiple layers of inclusion.  You cannot use
	the same register name everywhere or you risk clobbering the
	value from a preceding or enclosing context.  The twocharacter
	register namespace of AT&T troff is confining and mnemonically
	challenging; you may wish to use groff's more capacious
	namespace.  However, attempting .nr _my_saved_C \n(.C will not
	work in compatibility mode; the register name is too long.
	This is exactly what .do is for, you think, .do nr
	_my_saved_C \n(.C.  The foregoing will always save zero to your
	register, because .do turns compatibility mode off while it
	interprets its argument list.  What you need is:
		.do nr _my_saved_C \n[.cp]
		.cp 0
	at the beginning of your file, followed by
		.cp _my_saved_C
	at the end.  As in the C language, we all have to share one big
	namespace, so choose a register name that is unlikely to collide
	with other uses.

	* src/roff/troff/input.cpp (do_request, init_input_requests):
	Implement it.

	* doc/groff.texi:
	* man/groff.7.man:
	* man/groff_diff.7.man: Document it.

	* src/roff/groff/tests/dot-cp_register_works.sh: Test it.
	* src/roff/groff/groff.am (groff_TESTS): Run test.

	Enables a fix for
	<https://savannah.gnu.org/bugs/index.php?58162>.

	Thanks to John Gardner and Ingo Schwarze for the discussion.

2020-04-15  G. Branden Robinson <g.branden.robinson@gmail.com>

	* doc/groff.texi (Implementation Differences):
	* man/groff_diff.7.man (New requests): Rewrite description of
	.do request, and replace example with a more illustrative one.

	* man/groff.7.man (Request short reference): Rewrite description
	of .do request briefly.

2020-04-14  G. Branden Robinson <g.branden.robinson@gmail.com>

	* doc/groff.texi (Implementation Differences): Remove incorrect
	claim.  The .C register cannot be manipulated manually.

2020-04-14  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/groff/tests/smoke-test_html_device.sh: Simplify
	charmap test.

2020-04-13  G. Branden Robinson <g.branden.robinson@gmail.com>

	It's too easy for the nroff version to get desynced from the
	groff version when we're running test cases, leading to spurious
	results.  Make it easier to see a discrepancy.

	* src/roff/nroff/nroff.sh: Call groff with -v or --version when
	we are called that way.  Let test cases tell us to use
	test-groff as groff with an environment variable.

	* src/roff/nroff/tests/verbose_option_works.sh.in: Rename to...
	* src/roff/nroff/tests/verbose_option_works.sh: ...this.  Check
	the nroff version being tested against the groff version being
	wrapped.  This exposes a bug; the system groff rather than the
	build tree groff was being invoked.  Refactor.  Stop messing
	with @GROFF_BIN_PATH_SETUP@ (enabling the rename); instead, let
	test-groff handle that for us.  Locate it and export the
	variable GROFF_TEST_GROFF so nroff can find it.  Because we
	manipulate $PATH to run the tests, the $PATH of an installed
	groff system will _always_ differ from that used by a build
	tree; ignore it in the test cases.  Dispose of bashisms and set
	shebang to /bin/sh.

	* src/roff/nroff/nroff.am: Stop generating the above test
	script.  It can now be run as it ships.

2020-04-13  G. Branden Robinson <g.branden.robinson@gmail.com>

	Make our assert() C99-conformant.

	groff has its own implementation of the standard C library's
	assert() macro.  It hasn't been updated since C89.  C99 requires
	that the diagnostic emitted by assert() contain the failing
	expression and name of the function in scope.

	* src/include/assert.h: Add additional pointer to const char
	arguments to do_assert() and assertion_failed() for function
	name and stringified expression.
	(assertion_failed): Update prototype.
	(do_assert): Accept 'func' and 'msg' parameters and pass them to
	assertion_failed().
	(assert): Update macro to collect '__func__' and stringify the
	expr parameter (as 'msg') and pass them do do_assert().
	* src/libs/libgroff/assert.cpp (assertion_failed): Rewrite
	diagnostic to more closely match GNU Coding Style format and
	also report function and failing expression.

	Example output:
		troff: ../src/roff/troff/input.cpp:2644: do_request():
		assertion failed: '0 == "But first, here's a rotten old
		BBC programme."'

	We have no excuse to assert(0) ever again.  Express the
	invariant that has been violated.

2020-04-13  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/groff/tests/smoke-test_html_device.sh: Set
	LC_CTYPE=C.UTF-8 so that byte sequences in the pipelines are
	handled correctly.  Skip the test if the environment doesn't
	support UTF-8.  Thanks to Bjarni Ingi Gislason for the trouble
	report.

	Fixes <https://savannah.gnu.org/bugs/?58164>.

2020-04-13  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/html.tmac: Use .do so we correctly load unicode.tmac in
	compatibility mode.

	Fixes the following problem (wrapped, filenames abbreviated):

	$ echo | ./build/test-groff -C -Thtml >/dev/null
	troff: backtrace: file '.../groff/build/../tmac/html.tmac':546
	troff: backtrace: file '.../groff/build/../tmac/troffrc':30
	troff: .../groff/build/../tmac/html.tmac:546: warning: macro
		'ms' not defined

2020-04-13  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/groff/tests/smoke-test_html_device.sh: Add test.
	* src/roff/groff/groff.am (groff_TESTS): Run test.

2020-04-12  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/groff/tests/regression_savannah_58153.sh:
	* src/roff/groff/tests/\
	use_point_size_escape_with_single_digit_arg.sh: Use "set -e" to
	ensure that multi-test script files don't hide problems.  There
	are arguments against "set -e" (and you can ask Greg Wooledge
	for all of them), but I'm so used to it from years of writing
	Debian package maintainer scripts that I feel comfortable with
	it.  It is less verbose than several alternatives (especially
	having one test script per case).

	* src/roff/groff/tests/string_case_xform_unicode_escape.sh:
	Update with respect to new failure output (in a comment only,
	since this is an XFAIL test).

	* tmac/tests/an-old_AT_and_UC_footer_saved_and_restored.sh:
	Drop unnecessary "|| exit 1" from end of script.  Incidentally,
	this script illustrates an alternative to "set -e".

2020-04-11  G. Branden Robinson <g.branden.robinson@gmail.com>

	Rework documentation of .spreadwarn.

	* doc/groff.texi (Debugging):
	* man/groff.7.man (Request short reference):
	* man/groff_diff.7.man (New requests): Recast description of
	.spreadwarn request, some based on suggestions from Dave Kemper.
	Make more prominent the fact that spreading only applies to
	adjustment mode 'b'.  Document warning type used.

	Fixes half of Savannah #58035.

2020-04-11  G. Branden Robinson <g.branden.robinson@gmail.com>

	Require Texinfo 5.0 (February 2013) at a minimum.

	* m4/groff.m4 (GROFF_MAKEINFO): Check for version 5.0 (increased
	from 4.8).  Update diagnostics and comments.

	* INSTALL.extra:
	* README:
	* doc/groff.texi:
	* doc/webpage.ms: Document updated requirement.

	* doc/fixinfo.sh: Delete; it is no longer necessary to work
	around Texinfo 4.x bugs.

	* doc/doc.am (EXTRA_DIST): Stop shipping fixinfo.sh.
	(.texi.html): Remove makeinfo < 5.0 version check and consequent
	execution of fixinfo.sh.  Update comment.

2020-04-11  G. Branden Robinson <g.branden.robinson@gmail.com>

	Enable backtracing across process/file boundaries when errors or
	non-ignored warnings are encountered.

	Experimentation reveals that .so, .mso, and .pso requests acted
	as barriers to backtracing except when explicitly requested with
	the .backtrace request.  Judging by the git history, this
	behavior dates back to June 1991 or earlier.  The intention,
	according to a source comment, was only to suppress the
	backtrace output for the line corresponding to the outermost
	level of the input stack (commonly, a file argument to groff).
	Unfortunately, that wasn't its only effect.

	This change does result in one additional line of output for
	each error or (non-ignored) warning when -b is given.  However,
	I regard this as unobjectionable because {1} a backtrace was in
	fact explicitly requested; and {2} it seems a poor tradeoff to
	suppress most of the backtrace in some complicated and
	frustrating cases for the sake of one fewer line of backtrace
	output in a trivial one.

	Now, backtracing behaves the same no matter what triggers it.

	Fixes Savannah #58153.

	* src/roff/troff/input.cpp (file_iterator::backtrace): Call
	get_location() for its side effect of rewriting a filename of
	"-" to "<standard input>", for consistency with other diagnostic
	messages.  (In this class, this member function always returns
	1, so ignore the return value.  This fact is an essential part
	of what led to the bug; the conditional
		p && !p->get_location(0, &f, &n)
	which appeared in the for loop of input_stack::backtrace() prior
	to this change would always evaluate to false when a node of the
	file_iterator class was encountered.)
	(input_stack::backtrace): Replace member function body with that
	of input_stack::backtrace_all().
	(input_stack::backtrace_all): Delete.
	(backtrace_request): Update the only call site of the above.

	* src/roff/groff/tests/regression_savannah_58153.sh: Add test.
	* src/roff/groff/groff.am (groff_TESTS): Run test.

	* src/roff/groff/tests/string_case_xform_errors.sh: Update
	regression test to not be confounded by additional line of
	backtrace output.  Remove bashism along the way.

	* doc/groff.texi:
	* man/groff.7.man:
	* man/groff_diff.7.man: Update documentation.

2020-04-10  G. Branden Robinson <g.branden.robinson@gmail.com>

	Reorganize backtrace output.

	* src/roff/troff/input.cpp (string_iterator::backtrace):
	Prefix the output with the program name if it is known.  In a
	deviation from the GNU Coding Standards, put the string
	"backtrace:" immediately next instead of the file and line
	number; this is because, particularly in cases where the
	backtrace is most interesting or needed, it will produce
	multiple lines of output and the common prefix aids visual
	understanding.
	(file_iterator::backtrace): As above; also, change prefix for
	popened nodes in the iterator from "process" to "pipe".  This
	seemed preferable to omitting the information entirely or using
	an inscrutable sigil like 'f' or 'p'.  The advantage is that the
	output is better aligned--better ergonomics for those who have
	to cope with a lot of it.  Furthermore, output the filename only
	once.

	Example of old and new output:

	/tmp/inner:2: backtrace: file '/tmp/inner'
	echo .so /tmp/inner:1: backtrace: process 'echo .so /tmp/inner'
	/tmp/outer:1: backtrace: file '/tmp/outer'

	troff: backtrace: file '/tmp/inner':2
	troff: backtrace: pipe 'echo .so /tmp/inner':1
	troff: backtrace: file '/tmp/outer':1

2020-04-10  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/troff/input.cpp (read_size): Add units to diagnostic.
	This function works only with device-specific basic units
	internally; users likely think in terms of point size, so add
	the basic unit suffix "u" to offer a hint about what's going on.

	Example:
	$ groff -ww >/dev/null
	\s[10]A\s[-12]B
	troff: <standard input>:1: warning: point-size escape results in
	non-positive size -2000u; set to 1u

	On a PostScript device with 1000 basic units to the point, the
	difference is important and would be confusing without the unit
	indication.

2020-04-08  G. Branden Robinson <g.branden.robinson@gmail.com>

	Correct and clarify point size documentation.

	Our Texinfo manual has long documented the request '.ps 0' as
	restoring the previous point size (just as '\s0' or '.ps' with
	no argument does), but this is incorrect; since groff 1.02 or
	earlier (June 1991), the request has not actually worked this
	way.  Instead, '.ps 0' sets the point size to 1 basic unit
	{though output drivers may clamp this to a higher value}.  This
	behavior is consistent with AT&T troff, Hierloom Doctools troff
	and, per Ingo Schwarze, Plan 9 troff.  (It is, however, not
	consistent with neatroff.)

	* doc/groff.texi (Changing Type Sizes): Stop claiming that '.ps
	0' works like '\s0'.  Note that the resulting (computed) point
	size, not the argument, is clamped.  Note that it is
	non-positive, not negative, point sizes that are clamped to 1u.
	Add (forward) cross-reference to section where \n[.ps] is
	defined since it is mentioned here.  Move explanation of special
	handling of zero argument to \s escape description.

	* man/groff.7.man (Request short reference): Explain .ps N
	independently of \s.  Note clamping behavior.

2020-04-06  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/troff/input.cpp (read_size): Correctly brace 'else'
	block.

	* src/roff/groff/tests/\
	use_point_size_escape_with_single_digit_arg.sh:
	Check that we get a diagnostic when relying on ambiguous form.

2020-04-04  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/troff/input.cpp (read_size): Move special-case
	interpretation of the '\sN' form of point-size escapes when 'N'
	is 1, 2, or 3 to compatibility mode (groff -C) only, and throw
	error diagnostic with suggestion for remedy if encountered.

	Traditionally, '\s36A' is interpreted as "set point size to 36,
	then emit 'A'".  However, only values in the range 10-39 are
	handled specially; '\s40A' is interpreted as a four-point "0A".
	This is unlike anything else in *roff grammar; see \*, \$, \f,
	\F, \g, \k, \m, \M, \n, \V, \Y, and \z.

	To anticipate objections: Why not throw only a warning?  Because
	there isn't a warning category for supported but ambiguous
	syntax (this behavior of AT&T troff dates back to the mid-1970s
	but was not documented in the Troff User's Manual until 1992).
	Why not throw the error outside of compatibility mode too?
	Because outside of compatibility mode we (now) have an
	unambiguous parse.

	Background: The Graphic Systems C/A/T phototypesetter (the
	original device target for AT&T troff) only supported a few
	discrete point sizes in the range 6..36, so Ossanna
	special-cased the parser to do what the user must have meant.
	Kernighan warned of this in the 1992 revision of CSTR #54
	{2.3}, and more recently, McIlroy referred to it as a "living
	fossil".

	See:
	  https://lists.gnu.org/archive/html/groff/2020-03/msg00054.html
	  https://lists.gnu.org/archive/html/groff/2020-04/msg00002.html
	  https://lists.gnu.org/archive/html/groff/2020-04/msg00015.html
	and follow-ups for discussion.

	* NEWS: Advise users of behavior change and offer guidance.

	* doc/groff.texi:
	* man/groff.7.man: Document the restriction of special handling
	of point-size arguments to '\s' to compatibility mode.

	* src/roff/groff/tests/\
	use_point_size_escape_with_single_digit_arg.sh: Add regression
	test.
	* src/roff/groff/groff.am (groff_TESTS): Run test.

2020-04-04  G. Branden Robinson <g.branden.robinson@gmail.com>

	Improve point-size escape diagnostics.

	* src/roff/troff/input.cpp (read_size): Disclose context
	{point-size escape intepretation} in diagnostic messages.  When
	a "bad digit" is encountered, describe it if possible.  When a
	relative adjustment results in a negative point size, report the
	computed value.  Also rename a variable for slightly more
	clarity ("bad" does not refer to all bad parses, just some cases
	of bad digits), and update an insufficiently generalized comment
	{"\s(00" is also an acceptable expression for point-size zero}.

	Based on suggestions by Ingo Schwarze and Bjarni Ingi Gislason.

2020-04-01  G. Branden Robinson <g.branden.robinson@gmail.com>

	Align diagnostic message format.

	* src/libs/libgroff/error.cpp (do_error_with_file_and_line):
	* src/roff/troff/input.cpp (do_error):
	Display the diagnostic level when it is "error", instead of
	leaving it implicit.

	* src/roff/troff/input.cpp (error_with_file_and_line): Include
	the program name in the diagnostic message if it is known.

	* src/roff/groff/tests/string_case_xform_errors.sh: Update
	diagnostic message expectation.

2020-02-10  G. Branden Robinson <g.branden.robinson@gmail.com>

	* doc/groff.texi (Page Motions):
	* man/groff.7.man (Single-character escapes): Document
	non-breaking spaces as such.

	Report and patch by Dave Kemper <saint.snit@gmail.com>.
	Fixes <https://savannah.gnu.org/bugs/index.php?55954>.

2020-02-10  G. Branden Robinson <g.branden.robinson@gmail.com>

	nroff: Implement -P and -V options.

	* src/roff/nroff/nroff.sh: Recognize -P option (with argument)
	and pass it through to groff.  Recognize -V option; if given,
	display constructed groff command instead of executing it.
	Update usage message to document new options.  Tidy up shell
	style and indentation.  Add comments.
	* src/roff/nroff/nroff.1.man: Document new -P and -V options.
	* src/roff/nroff/tests/verbose_option_works.sh.in: Test -V
	option.
	* src/roff/nroff/nroff.am: Generate test and run it.

2020-02-06  G. Branden Robinson <g.branden.robinson@gmail.com>

	Stop ms macro package from manipulating warnings.

	* tmac/s.tmac: Remove code block that attempted to enable all
	warnings "only if none are given on the command line".  It did
	this by simply comparing the value of the warn register
	{\n[.warn]} against the default value; but of course, a user
	could specify -w options that exactly matched the default and
	the test would not be able to tell, causing puzzling and
	undesired behavior.  Furthermore, the hard-coded default was out
	of date and did not correspond to recent releases of groff.  If
	you want all warnings on, use the ".warn" request with no
	arguments in your ms document or pass "-w w" to groff (see
	troff(1) or our Texinfo manual for more on warnings).

	Thanks to Bjarni Ingi Gislason for bringing this issue to our
	attention.

	Resolves <https://savannah.gnu.org/bugs/?57583>.

2020-01-21  George HELFFRICH  <ghfbsd@gmail.com>

	[me]: Fix regression of '.nm' (#57638).

	* tmac/e.tmac-u (nm): Use saved point size and font position
	for line numbering only if those registers exist.

	Fixes <https://savannah.gnu.org/bugs/index.php?57638>.

2020-01-18  Ingo Schwarze  <schwarze@openbsd.org>

	Accept any number of arguments for .Dd in the groff_mdoc(7)
	macros.

	* tmac/doc-common-u: The .Dd macro behaved in a weird way:
	Without arguments, it printed the string "Epoch".
	With one, two, four, or more arguments, it ignored all arguments
	and used the current date instead.
	Only for exactly three arguments, it printed the arguments.
	None of this made sense.  Giving the date as "Epoch" is
	absurd, and printing the current date is just misleading:
	why should a document be considered up-to-date when the author
	did not even bother to state the date of the last change?
	Admittedly, the behaviour for 0 and 4 or more arguments
	already appeared 4.3BSD-Reno, and the behaviour for 2 or 3
	arguments in 4.4BSD.  But it was already wrong even in those
	days: several manual pages in 4.4BSD gave .Dd a single, quoted
	argument, e.g. .Dd "June 9, 1993": cap_mkdb(1), id(1), sed(1),
	err(3), getcap(3), sysctl(3), amd(8), disklabel(8), and others.
	Consequently, simply print all the arguments, no matter how
	many there are.

	This bug was found by Jonathan Gray <jsg@openbsd.org>
	while he looked at 4.xBSD manual pages.

2020-01-18  G. Branden Robinson <g.branden.robinson@gmail.com>

	* doc/groff.texi: Document initial empty set membership of
	characters with cflags values of 128, 256, or 512 in parallel
	with preceding paragraphs regarding smaller powers of two.

	Report and patch by Dave Kemper <saint.snit@gmail.com>.
	Fixes <https://savannah.gnu.org/bugs/?57549>.

2020-01-18  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/groff/tests/*.sh: Rename some tests so their
	filenames are more self-descriptive.
	* src/roff/groff/groff.am (groff_TESTS): Update.

2020-01-18  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/groff/tests/transparent_end-of-sentence_chars.sh: Add
	test for end-of-sentence recognition.
	* src/roff/groff/groff.am (groff_TESTS): Run test.

2020-01-18  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/troff/input.cpp: Mark \[dd] character (double dagger)
	as transparent for purposes of end-of-sentence recognition.

	* doc/groff.texi (Sentences):
	* man/groff_diff.7.man (New requests/.cflags): Document this.

	Report and patch by Dave Kemper <saint.snit@gmail.com>.
	Fixes <https://savannah.gnu.org/bugs/?57546>.

2020-01-17  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/preproc/refer/refer.1.man (See Also):
	* src/utils/indxbib/indxbib.1.man (See Also):
	* src/utils/lkbib/lkbib.1.man (See Also):
	* src/utils/lookbib/lookbib.1.man (See Also): Add bibliographic
	reference to the original Bell Labs "refer" paper by Mike Lesk.

2020-01-17  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/tests/an-old_AT_and_UC_footer_saved_and_restored.sh: Add
	regression test for Ingo's change below.

2020-01-16  Ingo Schwarze  <schwarze@openbsd.org>

	Repair .AT and .UC in the groff_man(7) macros.

	* tmac/an-old.tmac: Setting user-defined strings in a macro that
	will later be called indirectly from page location traps is
	excessively complicated.  Besides, the implementation doesn't
	work: when the trap is finally sprung, the defaults from the
	an-init macro clobber what the author specified with .AT or .UC.
	Instead, all that is needed is setting the strings for the
	header before triggering the page break, such that they appear
	right away, while setting the strings for the footer after the
	page break, such that they don't appear on the previous page.

	This bug was found by Jonathan Gray <jsg@openbsd.org> while he
	looked at 4.xBSD manual pages.

2020-01-16  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/groff_man.7.man (Document structure macros/.SH): Fix
	errors in footer description.

2020-01-12  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/tests/an-old_CS_register_on.sh: Tweak flags; all the
	other tests in this group pass "-Tascii -P-cbou" instead of
	"-Tutf8".  (This is so that output is easy to grep from a shell
	script.)  Bring this test into line.  Does not regress anything.

2019-12-30  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Certain pdfmark destination names caused gropdf to fail.

	* src/devices/gropdf/gropdf.pl: Look for pdfmark types, (i.e.
	DEST, OUT, ANN), only preceding 'pdfmark' at end of line, not
	anywhere else.

2019-12-30  Ingo Schwarze  <schwarze@openbsd.org>

	Correct output of sprintf("%%") in pic(1).

	* src/preproc/pic/pic.ypp: Print "%" rather than "%%".

	Bug reported by Doug McIlroy <doug at cs dot dartmouth dot edu>.
	Patch using feedback from Larry McVoy <lm at mcvoy dot com>.

2019-12-29  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Update man page of gropdf to document \X calls.

	* src/devices/gropdf/gropdf.1.man: The calls 'pagename' and
	  'switchtopage' (used by mom to relocate TOC) are documented,
	  together with their convenience commands '.pdfpagename' and
	  '.pdfswitchtopage'.

2019-12-29  Ingo Schwarze  <schwarze@openbsd.org>

	Improve documentation of pic(1) regarding printf.

	* src/preproc/pic/pic.1.man:
	  Document which conversion specifications are supported.
	* doc/pic.ms:
	  Correct the list of supported conversion specifications.

2019-12-21  Ingo Schwarze  <schwarze@openbsd.org>

	Update NetBSD, OpenBSD, FreeBSD, Darwin, and DragonFly version
	strings.

	* tmac/doc-common-u: Update.
	* tmac/groff_mdoc.7.man: Synchronize.

	Based on a patch from Guillem Jover <guillem@debian.org>
	via Colin Watson <cjwatson@debian.org>, tweaked by me.
	Fixes: https://bugs.debian.org/867123

2019-09-22  G. Branden Robinson <g.branden.robinson@gmail.com>

	Use a vertical spacing of 1v between paragraphs in man page
	examples.  This looks better (on typesetter devices like
	PostScript and PDF) with the Courier font family also used in
	examples.  Typewriter devices (like the terminal) already used
	an inter-paragraph spacing of 1v.

	* tmac/an-ext.tmac (EX): Save the value of the PD number
	register (inter-paragraph distance), and set it to 1v.
	(EE): Restore previous value of the PD register.

2019-09-21  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Changes to allow configure to check for URW fonts

	* font/devpdf/util/BuildFoundries.pl: Call the program with
	--dirURW with path provided to ./configure, and --check to do
	a dry-run just checking if the fonts are available. (bug #56748)

2019-09-21  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Add new ghostscript font names (bug #56748)

	* font/devpdf/Foundry.in: Add changed font names

2019-09-21  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Prevent gropdf executing arbitrary commands

	* src/devices/gropdf/gropdf.pl: See bug #55557

2019-09-15  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-old.tmac: Move test for definitions of CS and CT
	registers to after man.local is sourced; this way we can both
	respect any setting of those registers in that file (which is
	intended for customization by the site administrator) and ensure
	that the registers are defined when dereferenced later.

2019-09-15  G. Branden Robinson <g.branden.robinson@gmail.com>

	* **/*.man: Put section headings in title case.

2019-09-13  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/troff/input.cpp: Lift invariant out of loop.

2019-09-11  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/preproc/refer/refer.1.man: Add mention of man and mm
	packages as supporting the "refer" preprocessor (GNU mm grew
	this support back in groff 1.22.1).

2019-09-10  G. Branden Robinson <g.branden.robinson@gmail.com>

	Mark expected-to-fail test as XFAIL.

	Automake supports XFAIL and XPASS, so actually use the
	infrastructure as intended.

	* Makefile.am: Declare XFAIL_TESTS variable.
	* src/roff/groff/groff.am (groff_XFAIL_TESTS): Add
	string_case_xform_unicode_escape.sh.
	* src/roff/groff/tests/string_case_xform_unicode_escape.sh: Set
	the expected output to what it would be if string case
	transforms worked on groff Unicode escapes.

2019-09-10  G. Branden Robinson <g.branden.robinson@gmail.com>

	Retire '@G@' build system macro.

	It existed only for forcibly-capitalized man page titles; it was
	the uppercase-transformed counterpart of @g@.

	* Makefile.am: Delete sed transformation of @G@.
	* src/preproc/tbl/tbl.1.man: Replace '@G@EQN' in section heading
	with '@g@eqn'.

2019-09-10  G. Branden Robinson <g.branden.robinson@gmail.com>

	* **/*.man: Downcase man page titles, except for glilypond and
	roff2*, which did not require it.

	Here's a sed script for the aid of those who have a corpus of
	man pages to migrate.

		# Downcase man page titles.
		#
		# Use the first line to skip any .TH lines that require
		# special handling, perhaps because the name of the
		# command gets externally macro-expanded.  In groff, the
		# "roff2.1.man" page is an example.
		#
		# This script operates _only_ on .TH lines.
		#
		# usage: sed -i -f this_script.sed your_man_page.1 ...
		/@ROFF2MODE@/b
		/^\.\s*TH/{
		h
		s/^\.\s*TH \+\([^ ]\+\) .*/\1/
		y/ABCDEFGHIJKLMNOPQRSTUVWXYZ/abcdefghijklmnopqrstuvwxyz/
		G
		s/\([^ ]\+\)\n\(^\.\s*TH \+\)[^ ]\+\( .*\)/\2\1\3/
		}

2019-09-09  G. Branden Robinson <g.branden.robinson@gmail.com>

	The an (man) macro package supports new CS and CT number
	registers to control rendering of man page section headings and
	titles, respectively, in full capitals.  These default off (with
	no visible effect on pages which already fully capitalize these
	strings in man page sources).  The rationale is to encourage man
	page authors to preserve case distinction information in (or
	restore it to) their titles and section headings, while giving
	users (including system administrators, distributors,
	integrators, and maintainers of man(1) implementations) a way to
	view the rendered page elements in full capitals if desired.

	* tmac/an-old.tmac (TH/an-init): If number register CT is
	defined and nonzero, call .stringup on \*[an-title].
	(SH): Store macro argument list to \*[an-section-heading].  If
	number register CS is defined and nonzero, call .stringup on it.
	* tmac/groff_man.7.man (OPTIONS): Document the CS and CT number
	registers.
	* tmac/tests/an-old_CS_register_off.sh:
	* tmac/tests/an-old_CS_register_on.sh:
	* tmac/tests/an-old_CS_register_unspecified.sh:
	* tmac/tests/an-old_CT_register_off.sh:
	* tmac/tests/an-old_CT_register_on.sh:
	* tmac/tests/an-old_CT_register_unspecified.sh: Add tests.
	* tmac/tmac.am (tmac_TESTS): Run tests.

2019-09-09  G. Branden Robinson <g.branden.robinson@gmail.com>

	Add regression test to check behavior of case transformation
	request on a string containing a Unicode character escape.
	Right now, this is not supported, so it is an XFAIL test in the
	parlance of DejaGNU/POSIX 1003.3.

	* src/roff/groff/tests/string_case_xform_unicode_escape.sh: New
	test.
	* src/roff/groff/groff.am (groff_TESTS): Run test.

2019-09-09  G. Branden Robinson <g.branden.robinson@gmail.com>

	Implement .stringdown and .stringup requests.

	* src/roff/troff/input.cpp: Add .stringdown and .stringup
	requests.
	* doc/groff.texi: Document them, including example.
	* man/groff_diff.7.man: Same.
	* man/groff.7.man: Document them briefly.

2019-09-09  G. Branden Robinson <g.branden.robinson@gmail.com>

	Regression-test string case transform feature.

	* src/roff/groff/tests/string_case_xform_errors.sh: New test.
	* src/roff/groff/tests/string_case_xform_requests.sh: New test.
	* src/roff/groff/groff.am (groff_TESTS): Run tests.

2019-06-30  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/devices/grotty/grotty.1.man (Options/-i): Note support of
	recent versions of xterm for italic (oblique) styles.

	Fixes part of <https://savannah.gnu.org/bugs/index.php?55278>.

2019-06-28  G. Branden Robinson <g.branden.robinson@gmail.com>

	devlatin1: Map \(oq to ' on output.

	* font/devlatin1/R.proto: Render the output glyph \[oq]
	{opening quote} as 0x27 (apostrophe) instead of 0x60 (grave
	accent).  A grave accent is just flat wrong for the Latin-1
	character set, a.k.a. ISO 8859-1.  The defining document ECMA-94
	{June 1986} is freely available for perusal.  The ECMA-94 Latin
	character sets do not define any glyphs for directional
	{"typographer's"} quotation marks, but the apostrophe is
	depicted as a neutral (vertical) glyph, whereas the grave accent
	0x60 and acute accent 0xB4 are mirror-symmetric diacritical
	marks.

	Note that this change has no effect on _input_ conventions for
	roff source documents.  You can still get directional single
	quotes on UTF-8, PostScript, PDF, and other output devices
	supporting them by typing sequences like `this' in the input
	{character remapping with ".char" requests and similar
	notwithstanding}.

	Patch and idea from Ingo Schwarze, who originally proposed it
	for ASCII as well, and included Latin-1 for parallelism.
	The groff developers could reach no consensus about the wisdom
	of such a change for ASCII (which was designed to support
	ambiguity for some code points, requiring the development of
	supplementary interpretation conventions between parties).
	ECMA-94/ISO-8859 is more strongly prescriptive.

	See https://savannah.gnu.org/bugs/?55616 and the groff mailing
	list archives for 31 January to 23 February 2019 at
	https://lists.gnu.org/archive/html/groff for lengthy discussion.

	* src/roff/groff/tests/on-latin1-device-oq-is-0x27.sh: Check for
	correct output glyph.

	* src/roff/groff/groff.am: Add test.

2019-06-28  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/unicode.tmac: Save and restore compatibility mode since
	the script uses a GNU extension (.char).

2019-06-27  G. Branden Robinson <g.branden.robinson@gmail.com>

	libdriver: Fix SEGV (Savannah #56555).

	* src/libs/libdriver/printer.cpp: Check result of
	set_char_and_width() for error condition before relying on it.

	* src/roff/groff/tests/regression-56555.sh: Provoke segfault
	with five bytes of input using transparent line indicator.

	* src/roff/groff/groff.am: Add test.

2019-01-12  Ingo Schwarze  <schwarze@openbsd.org>

	Correctly handle groff_mdoc(7) .Lk arguments starting with a
	dot.

	* tmac/doc.tmac-u: Each argument to the .Lk macro is printed
	on its own roff input line.  If it happens to start with a dot
	or apostroph, it was misinterpreted as a request or macro.
	Force it to be treated as text by adding "\&" in front of it.

2018-12-31  Ingo Schwarze  <schwarze@openbsd.org>

	* man/groff_diff.7.man: remove two stray .RE macros

2018-12-18 Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Fix 'dvi' and 'pdf' texinfo doc generation.

	GNU make has a built-in variable 'TEXI2DVI' but it is not the case
	of all 'make' implementations, which causes 'make doc' to fail
	with an unclear message although 'texi2dvi' is available.  Also,
	'texi2dvi' is invoked inconditionnally.

	* m4/groff.m4 (GROFF_TEXI2DVI): new macro to detect properly the
	presence of 'texi2dvi'.

	* configure.ac: use 'GROFF_TEXI2DVI' and define automake conditional
	'HAVE_TEXI2DVI'.

	* doc/doc.am:
	- Define TEXI2DVI to 'texi2dvi'.
	- Print an error message if 'texi2dvi' is not available.

2018-12-14  G. Branden Robinson <g.branden.robinson@gmail.com>

	* doc/groff.texi: Drop documentation of "man" macro package from
	  our Texinfo manual.  The mdoc, me, mm, and mom packages all
	  maintain their documentation externally to this manual as
	  well.  Exception: portions not about man proper--which are not
	  duplicated from groff_man(7)--on use of man.local (including
	  examples of Ultrix-compatible macros) are retained.

2018-12-08 Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Install texinfo doc on 'make install-pdf' and 'make install-html'

	* doc/doc.am:
	- Use automake 'install-pdf-local' and 'install-html-local' rules
	to install groff.pdf and groff.html
	- New rules 'uninstall_pdf' and 'uninstall_html'.
	- Use $(RM) instead of 'rm'.
	- Don't try to build doc if 'BUILD_INFODOC' is not set.
	* INSTALL.REPO: document texinfo build and installation.

2018-12-10 Ingo Schwarze <schwarze@openbsd.org>

	* Makefile.am: Remove the unused variables PREFIXMAN5 and PREFIXMAN7.

	They caused installation failures on Solaris 9.

2018-12-08 Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Remove gnulib's hypot module.

	The removal of 'GROFF_NEED_DECLARATION([hypot])' in 'configure.ac'
	was correct as the test was buggy, but there is no need to use
	gnulib's hypot module as previously we did not need to provide a
	replacement function.

	* bootstrap.conf: do it.

2018-12-08  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Problem running gropdf on big endian (Sparc)

	* src/devices/gropdf/gropdf.pl: Prior to perl v5.9 the 'L<'
	template for 'unpack' was unavailable. Solaris 10 uses v5.8.4
	so safer to use the template 'V' rather than 'L<'.

2018-12-08 Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Use gnulib's 'hypot' module.

	In 'configure.ac', the macro call
	'GROFF_NEED_DECLARATION([hypot])' checks whether the function
	'hypot' is correctly declared in 'math.h', but the test is buggy
	and may yields false results.

	* bootsrap.conf: add 'hypot' module.

	* configure.ac: Remove GROFF_NEED_DECLARATION([hypot]).

	* src/libs/libgroff/hypot.cpp: remove declaration of hypot.

2018-12-07  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Problem running gropdf on big endian (Sparc)

	* src/devices/gropdf/gropdf.pl: When loading a binary (.pfb)
	font for embedding always use little endian to unpack chunk
	headers.

2018-12-05  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Skip mom tests if needed config is missing.

	* contrib/mom/examples/test-mom.sh.in: exit 77 if URW fonts are
	not available.

	* contrib/mom/mom.am: distribute inconditionnally test-mom.in.

	* m4/groff.m4 (GROFF_URW_FONTS): check if 'awk' and 'gs' are
	available, and replace non-portable 'grep' command by awk script.

2018-12-01  Colin Watson  <cjwatson@debian.org>

	Fix error handling in tests of mom examples

	* contrib/mom/examples/test-mom.sh.in (check_number_pages): Correct
	error message.
	(check_has_images): Correct shell syntax error.

2018-11-26  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Document .sp behaviour in -me doc -- French translation

	* doc/meintro_fr.me: translation of commit
	7a83f7f5003e24f020306f09f4d497e04e82cb14.

	Fixes bug https://savannah.gnu.org/bugs/?54958.

2018-11-24  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Fix tarball generation: script 'makevarescape.sed' was missing.

	* Makefile.am (EXTRA_DIST): add it.

2018-11-24  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Add automatic tests on mom examples

	* m4/groff.m4 (GROFF_PDFTOOLS): check presence of some pdf tools.
	* configure.ac: use 'GROFF_PDFTOOLS', add new AM conditional.
	* contrib/mom/examples/test-mom.sh.in: new file that use 'pdfinfo'
	and 'pdfimages' to make some basic checks on mom examples.

2018-11-21  G. Branden Robinson <g.branden.robinson@gmail.com>

	tmac/sv.tmac: Set Swedish hyphenation flags to 32.

	This permits hyphenation after the first character but continues
	prohibiting it before the last character of a word, in
	congruence with the TeX-based hyphenation patterns we use.

	Fixes <https://savannah.gnu.org/bugs/index.php?55066>.

2018-11-19  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Fix build on environment where /etc/papersize contains comments

	Issue introduced on commit efea81c75f831ddc6717c2ef25556e0f49d1f679.

	* m4/groff.m4 (GROFF_PAGE): remove comments and get the 1st string
	of '/etc/papersize'.

2018-11-12  G. Branden Robinson <g.branden.robinson@gmail.com>

	* m4/groff.m4 (GROFF_PAGE): Try /etc/papersize first.

	Fixes <https://savannah.gnu.org/bugs/index.php?53271>.

2018-11-12  G. Branden Robinson <g.branden.robinson@gmail.com>

	* bootstrap.conf: Bump Autoconf dependency to 2.68.  We need it
	to support our bug-reporting URL, which contains a "?".
	Strictly, Autoconf 2.65 is fine, but 2.66 and 2.67 broke this.
	Even 2.69 is over 6 years old now.

	See <https://savannah.gnu.org/support/?107450>.

2018-11-12  G. Branden Robinson <g.branden.robinson@gmail.com>

	* m4/groff.m4 (GROFF_PAGE): Quote shell variables that are under
	external control and may contain embedded whitespace.  A test
	shows that our configure script is now robust in this way, but
	our Automake files are not, starting with
	src/utils/afmtodit/afmtodit.am.

2018-11-12  G. Branden Robinson <g.branden.robinson@gmail.com>

	* makevarescape.sed:
	  - Escape plain spaces and double-quotes (ASCII 32 and 34) so
	    that bad things don't happen if they are embedded in a Make
	    variable expanded in a man page @THUS@ _and_ given as an
	    argument to a macro that distinguishes its parameters, such
	    as .IR.
	  - Add discretionary breaks after groups of slashes not
	    preceded by a space; e.g., transform "/usr/bin/groff" into
	    "/usr/\:bin/\:groff".  Will also work on URLs
	    {"https://\:example.com/\:page.html"} in case we need that.

2018-11-11  G. Branden Robinson <g.branden.robinson@gmail.com>

	Undocument Werner and Ted as groff maintainers.

	* README:
	* doc/pic.ms:
	* src/roff/grog/grog.pl:
	* src/roff/nroff/nroff.sh: Werner (and Ted) retired from the
	role some time ago and Bertrand Garrigues has stepped up; see
	https://lists.gnu.org/archive/html/groff/2017-09/msg00048.html.
	I'll let him document his maintainer status as and where he
	prefers.

2018-11-11  G. Branden Robinson <g.branden.robinson@gmail.com>

	Stop spelling "Unix" as "UNIX".

	Per AT&T Bell Labs veterans Doug McIlroy and Meg McRoberts,
	spelling "Unix" in full caps was a contrivance insisted upon by
	AT&T lawyers, and not a practice used in the Unix manuals
	themselves or the Bell Labs Technical Journal.  See
	  https://lists.gnu.org/archive/html/groff/2015-01/msg00026.html
	and
	  https://lists.gnu.org/archive/html/groff/2015-01/msg00029.html
	for support.

	There are instances I did _not_ change; they may require further
	review.
		ChangeLog.*
		NEWS
			One reference relevant to mdoc; see below.
		doc/meintro{,_fr}.me
			These documents also give the small caps
			treatment to groff, troff, and nroff, suggesting
			a separate changeset.
		src/preproc/pic/pic.ypp
			Contains a comment referring to "Compaq Tru64
			UNIX"; not worth the candle IMO.
		tmac/s.tmac:
			{ms macro package} Leaving UX macro definition
			alone until/unless it can be established that
			this doesn't change the rendering of historical
			documents in an objectionable way.
		tmac/doc-syms-u:
		tmac/doc-old.tmac-u:
		tmac/doc-common-u:
		tmac/groff_mdoc.7.man:
			{mdoc macro package} Similar; mdoc defines many
			strings that spit out "UNIX" (albeit not with a
			font size change).

	* MORE.STUFF:
	* NEWS:
	* README.MinGW:
	* contrib/groffer/README:
	* contrib/pdfmark/pdfmark.ms:
	* contrib/pdfmark/pdfroff.1.man:
	* doc/groff.texi:
	* doc/webpage.ms:
	* m4/groff.m4:
	* man/groff_diff.7.man:
	* man/groff_tmac.5.man:
	* man/roff.7.man:
	* src/preproc/html/pre-html.cpp:
	* src/roff/troff/troff.1.man: Change "UNIX" to "Unix",
	discarding markup as necessary.

2018-11-10  G. Branden Robinson <g.branden.robinson@gmail.com>

	man pages: Escape interpolated Make variables.

	* makevarescape.sed: Transform - to \-, ~ to \(ti, and so forth,
	{with an extra layer of backslashes--see below} so that Makefile
	variables containing ASCII characters that do not represent
	themselves literally in *roff (see groff_char(7)) are correctly
	interpolated into man page text.

	* Makefile.am (.man): Transform Makefile variables with the
	above script when interpolating them into man page text.

	Note that while the script, combined with this target, will
	transform ` to \(ga, including grave accents in Makefile
	variables is likely to fail when the shell lexes the argument to
	echo within the old-style command substitution ``.  Testing
	shows that grave accents should work[1] if POSIX-style command
	substitution $() is done instead.  However, $() is less
	portable.  (Triple-escaping grave accents \\\` inside the
	interpolated Makefile variable will work, but is not attempted
	at present.)

	Note also that the amount of backslash-escaping in the sed
	script is excessive (and incorrect) for normal purposes, but
	required here because a command substitution is being nested
	inside yet another invocation of sed.

	{1} For this target; no assurances about the good behavior of
	unusual characters in Makefile variables in other aspects of the
	groff build are offered.

	Fixes <https://savannah.gnu.org/bugs/index.php?55004>.

2018-11-06  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/utils/lookbib/lookbib.cpp: Doesn't make much sense to mark
	Version_string as a C extern if you're just going to hide it in
	a throwaway scope again.  Remove braces, exposing it.

	"lookbib -v" now reports a version number, instead of "(null)".

	Fixes <https://savannah.gnu.org/bugs/index.php?54972>.

2018-11-06  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/libs/libgroff/error.cpp (do_error_with_file_and_line):
	If:
	  a program name is known;
	but
	  no file is being processed or the line number is negative,
	then there was no space between the program name (with colon),
	and the succeeding diagnostic message.

	Example: lookbib:fatal error: no databases

	Fixes <https://savannah.gnu.org/bugs/index.php?54971>.

2018-11-05  G. Branden Robinson <g.branden.robinson@gmail.com>

	Make strip.sed operate only if given permission.

	* tmac/strip.sed: Do nothing whatsoever to any input file that
	lacks a line matching "%beginstrip%".  This implements a
	contract between the macro file writer and the stripper script
	{roff input is not parseable with crude weaponry like regular
	expressions}.  In practice, most of the changes performed by the
	script were already in a block enforcing this.  My changes:
	- Stop unconditionally inserting a roff comment noting the
	  reader of stripping at line 2.  Instead, replace the line
	  matching "%beginstrip%" with this comment if and only if it
	  is present.
	- Stop deleting lines containing only the empty request if
	  they occur before "%beginstrip%".
	- Tweak the wording of the roff comment.
	- Remove comment within the sed script; see
	  https://lists.gnu.org/archive/html/groff/2017-11/msg00057.html
	  and the sed section of "Limitations of Usual Tools" in the
	  GNU Autoconf Manual.

	Invalidates <https://savannah.gnu.org/bugs/index.php?53784>.

2018-11-04  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/an-old.tmac: When emitting diagnostics, report the name
	of the macro file complaining, and the name and line number of
	the input file at the time of trouble.  Thanks to Bjarni Ingi
	Gislason for part of the patch.

	Fixes <https://savannah.gnu.org/bugs/?54175> and continues the
	long process of fixing <https://savannah.gnu.org/bugs/?52463>.

2018-11-04  G. Branden Robinson <g.branden.robinson@gmail.com>

	* doc/meintro_fr.me: Add encoding hint to top of file so preconv
	works correctly even if the build environment's encoding is not
	UTF-8.  Adapted from Bjarni Ingi Gislason's patch.  Also add
	long-form Emacs coding declaration at end of file.  Vim's
	auto-detection seems to be fine, so did not update its modeline.

	Fixes <https://savannah.gnu.org/bugs/index.php?54530>.

2018-11-04  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/groff_man.7.man: Reorganize and largely rewrite to more
	precisely document the macro package's behavior and to be more
	helpful and accessible to man page writers who may never read
	any other groff documentation.

2018-10-25  G. Branden Robinson <g.branden.robinson@gmail.com>

	Clarify meaning of \p escape.  Also make more explicit that line
	adjustment for the .brp request and \p escape depends on the
	current adjustment mode.

	* doc/groff.texi: Clarify that \p has effect at the next word
	boundary.  Thanks to Dave <barx> for pointing out the issue and
	providing elucidating language.

	* man/groff.7.man: Similar, but terser.

	Fixes https://savannah.gnu.org/bugs/index.php?54894.

2018-10-04  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Savannah bug # 54812

	* font/devpdf/util/BuildFoundries.pl: If a font is not found
	report list of paths searched.

	Fix https://savannah.gnu.org/bugs/?54812

2018-10-10  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Update 'gnulib' submodule.

	* gnulib: now points on dce8759f0f0236a860a3e68b63c5e99cc6f168f9
	from 'gnulib' repository.  This fixes build error with glibc 2.28
	(see https://bugzilla.redhat.com/show_bug.cgi?id=1595702).

2018-10-04  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Savannah bug # 54779

	* font/devpdf/Foundry.in: Recent ghostscript changed name
	used for embedding groff font HNBI

	Fix https://savannah.gnu.org/bugs/?54779

2018-08-27  Ingo Schwarze  <schwarze@openbsd.org>

	* tmac/groff_www.7.man: Do not use .URL, .MTO, .FTP.

2018-08-21  Ingo Schwarze  <schwarze@openbsd.org>

	Improve terminal rendering for a few special characters:

	* tmac/tty.tmac: add \[.j] (dotless j)
	* tmac/tty-char.tmac: for \[a.], fall back to "."
	* tmac/tty-char.tmac: add playing card suits

2018-08-16  Ingo Schwarze  <schwarze@openbsd.org>

	* src/preproc/preconv/preconv.1.man: add -D to the SYNOPSIS

2018-08-09  Ingo Schwarze  <schwarze@openbsd.org>

	* Makefile.am: correctly calculate MAJOR_VERSION etc.

2018-06-19  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Fixes to gropdf

	* src/devices/gropdf/gropdf.pl: Make default line width 0.4pt
	to match grops. Use 'S' operator (stroke) rather than 's' (close
	and stroke) when Dl command received. Improve switching between
	text and graphic modes.

2018-07-01 Bertrand Garrigues <bertrand.garrigues@laposte.net>

	[me] paragraph with umlaut incorrectly rendered

	* tmac/e.tmac-u: workaround done by Werner LEMBERG <wl@gnu.org>.

	Fix https://savannah.gnu.org/bugs/?42191

2018-06-19  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Add gropdf new features to NEWS file.

	* NEWS: new features.

2018-05-29  Werner LEMBERG  <wl@gnu.org>

	[dvi] Fix glyph map for `cmitt10'.

	Problem reported by Pali Rohr <pali.rohar@gmail.com>.

	  http://lists.gnu.org/archive/html/groff/2018-05/msg00088.html

	* font/devdvi/texitt.map: New file.  This is identical to
	`textt.map' except the dollar glyph, which gets replaced by the
	pound glyph.

	* font/devdvi/generate/Makefile (CWI): Use `texitt.map'.

	* font/devdvi/CWI: Regenerated.

2018-05-07  G. Branden Robinson <g.branden.robinson@gmail.com>

	Improve diagnostics on bad hyphenation requests.

	* src/roff/troff/env.cpp: Add new HYPHEN_* symbols to anonymous
	enum.

	* src/roff/troff/env.cpp (hyphenate_request):
	  - Warn about hyphenation request values that are completely
	    out of range.
	  - Report bad hyphenation request value in diagnostic messages.

2018-04-28  G. Branden Robinson <g.branden.robinson@gmail.com>

	grap2graph: Parallelize changes with pic2graph.

	* contrib/grap2graph/grap2graph.sh:
	  - Refactor temp directory handling.
	  - Handle embedded whitespace in temp dir.
	  - Adapt to old convert(1) programs.

	* contrib/grap2graph/grap2graph.1.man: Make editorial/style
	changes and minor corrections.

2018-04-26  G. Branden Robinson <g.branden.robinson@gmail.com>

	eqn2graph: Remove -unsafe option.

	* contrib/eqn2graph/eqn2graph.sh: Unrecognize "-unsafe" option
	and eliminate $groff_opts variable.  As far as I can tell, this
	option had no effect because (1) pic is not run on the input
	stream (no -p argument to groff); (2) eqn doesn't support
	"shelling out" as pic does; and (3) there is no way to embed
	*roff requests inside a sequence of eqn commands.  If I'm wrong,
	let me know.

	* contrib/eqn2graph/eqn2graph.1.man: Undocument "-unsafe"
	option.

2018-04-26  G. Branden Robinson <g.branden.robinson@gmail.com>

	eqn2graph: Parallelize changes with pic2graph.

	* contrib/eqn2graph/eqn2graph.sh:
	  - Refactor temp directory handling.
	  - Handle embedded whitespace in temp dir.
	  - Adapt to old convert(1) programs.

	* contrib/eqn2graph/eqn2graph.1.man: Make editorial/style
	changes and minor corrections.

2018-04-25  G. Branden Robinson <g.branden.robinson@gmail.com>

	pic2graph: Refactor temp directory handling.

	* contrib/pic2graph/pic2graph.sh: Issue a diagnostic and give up
	if the user's desired temporary directory does not exist.  Also
	document the Bashism $RANDOM and work around its absence.

2018-04-25  G. Branden Robinson <g.branden.robinson@gmail.com>

	pic2graph: Handle embedded whitespace in temp dir.

	* contrib/pic2graph/pic2graph.sh: Quote shell variables having
	to do with the temporary directory's location; without
	quotation, temporary directory names with embedded whitespace
	are wrongly handled.

2018-04-24  G. Branden Robinson <g.branden.robinson@gmail.com>

	* doc/groff.texi: Bump end of copyright range to 2018.  Werner
	added substantial text this year about hyphenation.

2018-04-24  G. Branden Robinson <g.branden.robinson@gmail.com>

	Set version to 1.22.4 in the few places that hard-code it.

	* arch/mingw/grap2graph.cmd:
	* contrib/groffer/version.sh:
	* doc/groff.texi:
	* doc/webpage.ms: Bump from 1.22.3 to 1.22.4.

2018-04-24  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Restrict scaling factors to 3dp and better handle CR/LF in import.

	* src/devices/gropdf/gropdf.pl: Restrict scaling factors to 3dp
	rounded. If pdf imported with pdfpic uses CR/LF line termination
	ibclude XObject Image, length of stream out by 1.

2018-04-23  G. Branden Robinson <g.branden.robinson@gmail.com>

	man pages: Shorten version footer.

	* **/*.man: Replace "Groff Version" with "groff" in the fourth
	argument to .TH in all man pages.  This suffices to keep that
	part of the footer from overrunning the date, even in dirty
	trees on 80-column terminals.

	Fixes https://savannah.gnu.org/bugs/index.php?53721.

2018-04-23  G. Branden Robinson <g.branden.robinson@gmail.com>

	pic2graph(1): Make editorial/style changes and minor
	corrections.

2018-04-23  G. Branden Robinson <g.branden.robinson@gmail.com>

	pic2graph: Adapt to old convert(1) programs.

	* contrib/pic2graph/pic2graph.sh: Grep convert's -help output
	for the string "-trim".  If it is not found, the old method for
	image trimming documented in pic2graph's man page, "-crop 0x0",
	is used.  I am motivated by the fact that the warning about this
	in our man page is very old (10 years or more), and I wanted to
	get rid of it.

	pic2graph emits a warning when performing this fallback, in the
	event the ImageMagick and/or GraphicsMagick teams surprise the
	world again.

	* contrib/pic2graph/pic2graph.1.man: Remove BUGS section, the
	entire contents of which was dedicated to convert's change in
	behavior.

2018-04-22  G. Branden Robinson <g.branden.robinson@gmail.com>

	groff_man(7): Expand command synopsis section.

	This section now explains in detail how to write (and read) a
	command synopsis.

2018-04-12  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Make PDFPIC behave the same whether -Tps or -Tpdf used.

	Previously the -Tpdf version did not cause a break nor position
	to the line beneath the imported picture, whilst the -Tps
	version did.

	* tmac/pdfpic.tmac: Corrected behavior.

	* NEWS: Explain the change of behaviour and how to reinstate
	the previous behaviour using register PDFPIC_NOSPACE or the
	environment variable GROFF_PDFPIC_NOSPACE.

2018-03-27  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Define a short version for data installation dir name.

	This is the full version stripped of any characters after the
	third digit.  Used for installation of font, macro and various
	data (by default in /usr/local/share/groff).  The various programs
	and scripts still use the full version from gnulib script
	'git-version-gen' .

	* configure.ac (SHORT_VERSION): short version definition.

	* Makefile.am: use 'SHORT_VERSION' for 'docdir' and 'datasubdir'
	definitions.

2018-03-11  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Remove doc/automake_migration_tests.txt

	Automake migration was completed long time ago and this file is no
	longer needed.

2018-03-11  Colin Watson  <cjwatson@debian.org>

	Switch to Gnulib implementation of snprintf

	This is more actively maintained, straightforward to integrate now
	that we have Gnulib integration, and simplifies groff's overall
	licensing.

	* bootstrap.conf (gnulib_modules): Add `snprintf' and `vsnprintf'.
	* configure.ac: Remove local checks for `snprintf' and `vsnprintf'.
	* Makefile.am: Remove various comments related to local checks for
	`snprintf' and `vsnprintf'.
	* src/include/lib.h: Remove declarations of `snprintf' and
	`vsnprintf'.
	* src/libs/libgroff/libgroff.am (EXTRA_DIST): Remove
	`src/libs/snprintf/snprintf.c'.
	* src/libs/snprintf/snprintf.c: Remove.

	* LICENSES: Remove section about `src/libs/snprintf/snprintf.c'.
	* MANIFEST: Remove entry for `src/libs/libxutil'.

2018-03-09  Deri James  <deri@chuzzlewit.myzen.co.uk>

	PDF must not open in presentation mode.

	* src/devices/gropdf/gropdf.pl: When GROPDF_NOSLIDE=1
	passed do not set pdf to presentation mode.

2018-03-09  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Allow a "." to signify a missing parameter in .pdftransition

	* src/devices/gropdf/gropdf.1.man: Explain the .pdftransition
	macro (and underlying '\X' command) accepts a "." to specify
	a parameter retains its current value.

2018-03-09  Colin Watson  <cjwatson@debian.org>

	man pages: fix incorrect cross-referenced section

	* man/roff.7.man (FILE NAME EXTENSIONS): Correct reference to
	groff_filenames(5).

2018-03-09  Colin Watson  <cjwatson@debian.org>

	mdate.sh: rewrite in Perl

	groff already requires perl to build.  This version is much shorter
	and easier to understand than the shell/awk version: we don't have
	to worry about convincing ls to produce output that we can parse,
	and we don't have to play games with the way that the same field may
	contain either the year or the time depending on how old the file
	is.

	While I'm at it, this version also adds `SOURCE_DATE_EPOCH' support
	for reproducible builds: when `SOURCE_DATE_EPOCH' is set, files are
	considered to have been last modified at that time.

	* mdate.sh: Rewrite in Perl, moving to ...
	* mdate.pl: ... this new file.
	* Makefile.am (EXTRA_DIST, .man): Update references.

2018-03-09  Colin Watson  <cjwatson@debian.org>

	Remove #! lines from non-executable files

	These are always invoked by the build system (either in-tree or via
	the installed Makefiles) using the necessary program, so the #!
	lines were unnecessary.  They were harmless except that they caused
	Debian's `lintian` tool to complain about installed non-executable
	scripts.

	* font/devlj4/generate/special.awk: Remove #! line.
	* font/devps/generate/symbol.sed: Likewise.

2018-03-09  Colin Watson  <cjwatson@debian.org>

	doc: stop generating W3C validation icons

	Debian's `lintian' tool says:

	  These badges may be displayed to tell readers that care has been
	  taken to make a page compliant with W3C standards.  Unfortunately,
	  downloading the image from www.w3.org might expose the reader's IP
	  address to potential tracking.

	I think the risk is a small one, but I also don't think the badges
	are especially valuable, so it doesn't seem like much to ask to just
	drop them at least for groff's own documentation.

	* doc/doc.am (.ms.html, doc/pic.html): Remove `-P-V' option.

2018-03-01  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Place pdf in presentation mode if new commands used.

	* src/devices/gropdf/gropdf: The new commands which
	control page transitions should result in the pdf being
	opened in presentation mode.

2018-03-02  Werner LEMBERG  <wl@gnu.org>

	Hyphenation exceptions in pattern files now obey `.hy' (#53196).

	* src/roff/troff/env.cpp (hyphen_trie::read_patterns_file): Mark
	`\hyphenation' entries with a trailing space.
	(hyphen_trie::insert_hyphenation): Updated.
	(hyphenate): Make `\hyphenation' entries obey `.hy' restrictions.

	* doc/groff.texi (.hy): Updated.

2018-03-01  Werner LEMBERG  <wl@gnu.org>

	Adjust `.hy' values.

	In most cases hyphenation constraints were too strict.  The now
	selected values reflect the parameters used for the generation of
	the (TeX) hyphenation patterns.

	* tmac/an-old.tmac, tmac/cs.tmac, tmac/de.tmac, tmac/doc-common-u,
	tmac/e.tmac-u, tmac/fr.tmac, tmac/s.tmac, tmac/sv.tmac: Fix `.hy',
	`\n[HY]', and `\n[doc-hyphen-flags]' values.

	* doc/groff.texi, tmac/groff_man.7.man, tmac/groff_ms.7.man, NEWS:
	Updated.

2018-03-01  Werner LEMBERG  <wl@gnu.org>

	Fix some problems related to hyphenation.

	Introduce values 16 (allow hyphenation before last character) and 32
	(allow hyphenation after first character) to the `hy' request
	(#48904).

	Really fix problem reported in issue #48904.

	Fix #53243, which is a regression introduced in 2016-09-09.

	* src/roff/troff/env.cpp (HYPHEN_LAST_CHAR, HYPHEN_FIRST_CHAR): New
	enumeration values.
	(hyphenate_request): Check for contradicting values.
	(environment::hyphenate_line): Fix minimum word length considered
	for hyphenation.
	(environment::print_env): Updated.
	(hyphenate): Fix and extend logic.  The original patch to handle
	#48904 was bad.

	* doc/groff.texi, man/groff_diff.7.man, NEWS: Updated.

2018-03-01  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Add page transitions to pdfs created with gropdf.

	* src/devices/gropdf.pl: Handle new '\X' commands to support page
	transitions in presentation mode pdfs. These commands are a subset
	of the commands used in present.tmac allowing slideshows to be
	directly produced from -Tpdf without using postscript -> gpresent.pl
	-> ghostscript.

	* tmac/pdf.tmac: New macros '.pdfpause' and '.pdftransition' to
	support page transitions.

	* src/devices/gropdf.1.man: Document the '\X' commands supported.

2018-03-01  Werner LEMBERG  <wl@gnu.org>

	Use $(AM_V_GEN) and $(AM_V_P) to silence even more file generation.

	* font/devpdf/devpdf.am (BuildFoundries, DESC, Foundry,
	build_font_files): Do it.

2018-02-28  Werner LEMBERG  <wl@gnu.org>

	Use $(GROFF_V) to silence documentation creation.

	* Makefile.am (GROFF_V): Define.

	* doc/doc.am (.me.txt, .me.ps, .ms.html, .ms.txt, .ms.ps, pic.html,
	webpage.html): Use $(GROFF_V).

2018-02-28  Werner LEMBERG  <wl@gnu.org>

	Use $(AM_V_GEN) to silence file generation.

	* Makefile.am (.man), contrib/eqn2graph/eqn2graph.am (eqn2graph),
	contrib/grap2graph/grap2graph.am (grap2graph), contrib/pic2graph.am
	(pic2graph), src/devices/gropdf/gropdf.am (gropdf, pdfmom),
	src/preproc/eqn/eqn.am (neqn), src/roff/grog/grog.am (grog),
	src/roff/nroff/nroff.am (nroff), src/utils/afmtodit/afmtodit.am
	(afmtodit), font/devascii/devascii.am (DEVASCIIFONTSFILES, DESC),
	font/devcp1047/devcp1047.am (DEVCP1047FONTSFILES, DESC),
	font/devhtml/devhtml.am (DEVHTMLFONTSFILES, DESC),
	font/devlatin1/devlatin1.am (DEVLATIN1FONTSFILES, DESC),
	font/devutf8/devutf8.am (DEVUTF8FONTSFILES, DESC),
	font/devps/devps.am (DESC, prologue, zapfdr.pfa, symbolsl.pfa),
	font/devdvi/devdvi.am (DESC), font/devlbp/devlbp.am (DESC),
	font/devlj4/devlj4.am (DESC): Do it.

2018-02-28  Werner LEMBERG  <wl@gnu.org>

	* configure.ac: Activate silent Makefile rules.

2018-02-28  Werner LEMBERG  <wl@gnu.org>

	Minor compilation warnings.

	* src/devices/xditview/draw.c: Don't declare `MaxFontPosition'.

	* src/roff/troff/input.cpp (psbb_locator::context_args): Avoid
	shadowing of `buf'.

2018-02-28  Werner LEMBERG  <wl@gnu.org>

	* src/roff/troff/env.cpp: s/HYPHEN_/HYPHEN_NOT/ for clarification.

2018-02-26  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Update installation doc.

	* INSTALL.REPO: mention that 'pkg-config' is a dependency.

	* INSTALL.extra: add dependency 'makeinfo' and optional
	dependencies 'pkg-config' and 'uchardet'.

	* TESTS: move to doc/automake_migration_tests.txt

	* INSTALL.gen: remove, this file is redundant with the 'INSTALL'
	file from gnulib.

2018-02-02  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Update 'gnulib' submodule.

	* gnulib: now points on cf56f8f618c48cfadd2499ced58574633d12f129
	from 'gnulib' repository.

2018-02-02  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Use gnulib script 'git-version-gen' to define groff's version

	* bootstrap.conf: add 'git-version-gen' script.

	* configure.ac: suppress 'GROFF_VERSION_STRING' and replace it by
	the script.  If the current commit corresponds to a tag, then the
	version is simply the tag name.  Otherwise the version has the
	format: <tag>-<nb_commits_from_latest_tag>-<commit sha1>.  The
	version is now stored in '.version'.

	* REVISION: removed.

	* VERSION: removed.

	* Makefile.am: define 'MAJOR_VERSION', 'MINOR_VERSION' and
 	'REVISION'.

	* src/libs/libgroff/libgroff.am: use 'MAJOR_VERSION',
	'MINOR_VERSION' and 'REVISION', add dependency on '.version'.

	* src/roff/troff/troff.am: ditto.

	* contrib/mom/om.tmac-u (short_revision): new string that extracts
	the first digit of the revision, to be used when checking groff
	version.

2018-01-18  Deri James  <deri@chuzzlewit.myzen.co.uk>

	On reflection using an array for Filter is not optimal.

	* src/devices/gropdf.pl: revert single line from commit
	18fd1fd0bf05eb9a5ba0d2be1a655a044662a8bf.

2018-01-17  Deri James  <deri@chuzzlewit.myzen.co.uk>

	All values should be 3 decimals

	* src/devices/gropdf.pl: for values approaching zero values
	in the for 0.nnnnnnE-nn could be written, not valid syntax for
	PDF. Make all values rounded to 3 decimals, becomes 0.000.

	Also changed stream Filter dictionary entry to an array.

2018-01-14  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Fix tarball generation ('make distcheck'  failed)

	* src/devices/xditview/xditview.am: add .h created by commit
	382ab4af269a1dea422c8f9bb5c67a065d026deb to EXTRA_DIST

	* contrib/mm/mm.am: restore distribution of files removed by
	commit 445bf58765b759546e238a235651eb0bf5b34325.

2018-01-13  Ingo Schwarze <schwarze@openbsd.org>

	Makefile.am: Re-add -F and -M flags needed to build out of src.

2018-01-13  Ingo Schwarze <schwarze@openbsd.org>

	[mdoc]: rewrite the implementation of the .Lk macro

	* tmac/doc.tmac-u (Lk): Rewrite.

	The old implementation was written before the big mdoc
	rewrite for groff-1.17.  In contrast to most other macros,
	it was never updated to use the new techniques.
	This new implementation makes .Lk callable, makes trailing
	punctuation work in the normal way, and makes the style of
	the implementation consistent with other macros.

	It also removes the feature of automatically switching
	between in-line and displayed rendering depending on the
	length of the link because that was inconsistent across
	output modes and counter-intuitive, resulting in ugly
	output for many existing real-world manual pages.
	It now always renders in-line.  Use .D1 Lk where desired.

	Merging http://savannah.gnu.org/bugs/?52849
	OK wl@gnu, jmc@openbsd, bentley@openbsd

2017-12-14  G. Branden Robinson <g.branden.robinson@gmail.com>

	man pages: Comment compatibility-mode switching.

	The '.do' and '.cp' requests (both groffisms) are some of the
	more obscure features of groff's own man page corpus.
	Consequently, they get cargo-culted around, within and outside
	groff.  Thanks to Werner Lemberg for the discussion, which
	revealed (to me) that groff ships with compatibility mode on by
	default on Solaris 10 and 11.

	Fix bug https://savannah.gnu.org/bugs/?52444.

2017-11-30  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/roff/troff/input.cpp:
	Make writers to stderr identify themselves.

	* font/devpdf/util/BuildFoundries.pl:
	Same; also refactor all diagnostics into Notice(), Warn(), and
	Die() functions, which delegate their common message-printing to
	Msg().

	Fix part of bug https://savannah.gnu.org/bugs/?52463.

2017-11-21  G. Branden Robinson <g.branden.robinson@gmail.com>

	man pages: Fix compatibility-mode problems.

	* contrib/gperl/gperl.1.man: Use idiomatic .BI macro instead of
	  leading an input line with a font escape followed by a dot,
	  the interpretation of which differs based on compatibility
	  mode.

	* src/preproc/soelim/soelim.1.man: Make .mso request only after
	  compatibility mode is turned off.

2017-11-19  G. Branden Robinson <g.branden.robinson@gmail.com>

	* Makefile.am: Protect arguments to "tr" from globbing.

	Prevents errors from tr during man page generation and possible
	incorrect program prefixing in those pages if, for example, some
	doofus has directories called "A", "B", ...  hanging around in
	the build tree.

2017-11-18  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/groff_mdoc.7.man: Use unstripped symbol names.

	Fix bug https://savannah.gnu.org/bugs/?52442.

2017-11-18  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/include/.gitignore: Ignore config.hin~ files.

2017-11-18  Bjarni Ingi Gislason <bjarniig@rhi.hi.is>

	test-groff.in: Enable backtraces and all warnings by default.

	Fix bug https://savannah.gnu.org/bugs/?51482.

2017-11-18  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/**: Migrate macro package diagnostics away from `quotes'.

2017-11-15  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/libs/libgroff/new.cpp: Quieten compiler warning.

	Define sized version of overloaded delete operator.  Duplicate
	code from unsized delete operator because simply calling through
	to it provokes another warning, -Wdelete-incomplete.

	Fix rest of https://savannah.gnu.org/bugs/?52335.

2017-11-12  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Better handle glyphs in font positions > 255

	* src/devices/gropdf/gropdf.pl: Improve handling
	when glyphs above 255 are used.

2017-11-12  Deri James  <deri@chuzzlewit.myzen.co.uk>

	gropdf should load ALL 'download' files

	* src/devices/gropdf/gropdf.pl: only the first 'download' file
	found was loaded, it should load all found.

2017-11-12  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/libs/libxutil/DviChar.c: Initialize "buckets" field of
	structs.

	Resolves missing-field-initializers warnings.

2017-11-12  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/strip.sed: Stop rewriting symbol names.  A substitution
	originally intended to strip the "doc-" prefix off of mdoc macro
	and string names unintentionally caught some mom stuff.
	Harmlessly in this instance, but with potentially surprising
	future effects.  Remove (only) this substitution per discussion
	in
	https://lists.gnu.org/archive/html/groff/2017-11/msg00055.html
	et sequentia.

2017-11-11  Bjarni Ingi Gislason <bjarniig@rhi.hi.is>

	* src/devices/grolbp/lbp.cpp (lbp_printer::setfillmode): Address
	  misleading indentation warning.

	* src/roff/troff/mtsm.cpp (mtsm::push_state, mtsm::pop_state):
	  Same.  Only flush standard error if we just wrote to it,
	  instead of unconditionally.

	Fix bug https://savannah.gnu.org/bugs/?51483.

2017-11-11  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/utils/xtotroff/xtotroff.c: Mark private function static.

2017-11-11  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/libs/libxutil/xmalloc.c: Quieten gcc warning.  Mollify
	-Wmissing-prototypes for xmalloc() in single-function file.

2017-11-11  G. Branden Robinson <g.branden.robinson@gmail.com>

	gxditview: Migrate extern declarations to headers.

	Also mark some private functions as static.

2017-11-11  Bjarni Ingi Gislason <bjarniig@rhi.hi.is>

	src: Declare function protypes where necessary.

	Fix bug https://savannah.gnu.org/bugs/?51513.

2017-11-10  Bjarni Ingi Gislason <bjarniig@rhi.hi.is>

	mom: Abort early with diagnostic in compatibility mode.

	Fix bug https://savannah.gnu.org/bugs/?52333.

2017-11-10  G. Branden Robinson <g.branden.robinson@gmail.com>

	* contrib/**: Migrate diagnostics away from `quotes'.

2017-11-09  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/**: Migrate diagnostics away from `these quotes'.

	Fix bug https://savannah.gnu.org/bugs/?52374.

2017-11-07  G. Branden Robinson <g.branden.robinson@gmail.com>

	* tmac/strip.sed: Remove nilpotent capture from address.

2017-11-05  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	`preconv': fix usage of lib `uchardet'.

	* src/preproc/preconv/preconv.cpp (detect_file_encoding): Fix
	usage of uchardet 0.0.1, which may fail but return an empty string
	instead of a null pointer, and fix some incorrect error
	managements that might cause memory leaks.

2017-11-05  G. Branden Robinson <g.branden.robinson@gmail.com>

	* font/devpdf/devpdf.am: Silence warning from grep during clean.

2017-11-04  G. Branden Robinson <g.branden.robinson@gmail.com>

	* Makefile.am: Drop unnecessary -F and -M flags from pdfmom
	call.

2017-11-02  Bjarni Ingi Gislason <bjarniig@rhi.hi.is>

	man/groff_diff.7.man: Correct the explanation of the request
	".itc"--it was backwards.

	Fix bug https://savannah.gnu.org/bugs/?51502.

2017-11-02  Bjarni Ingi Gislason <bjarniig@rhi.hi.is>

	test-groff.in: Recognize additional contrib tmacs.

	Fix bug https://savannah.gnu.org/bugs/?51598.

2017-11-02  G. Branden Robinson <g.branden.robinson@gmail.com>

	* Makefile.am: Force build to generate test-groff script.

2017-11-02  G. Branden Robinson <g.branden.robinson@gmail.com>

	* font/devpdf/devpdf.am: Silence warning from grep during build.

2017-11-02  G. Branden Robinson <g.branden.robinson@gmail.com>

	* doc/doc.am: Fix build of pic.html from clean tree.

2017-11-02  G. Branden Robinson <g.branden.robinson@gmail.com>

	* m4/groff.m4: Kill whitespace in macro diagnostic.

2017-11-01  Bjarni Ingi Gislason <bjarniig@rhi.hi.is>

	src/roff/grog/subs.pl: Fix typo in usage message.

	Fix bug https://savannah.gnu.org/bugs/?51540.

2017-10-28  Bjarni Ingi Gislason <bjarniig@rhi.hi.is>

	m.tmac: Fix some formatting and textual issues.
	* Protect full stops in strings \*[Letns!{1,2,10,11}].
	* Remove extraneous whitespace from string \*[Pg_type!1].

	Fix bug https://savannah.gnu.org/bugs/?51610.

2017-10-22  Bjarni Ingi Gislason <bjarniig@rhi.hi.is>

	refer-mm.tmac: Protect full stop in abbreviation of "ed.".

	Fix bug https://savannah.gnu.org/bugs/?51611.

2017-10-22  G. Branden Robinson <g.branden.robinson@gmail.com>

	* src/preproc/html/pre-html.cpp: Fix grammar in usage message.
	When used attributively, e.g. as an adjectival phrase,
	"command-line" should be hyphenated.

2017-10-22  Bjarni Ingi Gislason <bjarniig@rhi.hi.is>

	pdfpic: Suppress warning if in compatibility mode.

	Fix bug https://savannah.gnu.org/bugs/?51945.

2017-10-22  Bjarni Ingi Gislason <bjarniig@rhi.hi.is>

	www.tmac: Rename font 'C' to 'CR'; define 'CR'.

	The font name 'C' ('CW') is not a part of groff's fonts.

	Fix bug https://savannah.gnu.org/bugs/?51417.
	Also see https://savannah.gnu.org/bugs/?51426.

2017-10-04  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Fix build on MacOS X

	See https://savannah.gnu.org/bugs/?49651

2017-09-11  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Build from git: Make `configure' fail if `yacc' is not found.

	* m4/groff.m4 (GROFF_PROG_YACC): look for (in this order) `byacc',
	`bison -y', `yacc'.  Set `YACC' to `missing' is nothing is found
	and generate an error.  Don't generate an error if build is not
	done from git as tarball already distribute files generated by
	`yacc'.

2017-09-02  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Update `gnulib' submodule with latest version.

	* gnulib: now points on 07a187be7f66d3ced66587405f18205971c762e9
	from `gnulib' repository.

2017-09-02  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Fix .gitignore files for in-source build.

	Fix bug https://savannah.gnu.org/bugs/?51415.

2017-09-01  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Fix build on MacOS X

	* Makefile.am: define `SED' command with LANG and LC_ALL set to C.
	* contrib/mm/mm.am: use it.
	* doc/doc.am: Ditto.

	Fix bug https://savannah.gnu.org/bugs/?49649

2017-08-30  Colin Watson <cjwatson@debian.org>

	`BuildFoundries' should not be installed.

	* font/devpdf/devpdf.am: remove installation of generated script
	`BuildFoundries'.

2017-08-30  Bjarni Ingi Gislason <bjarniig@rhi.hi.is>

	pic2graph.1.man: Fix wrong macro for e-mail addresses.

	Fix bug https://savannah.gnu.org/bugs/?51110.

2017-08-30  Bjarni Ingi Gislason <bjarniig@rhi.hi.is>

	groff_diff(7): Remove a repeated word.

	Fix bug https://savannah.gnu.org/bugs/?51077.

2017-08-30  Bjarni Ingi Gislason <bjarniig@rhi.hi.is>

	groff_tmac(5): Fix double dot before request.

	Fix bug https://savannah.gnu.org/bugs/?51070.

2017-08-28  Bjarni Ingi Gislason <bjarniig@rhi.hi.is>

	groff.texi: remove repeated words.

	Fix bug https://savannah.gnu.org/bugs/?51046.

2017-08-28  Bjarni Ingi Gislason <bjarniig@rhi.hi.is>

	groff_man(7) manual page: Fix explanation of the ".itc" request.

	See bug at https://savannah.gnu.org/bugs/?51043.

2017-08-28  Ingo Schwarze  <schwarze@usta.de>

	groff_man(7) manual page: recommendations for escape sequences.

	See bug at https://savannah.gnu.org/bugs/?51021.

2017-08-28  Ingo Schwarze  <schwarze@usta.de>

	groff_char(7) manual: fix table "7-bit Character Codes"

	See bug at https://savannah.gnu.org/bugs/?51020.

2017-08-28  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Fix troff.1 misleading definition of -w all.

	See bug at https://savannah.gnu.org/bugs/?47784.  Suggested by Kaz
	Kylheku <kaz@kylheku.com>.

2017-08-25  Bjarni Ingi Gislason <bjarniig@rhi.hi.is>

	`preconv --version' crashes.

	See bug at: https://savannah.gnu.org/bugs/?51587.

	* src/preproc/preconv/preconv.cpp: Add a missing comma in the
	argument list of "printf".

2017-08-25  Bjarni Ingi Gislason <bjarniig@rhi.hi.is>

	Fix bug: `.itc' request breaks subsequent `.it' requests.

	See bug at: https://savannah.gnu.org/bugs/?51376.  Using `.itc'
	lets all later uses of `.it' behave like `.itc', that is,
	interrupted text line ending with \c is not counted as a separate
	line.

	* env.cpp: Restore input_trap state to normal when '.it' is
	called.

2017-08-25  Bjarni Ingi Gislason <bjarniig@rhi.hi.is>

	Fix a part of a virtual (pseudo) structure in "tty.tmac".

	* tmac/tty.tmac: Fix warning:  ".../git/groff/tmac/tty.tmac:19:
	warning: unbalanced .el request"

2017-08-25  Ingo Schwarze  <schwarze@usta.de>

	`tty-char.tmac': focus on meaning rather than graphical shape

	* tmac/tty-char.tmac: add ASCII renderings for six missing
	mathematical symbols

2017-08-22  Ingo Schwarze  <schwarze@usta.de>

	`tty-char.tmac': focus on meaning rather than graphical shape

	* tmac/tty-char.tmac: Switch the policy from trying to imitate the
	characters' graphical shapes, which resulted in unintelligible
	renderings in many cases, to transliterations conveying the
	characters' meanings.  One benefit is making these characters
	usable for portable manual pages.

2017-08-21  Deri James  <deri@chuzzlewit.myzen.co.uk>

	'gropdf' does not correctly load new ghostscript fonts

	See bug at: https://savannah.gnu.org/bugs/?50989. Since ghostscript
	9.21 the fonts supplied have changed from .pfb to .pfa type (with a
	raw binary section). These failed to be properly loaded.

	* src/devices/gropdf/gropdf: Changes to handle raw binary section in
	a .pfa type font.

2017-08-18  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	`pdfmom' man page incorrectly displayed.

	* src/devices/gropdf/pdfmom.1.man: Remove `]' character mistakenly
	added at the beginning of the file.

2017-08-18  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Incorrect font name for CBI in Foundry.in.

2017-08-15  Ingo Schwarze  <schwarze@usta.de>

	Fix build if `configure' check for `fprintf-posix' fails.

	See bug at: https://savannah.gnu.org/bugs/?51554.  If tests for
	posix compliance of fprintf from `gnulib_m4/fprintf-posix.m4'
	fail, a replacement function of `fprintf' is used.  Consequently,
	all executables that use this function must link against the
	gnulib (`libgnu.a').  The bug was introduced by commit
	fa41eeba06987a12bc0434f8b51896d4618a3997.

	* src/devices/xditview/xditview.am
	* src/preproc/eqn/eqn.am
	* src/preproc/pic/pic.am
	* src/preproc/preconv/preconv.am
	* src/preproc/refer/refer.am
	* src/preproc/soelim/soelim.am
	* src/preproc/tbl/tbl.am
	* src/utils/addftinfo/addftinfo.am
	* src/utils/hpftodit/hpftodit.am
	* src/utils/indxbib/indxbib.am
	* src/utils/lkbib/lkbib.am
	* src/utils/lookbib/lookbib.am
	* src/utils/pfbtops/pfbtops.am
	* src/utils/tfmtodit/tfmtodit.am
	* src/utils/xtotroff/xtotroff.am: link against libgnu.a

	* INSTALL.REPO: recommend the autoconf and automake versions used
	during automake migration rather than the minimum versions.

2017-08-04  Deri James  <deri@chuzzlewit.myzen.co.uk>

	See bug at: https://savannah.gnu.org/bugs/?51568

	* src/devices/gropdf/gropdf: Further 'fix' to handle those octal
	characters. See comment #5 - thank you Bjarni.

2017-07-31  Deri James  <deri@chuzzlewit.myzen.co.uk>

	See bug at: https://savannah.gnu.org/bugs/?51568
	
	* src/devices/gropdf/gropdf: previous 'fix' was too narrow, all
	'\' characters should be escaped. Also there was an unwanted 
	interaction with code in routine 'do_t'. Sometimes, do_C, when 
	the named glyph is mapped to a chr < 32, this is encoded as octal
	\nnn, so in this case the '\' must not be escaped.
	
2017-07-25  Deri James  <deri@chuzzlewit.myzen.co.uk>

	If input text contained string which could be interpreted as
	escaped octal (\ddd) a pdf viewer would interpret as an octal
	character.  See bug at: https://savannah.gnu.org/bugs/?51568
	
	* src/devices/gropdf/gropdf: protect text which resembles \ddd
	by escaping with extra '\'.
	
2017-07-12  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Use uchardet library in `preconv' to detect input file encoding

	* m4/groff.m4 (GROFF_UCHARDET): new macro that use pkg-config to
	check if uchardet library is available and define new option
	`--with-uchardet':
	- If `yes' is passed and uchardet is not found, configure fails.
	- If `no' is passed we don't use uchardet and don't display any
	warning.
	- If `auto' (or any other option) is passed of if --with-uchardet
	is not passed, we use uchardet if available, otherwise the build
	goes on but a warning is displayed at the end of the configuration
	phase.

	* configure.ac: use pkg-config and `GROFF_UCHARDET' to detect the
	presence of uchardet library.

	* src/preproc/preconv/preconv.am: link against uchardet library if
	available.

	* src/preproc/preconv/preconv.cpp (detect_file_encoding): new
	function that uses uchardet library to detect input file encoding.
	(do_file): `detect_file_encoding'.

	* src/preproc/preconv/preconv.1.man: update `preconv'
	documentation.

	See https://savannah.gnu.org/bugs/?51330

2017-07-12  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Add gnulib module fprintf-posix

	* bootstrap.conf: do it.

	* Fix compilation in some files that needed inclusion of
	`config.h'.

	See https://savannah.gnu.org/bugs/?51330

2017-05-09  Bertrand Garrigues <bertrand.garrigues@laposte.net>

	Package `ghostscript' 9.21 renamed some fonts installed in
	`/usr/share/ghostscript/9.21/Resource/Font', e.g. URWGothicL-Demi
	renamed to URWGothic-Demi, and droped the installation of URW
	fonts in `/usr/share/fonts/type1/gsfonts/', breaking font
	generation in `font/devpdf/util/BuildFoundries.pl'.

	* m4/groff.m4 (GROFF_URW_FONTS_PATH): New option
	`--with-urw-fonts-dir' to pass a custom path to URW fonts.
	(GROFF_URW_FONTS): search the presence of URW fonts by checking if
	file `a010013l.pfb' exists in the paths given by `gs -h', in the
	default paths used in `Foundry.in' and in the path given with
	option `--with-urw-fonts-dir'.
	(GROFF_URW_FONTS_CHECK): print a warning at the end of the
	configuration phase if no URW fonts were found.

	* configure.ac: call new macros `GROFF_URW_FONTS_PATH',
	`GROFF_URW_FONTS' and `GROFF_URW_FONTS_CHECK'.

	* font/devpdf/Foundry.in: add new basic fonts names and pass
	custom URW fonts path `urwfontsdir'.

	* font/devpdf/devpdf.am: subsitute `urwfontsdir' in `Foundry'
	generation.

	Fixes https://savannah.gnu.org/bugs/?50786

2017-05-04  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Fixes for gropdf
	
	* src/devices/gropdf/gropdf.pl: Escape '(' and ')' if
	used in a bookmark, and ignore relative move 'h' if 
	followed by absolute move 'H' in groff intermediate output.
	
2017-04-29  Ingo Schwarze  <schwarze@usta.de>

	groff_char(7): improve description of ASCII characters

	* man/groff_char.7.man: improve description of ASCII
	characters that do not render as themselves

	See https://savannah.gnu.org/bugs/?50898

2017-04-28  Osamu Sayama

	lkbib with empty file dumps core

	* src/libs/libbib/index.cpp: Test if argument to malloc(3)
	is zero.

	See https://savannah.gnu.org/bugs/?48433

2017-04-28  David Gilman

	Typo in groff.texi

	* doc/groff.texi: Dp instead of DP used

	https://savannah.gnu.org/bugs/index.php?42251

2017-04-28  Rich Burridge

	"grops -c a" dumps core

	* src/devices/grops/ps.cpp: conversion specifier %s changed
	to %1 (errprint() uses special syntax different from
	printf(3))

	https://savannah.gnu.org/bugs/?42190

2017-04-28  Bjarni Ingi Gislason  <bjarniig@rhi.hi.is>

	Macro "itc" is needed to make escape "\c" useful

	* tmac/an-old.tmac: .it changed to .itc

	https://savannah.gnu.org/bugs/?42907

2017-04-28  Bjarni Ingi Gislason  <bjarniig@rhi.hi.is>

	First italic correction (\,) is absent in macros IR and IB

	* tmac/an-old.tmac: Italic correction added

	https://savannah.gnu.org/bugs/?42906

2017-04-13  Ingo Schwarze  <schwarze@usta.de>

	* tmac/doc.tmac-u: Make .Lk with more than two arguments
	mdoc(7) conform

	Use the second and following arguments as the link text.

	Do not mark up the following colon with \fI.

	Handle any number of trailing delimiters.

	Problem reported by Anthony Bentley <bentley@openbsd.org>,
	fixed by Ingo Schwarze <schwarze@usta.de>.

	https://savannah.gnu.org/bugs/?50789

2017-04-12  Werner LEMBERG  <wl@gnu.org>

	Update German hyphenation patterns.

	* tmac/de.tmac: Add more hcode values.
	No longer use `hyphenex.det'.
	* tmac/hyphen.den, tmac/hyphen.det: Updated to `dehyph-exptl-0.41'.
	* tmac/hyphenex.det: Removed, no longer needed.
	* tmac/tmac.am (TMACNORMALFILES): Updated.

2017-04-10  Ingo Schwarze  <schwarze@usta.de>

	* tmac/doc.tmac-u: Punctuation handling of .Lk fixed

	The implementation of the groff_mdoc(7) .Lk (hyperlink) macro
	contains code to make sure that the second argument is not
	punctuation before treating it as a link text, but the test
	can never lead to the result "punctuation" because the
	initialization of the global variable doc-width was missing
	before the call to doc-get-arg-type.  Consequently, even "."
	was not recognized as punctuation.

	Problem reported by Anthony Bentley <bentley@openbsd.org>,
	fixed by Ingo Schwarze <schwarze@usta.de>.

	https://savannah.gnu.org/bugs/?50771

2017-04-07  Werner LEMBERG  <wl@gnu.org>

	* tmac/hyphenex.us: Updated to current release from TeXLive.

2017-02-23  Bertrand Garrigues  <bertrand.garrigues@laposte.net>

	* bootstrap: update with latest version from gnulib.
	* gnulib: update the git submodule with latest version (commit
	4084b3a1094372b960ce4a97634e08f4538c8bdd from gnulib).

2017-02-18  Colin Watson  <cjwatson@debian.org>

	* src/preproc/eqn/main.cpp: Define EQ and EN if they are not already
	defined, to appease "groff -wmac".
	* src/preproc/pic/main.cpp: Likewise for PS and PE.

	Fixes: http://bugs.debian.org/495713

2017-02-16  Ingo Schwarze  <schwarze@usta.de>

	mdoc %T: use typographic quotes

	* tmac/doc.tmac-u: Changed \*[q] to \*[Lq] and \*[Rq]

	Citing Anthony J. Bentley:

	The below patch causes -mdoc to generate typographic quotes
	around a %T (reference title) instead of straight quotes.

	I also submitted similar diffs to mandoc and heirloom troff
	(which haven't been committed yet).  It would be nice for
	the major implementations not to differ here, and the change
	is trivial. 

	It's worth noting that groff's refer(1) already uses typographic
	quotes around %T with my -ms documents.

	https://savannah.gnu.org/bugs/?43553
	http://comments.gmane.org/gmane.comp.tools.mdocml.devel/723 
	https://github.com/n-t-roff/heirloom-doctools/pull/6

2017-02-16  Ingo Schwarze  <schwarze@usta.de>

	mdoc \*[Lq], \*[Rq]: map to \[lq], \[rq] for all terminal
	devices

	* tmac/doc-nroff-u: .ds Lq \[lq], .ds Rq \[rq]

	If you use \[lq] and \[rq] directly in your document, the
	quotes already render nicely for all terminal devices:
	as U+201C and U+201D for devutf8 and as ASCII 0x22 (") for
	devascii and devlatin1.
	So it is not quite clear why doc-nroff should avoid
	\[lq] and \[rq] when resolving \[Lq] and \[Rq] for devascii
	and devlatin1. Quite to the contrary, many people seem to
	consider "``" and "''" ugly renderings because they look
	unbalanced.

	See

	https://savannah.gnu.org/bugs/?43554

2017-02-16  Bjarni Ingi Gislason  <bjarniig@rhi.hi.is>

	Use the traditional (portable) method of using a backslash
	after '\{'

	* contrib/mm/m.tmac, tmac/e.tmac-u,
	  tmac/s.tmac: Add '\' after "\{"

	See

	https://savannah.gnu.org/bugs/?49917

2017-02-16  Bjarni Ingi Gislason  <bjarniig@rhi.hi.is>

	Use explicit \sn after a variable string instead of \s0

	* tmac/e.tmac-u: Change \s0 to \s+3

	See

	https://savannah.gnu.org/bugs/?49915

2016-12-29  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Remove duplicate '-e' from gropdf manual.
	
	* src/devices/gropdf/gropdf.1.man: Remove first '-e'.
	
2016-11-25  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Remove incorrect info from gropdf manual.
	
	* src/devices/gropdf/gropdf.1.man: Remove references
	to postscript.
	
2016-11-22  George HELFFRICH  <ghfbsd@gmail.com>

	[me]: Fix alignment of `(c' macro (#43306).

	* tmac/e.tmac-u ((c): Properly initialize environment.

2016-11-20  George HELFFRICH  <ghfbsd@gmail.com>

	[me] Fix vertical spacing of `(b' macro (#42217).

	* tmac/e.tmac-u (@k): Apply pre-spacing conditionally.
	()b): Updated.

2016-11-19  George HELFFRICH  <ghfbsd@gmail.com>

	[me] Fix remaining bugs with line numbering (#49650).

	* tmac/e.tmac-u (nm): Redefine.
	(.n1, .n2): Update so all environments affected.
	(.ip): Fix double numbering.
	(.)c, .)l): Restore numbering after diversion included.

2016-11-01  Deri James  <deri@chuzzlewit.myzen.co.uk>

	gropdf remaps characters to position 13 (#48986).
	
	* src/devices/gropdf/gropdf: Do not remap anything to chr(13).

2016-11-01  Deri James  <deri@chuzzlewit.myzen.co.uk>

	pdfmom was not including $preconv in the initial groff run.
	
	* src/devices/gropdf/pdfmom.pl: Include $preconv in first 
	groff run which resolves forward pdf references.

2016-10-05  Ingo Schwarze  <schwarze@usta.de>

	* tmac/doc.tmac-u: Simplify behaviour of .Bl -tag
	* tmac/groff_mdoc.7.man: Update documentation to the new
	behaviour of .Bl -tag

	If an mdoc(7) .Bl -tag macro lacks the -width argument, the
	body indentation is calculated separately for each child .It
	macro.  Neither the Heirloom nor the mandoc(1) implementation
	of the mdoc(7) language show such behaviour; both use a
	constant default width for the whole list in that case.

	Apart from doubts whether lists with variable indentation are
	typographically sound in the first place, support for variable
	widths in groff is so restricted that it's practically
	useless.  For each .It, the width will be the default width of
	whatever happens to be the leading macro after the .It, or of
	.No if .It is not followed by a macro.

	See

	https://savannah.gnu.org/bugs/index.php?49272

	and

	http://lists.gnu.org/archive/html/groff/2016-10/msg00006.html


2016-09-09  Werner LEMBERG  <wl@gnu.org>

	* tmac/sv.tmac: Fix `.hy' settings (#48904).

	The Swedish patterns allow hyphenation after the first character and
	before the last two characters, not vice versa.

2016-09-09  Werner LEMBERG  <wl@gnu.org>

	troff: Fix hyphenation (#48904).

	This commit fixes two bugs present from the very beginning: troff
	(a) didn't allow to hyphenate words shorter than 4 characters
	(ignoring `.hy' settings), and (b) never tried to hyphenate after
	the first character due to wrong handling of the `.hy' settings.

	* src/roff/troff/env.cpp (environment::hyphenate_line): Use
	hyphenation flags to determine the minimum word length considered
	for hyphenation.
	(hyphenate): Fix handling of `HYPHEN_FIRST_CHARS'.

2016-07-29  Colin Watson  <cjwatson@debian.org>

	Implement `SOURCE_DATE_EPOCH' for reproducible builds.

	* src/include/curtime.h: New file.
	* src/libs/libgroff/curtime.cpp: New file.
	* src/libs/libgroff/libgroff.am (libgroff_a_SOURCES): Add
	src/libs/libgroff/curtime.cpp.

	* src/roff/troff/input.cpp (init_registers): Use `current_time'
	instead of `time(0)'.
	* src/devices/grohtml/post-html.cpp
	(html_printer::do_file_components): Likewise.
	(html_printer::~html_printer): Likewise.
	* src/devices/grops/ps.cpp (ps_printer::~ps_printer): Likewise.
	* src/devices/gropdf/gropdf.pl: Use `$ENV{SOURCE_DATE_EPOCH}` if
	available in preference to `time`.

	* doc/groff.texi (Environment): Document `SOURCE_DATE_EPOCH'.
	* src/devices/grohtml/grohtml.1.man (ENVIRONMENT): Likewise.
	* src/devices/gropdf/gropdf.1.man (ENVIRONMENT): Likewise.
	* src/devices/grops/grops.1.man (ENVIRONMENT): Likewise.

2016-04-19  Carsten Kunze  <carsten.kunze@arcor.de>

	eqn: Fix problem with explicite spacing before unary operator

	* src/preproc/eqn/list.cpp (list_box::compute_metrics): Change
	item spacing type from BINARY to ORDINARY also when previous
	type is SUPPRESS_TYPE.

	As reported in

	http://lists.gnu.org/archive/html/groff/2016-04/msg00024.html

	by Douglas McIlroy <doug@cs.dartmouth.edu>

	an implicite space is added between an unary operator and it's
	operand when an explicite space is put before the unary
	operator.  Unary operators are initially set up as binary.
	Depending on the preceding element their type can be changed
	to unary.  This did not happen when an explicite space ('~' or
	'^') had been before that operator.

2016-02-16  Blint Rczey  <balint@balintreczey.hu>

	Fix many malloc/new vs. free/delete/delete[] mismatches (#47164)

	* src/devices/grops/ps.cpp (ps_font::~ps_font,
	ps_printer::define_encoding): Use `free'.
	* src/devices/grops/psrm.cpp (resource::~resource,
	resource_manager::output_prolog, resource_manager::supply_resource,
	resource_manager::read_download_file): Ditto.

	* src/include/ptable.h (PTABLE::~PTABLE, PTABLE::define): Ditto.

	* src/libs/libgroff/searchpath.cpp
	(search_path::open_file_cautious): Ditto.

	* src/libs/libgroff/string.cpp: Include `stdlib.h'.
	(string::extract): Use `malloc'.

	* src/preproc/eqn/box.cpp (quoted_text_box::~quoted_text_box): Use
	`free'.

	* src/preproc/eqn/lex.cpp (definition::~definition,
	macro_input::~macro_input, top_input::~top_input, do_definition):
	Ditto.

	* src/preproc/eqn/main.cpp (main): Ditto.

	* src/preproc/eqn/other.cpp: Include `stdlib.h'.
	(size_box::~size_box, font_box::~font_box): Use `free'.

	* src/preproc/eqn/text.cpp: Include `stdlib.h'.
	(box::set_spacing_type, special_char_box::~special_char_box,
	split_text): Use `free'.

	* src/preproc/grn/main.cpp (conv): Use `free'.

	* src/preproc/html/pre-html.cpp (get_resolution): Ditto.

	* src/preproc/pic/lex.cpp (macro_input::~macro_input,
	argument_macro_input::~argument_macro_input, for_input::~for_input):
	Ditto.

	* src/preproc/pic/main.cpp (do_picture): Ditto.

	* src/preproc/pic/object.cpp: Include `stdlib.h'.
	(text_piece::~text_piece, string_list::~string_list): Use `free'.

	* src/preproc/pic/pic.ypp (placeless_element, element, text, label,
	expr_not_lower_than): Ditto.

	* src/preproc/pic/troff.cpp (troff_output::reset_color): Ditto.

	* src/preproc/preconv/preconv.cpp (check_coding_tag): Ditto.

	* src/preproc/soelim/soelim.cpp (do_file): Ditto.

	* src/preproc/tbl/table.cpp (text_entry::~text_entry): Ditto.

	* src/roff/groff/groff.cpp (possible_command::~possible_command,
	possible_command::set_name): Ditto.

	* src/roff/troff/env.cpp (hyphen_trie::read_patterns_file): Ditto.

	* src/roff/troff/node.cpp (suppress_node::tprint): Ditto.

2016-02-16  Blint Rczey  <balint@balintreczey.hu>

	Use `malloc' in `strsave'; use `free' for returned pointers (#47164).

	* src/libs/libgroff/font.cpp (text_file::~text_file): Use `free'.

	* src/libs/libgroff/searchpath.cpp (search_path::open_file): Use
	`free'.

	* src/libs/libgroff/strsave.cpp: Include `stdlib.h'.
	(strsave): Use `malloc'.

2016-02-16  Blint Rczey  <balint@balintreczey.hu>

	Simplify memory allocation (#47162).

	Many invalid memory accesses were caught by UBSAN (e.g., invalid
	memory access in `small_temp_iterator::operator new') while
	bootstrapping hardened1-linux-amd64 Debian port in the `free_list'
	handling because it doesn't properly handle the padding between
	array elements.

	Some places were already #if 0-d out anyway.

	* src/roff/troff/input.cpp (small_temp_iterator): Remove class.
	(make_temp_iterator): Use `temp_iterator' only.

	* src/devices/grotty/tty.cpp (tty_glyph): Remove `free_list', `new',
	and `delete'.

	* src/include/color.h, src/include/color.cpp (color): Ditto.

	* src/roff/troff/env.cpp (tab): Ditto.

	* src/roff/troff/node.cpp (glyph_node): Ditto.

2016-02-15  Blint Rczey  <balint@balintreczey.hu>

	[pre-grohtml] Fix out-of-bounds array access (#47161).

	* src/preproc/html/pre-html.cpp (char_buffer::write_upto_newline):
	Implement it.

2016-02-15  Blint Rczey  <balint@balintreczey.hu>

	Don't use `memcpy' with NULL input or output argument (#47160).

	* src/libs/libgroff/string.cpp (string::string, string::operator=):
	Implement it.

	* src/roff/troff/input.cpp (temp_iterator::temp_iterator): Implement
	it.

2016-02-04  Carsten Kunze  <carsten.kunze@arcor.de>

	* tmac/s.tmac: Bugfix of previous commit simplified (and
	introduced redundancy removed) by use of .par*start for .QS and
	.QE.  This is consistent since any other paragraph macro is
	using .par*start.

2016-02-02  Carsten Kunze  <carsten.kunze@arcor.de>

	* tmac/s.tmac: Macros .QS and .QE changed to insert vertical
	inter-paragraph space.  A paragraph bracketed with .QS/.QE
	should appear identical to a .QP paragraph followed by .LP.

	* tmac/groff_ms.7.man, doc/groff.texi: Documentation of macros
	.QS and .QE added and .QP information improved (effect of
	registers QI and PD).

	See also discussion at groff@gnu.org, thread starting at

	http://lists.gnu.org/archive/html/groff/2016-01/msg00033.html

	Issue reported by Douglas McIlroy <doug@cs.dartmouth.edu>

2015-12-26  Carsten Kunze  <carsten.kunze@arcor.de>

	* contrib/mm/m.tmac: Disable macro misc@tag in case output
	  type is not HTML.

	This macro did cause unwanted space in case a MM macros .H
	had been followed immediately by .DS.

	(See also discussion at groff@gnu.org, thread starting at
	http://lists.gnu.org/archive/html/groff/2015-12/msg00033.html)

	Bug reported by Damian McGuckin <damianm@esi.com.au>.

2015-12-14  Werner LEMBERG  <wl@gnu.org>

	* src/preproc/eqn/text.cpp (entity_table): s/lamda/lambda/.

	Bug reported by Brian McGuinness <mcguinne@fdu.edu>.

2015-10-27  Deri James  <deri@chuzzlewit.myzen.co.uk>

	gropdf was choking on -I flag passed by groff, now uses
	these directories to search for included pdfs.
	
	* src/devices/gropdf/gropdf.pl: Handle -I flag, avoid
	  unitialised values.
	
	* src/roff/groff/groff.1.man: Include 'X pdf: pdfpic'
	
	* src/devices/gropdf/gropdf.1.man: Document -I flag
	
2015-09-10  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/subs.pl: fix comments

2015-09-03  Bernd Warken  <groff-bernd.warken-72@web.de>

	* tmac/troffrc: Add .mso for file `pdfpic.tmac'.

2015-08-28  Bertrand Garrigues  <bertrand.garrigues@laposte.net>

	* Makefile.am:
	- Use only the naming `.section.man' for all man.pages.
	- Replace `.man.n' by `.man' only, such that no `.n' is
	generated.
	- For example, the source `groff.7.man' is transformed into
	`groff.7' in the same directory and then is by installing just
	copied into one of the suitable installed man directory.

2015-08-27  Bernd Warken  <groff-bernd.warken-72@web.de>

	* tmac/pfdpic.tmac: Add tmac file for macro `PDFPIC'.

	* tmac/tmac.am: Add new `pdfpic.tmac' file.

	* man/groff_tmac.5.man: Add definition for the new tmac.

2015-08-22  Bernd Warken  <groff-bernd.warken-72@web.de>

	* all man-pages *.man: Rename man-pages such that the man section
	number before the final `.man'.

	* all *.am: Include renaming.

	* Makefile.am: Reset `.man.n' by `.[157].man.n' with SUFFIXES
	`.[157].man .n'.

2015-08-20  Bernd Warken  <groff-bernd.warken-72@web.de>

	* Makefile.am: Fix definition of man[157]_MANS.

2015-08-13  Bernd Warken  <groff-bernd.warken-72@web.de>

	* all *.am: Correct Emacs mode `End:' instead of `End.'.

2015-08-09  Werner LEMBERG  <wl@gnu.org>

	Revert previous commit, since it doesn't work correctly yet.

2015-08-07  Bernd Warken  <groff-bernd.warken-72@web.de>

	Add section name to all man-page names.

	* Makefile.am: In `install-prefix-man' and `uninstall-prefix-man'
	change `sed' commands.  Correct saving in man[157]_MANS.

	* all *.man in source tree: Rename `manpage.man' to
	`manpage.[157].man'.

	* all makefile.am in source tree: Add new man-page file name.

2015-08-05  Bernd Warken  <groff-bernd.warken-72@web.de>

	* Makefile.am, arch/mingw/mingw.am, arch/misc/misc.am,
	* contrib/eqn2graph/eqn2graph.am, contrib/grap2graph/grap2graph,
	* contrib/pic2graph/pic2graph.am, doc/doc.am,
	* font/devX100/devX100.am, font/devX100-12/devX100-12.am,
	* font/devX75/devX75.am, font/devX75-12/devX75-12.am,
	* font/devascii/devascii.am, font/devcp1047/devcp1047.am,
	* font/devdvi/devdvi.am, font/devhtml/devhtml.am,
	* font/devlatin1/devlatin1.am, font/devlbp/devlbp.am,
	* font/devlj4/devlj4.am, font/devpdf/devpdf.am,
	* font/devps/devps.am, font/devutf8/devutf8.am,
	* font/scripts/scripts.am, man/man.am,
	* src/devices/grodvi/grodvi.am, src/devices/grohtml/grohtml.am,
	* src/devices/grolbp/grolbp.am, src/devices/grolj4/grolj4.am,
	* src/devices/gropdf/gropdf.am, src/devices/grops/grops.am,
	* src/devices/grotty/grotty.am,
	* src/include/include.am, src/libs/libbib/libbib.am,
	* src/libs/libdriver/libdriver.am, src/libs/libgroff/libgroff.am,
	* src/libs/libxutil/libxutil.am, src/preproc/grn/grn.am,
	* src/preproc/html/html.am, src/preproc/pic/pic.am,
	* src/preproc/preconv/preconv.am, src/preproc/tbl/tbl.am
	* src/preproc/refer/refer.am, src/preproc/soelim/soelim.am,
	* src/roff/groff/groff.am, src/roff/grog/grog.am,
	* src/roff/nroff/nroff.am, src/roff/troff/troff.am,
	* src/utils/addftinfo/addftinfo.am,
	* src/utils/afmtodit/afmtodit.am, src/utils/hpftodit/hpftodit.am,
	* src/utils/indxbib/indxbib.am, src/utils/lkbib/lkbib.am,
	* src/utils/lookbib/lookbib.am, src/utils/pfbtops/pfbtops.am,
	* src/utils/tfmtodit/tfmtodit.am, src/utils/xtotroff/xtotroff.am,
	* tmac/tmac.am:
	Add `Last update'.  Setup Emacs mode.

2015-07-29  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/subs.pl: Add -T for all `grog' output, also using
	-Tps when no option -T is given in the arguments.

	* src/roff/grog/grog.man: Add information about -T output.

2015-07-23  Bernd Warken  <groff-bernd.warken-72@web.de>

	* man/groff.man: Add last update.  Add link on Wikipedia on groff.
	Add link of groff tutorial by Laha.

2015-07-19  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/*.pl: Add last update.

	* src/roff/grog/subs.pl: Remove call to Perl INC::System::Simple,
	use backticks instead.
	Define &err().
	Reorder some extensions.
	Distinguish between .TH at first command for man and later on for
	ms.

2015-07-01 Peter Bray <pdb_ml@yahoo.com.au>

	Fix Savannah bug #44784.

	Compatibility Mode rendering of groff manual pages

	* m4/groff.m4 (GROFF_WITH_COMPATIBILITY_WRAPPERS): New macro to
	implement 'configure' option
	'--with-compatibility-wrappers=<value>'.  With this option the
	user can control how groff compatibility wrappers for
	vendor-provided non-GNU macro sets are installed.

	* configure.ac: Use new macro GROFF_WITH_COMPATIBILITY_WRAPPERS.

	* Makefile.am: Define tmac_*_prefix if 'compatibility_wrappers' is
	set to 'yes'.

	* tmac/tmac.am: Use 'compatibility_wrappers' to control the
	installation:

	- If set to `no', the groff-provided macro set are installed in
	<prefix>/share/groff/<version>/tmac/ with the original macro set
	name.

	- If set to `yes', the groff-provided macro set are installed in
	<prefix>/share/groff/<version>/tmac/ with a prefix of
	$(tmac_prefix) (which is usually `g') and the generated
	compatibility wrappers are installed in
	<prefix>/lib/groff/site-tmac, with the original macro set name.

	- If set to `manual', the groff-provided macro set are installed
	in <prefix>/share/groff/<version>/tmac/ with the original macro
	set name and the generated compatibility wrappers are installed in
	<prefix>/lib/groff/site-tmac, with a name of
	<macro><wrapper_suffix> (which is usually `-os').

2015-06-17  Werner LEMBERG  <wl@gnu.org>

	* tmac/tty.tmac: Fix mapping of \[bu] character for -Tutf8.

	Problem reported by carsten.kunze@arcor.de.

2015-06-15  Deri James  <deri@chuzzlewit.myzen.co.uk>

	pdfmom should use $RT_SEP as path separator.

	* src/devices/gropdf/gropdf.am: Use @RT_SEP@ as path separator.

	* src/devices/gropdf/pdfmom.pl: As above but also fix typo in regex
	for grep.

2015-05-08  Eli Zaretskii  <eliz@gnu.org>

	[groff] Make relocation really work.

	See

	  https://lists.gnu.org/archive/html/groff/2015-05/msg00000.html

	* src/roff/groff/groff.cpp: Include `relocate.h'.
	(main): Use `relocatep'.

2015-05-03  Bertrand Garrigues  <bertrand.garrigues@laposte.net>

	Fix Savannah bug #44768 (Solaris 10 compatibility issues).

	* m4/groff.m4 (GROFF_DIFF_D): new macro to check if `diff' has
	option -D, and search for `gdiff' if not (new variable DIFF_PROG
	will contain the `diff' program to be used).

	* m4/groff.m4 (GROFF_HAVE_TEST_EF_OPTION): new macro to check if
	`test' supports the option -ef (created new variable
	HAVE_TEST_EF_OPTION).

	* m4/groff.m4 (GROFF_BASH): new macro to search for `bash' (new
	variable BASH_PROG will contain the full path to `bash' or
	`/bin/sh' if `bash' was not found).

	* configure.ac: use the 3 new macros defined in m4/groff.m4.

	* contrib/gdiffmk/gdiffmk.am: set HAVE_TEST_EF_OPTION, BASH_PROG,
	DIFF_PROG in the generated script `gdiffmk'.

	* contrib/gdiffmk/gdiffmk.sh:
	- Fix incorrect space after '!' in sed script regex.
	- `test -ef' is not portable: If `bash' is not available and the
	shell does not support `test -ef', the option to pass a third
	argument as the output file is disabled.
	- Report an error if `diff' does not support -D option.
	- GNU diff and Solaris diff support -D, but #ifndef / #endif are
	treated differently (GNU adds a '!' in the #endif): modify the
	regexs in the sed script accordingly.

2015-05-01  Werner LEMBERG  <wl@gnu.org>

	* tmac/tmac.am (TMACNORMALFILES): Add `zh.tmac'.

2015-04-30  Darcy SHEN  <sadhen1992@gmail.com>

	Fix Savannah bug #44941.

	* tmac/zh.tmac: New file to support basic Chinese (both simplified
	and traditional).

2015-04-22  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Fix Savannah bug #44891.

	* src/devices/gropdf/gropdf.pl: If module Compress::Zlib is not
	available fall back to producing uncompressed PDF and output a
	warning.

2015-04-22  Bjarni Ingi Gislason  <bjarniig@rhi.hi.is>

	Fix Savannah bug #44894.

	* tmac/strip.sed: Add a `generated file' warning.

2015-04-21  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Fix Savannah bug #44890.
	Patch by Peter Bray.

	* font/devpdf/devpdf.am: Don't use 'find -maxdepth'.

2015-03-07  Ingo Schwarze  <schwarze@openbsd.org>

	[mdoc] Fix Savannah bug #44733.

	Prevent mdoc(7) Bl with trailing -width or -offset from picking up
	old args.

	* tmac/doc.tmac-u (doc-do-Bl-args): When checking whether there is
	another argument to a Bl macro, do not inspect the argument list
	because it is never cleaned and may contain arguments from previous
	macro invocations.  Instead, inspect the argument count which is
	always up to date.

2015-04-10  Daiki Ueno  <ueno@gnu.org>

	Fix link error on NetBSD 6.

	Reported by carsten.kunze@arcor.de in:
	<https://lists.gnu.org/archive/html/groff/2015-04/msg00000.html>.
	The problem can also be reproduced if gl_cv_func_wcwidth_works=no
	is passed to configure.

	* src/preproc/grn/grn.am (grn_LDADD): Change the link order of
	libgroff.a and lib/libgnu.a according to dependency.
	* src/roff/troff/troff.am (troff_LDADD): Likewise.

2015-04-08  Werner LEMBERG  <wl@gnu.org>

	Fix Savannah bug #44767.
	Patch by Peter Bray.

	* src/roff/grog/grog.am (grog): Correctly substitute `grog_dir'.

2015-04-03  Werner LEMBERG  <wl@gnu.org>

	Fix Savannah bug #44708 (2/2).

	Make man pages work in compatibility mode.
	Also fix some minor typos.

	* contrib/pic2graph/pic2graph.man, man/ditroff.man, man/groff.man,
	man/groff_diff.man, man/groff_out.man, man/groff_tmac.man,
	man/roff.man, src/devices/grodvi/grodvi.man,
	src/devices/grohtml/grohtml.man, src/devices/grolbp/grolbp.man,
	src/devices/grolj4/grolj4.man, src/devices/grolj4/lj4_font.man,
	src/devices/gropdf/gropdf.man, src/devices/gropdf/pdfmom.man,
	src/devices/grops/grops.man, src/devices/grotty/grotty.man,
	src/devices/xditview/xditview.man, src/preproc/eqn/eqn.man,
	src/preproc/eqn/neqn.man, src/preproc/grn/grn.man,
	src/preproc/pic/pic.man, src/preproc/preconv/preconv.man,
	src/preproc/refer/refer.man, src/preproc/soelim/soelim.man,
	src/preproc/tbl/tbl.man, src/roff/groff/groff.man,
	src/roff/grog/grog.man, src/roff/nroff/nroff.man,
	src/roff/troff/troff.man, src/utils/addftinto/addftinfo.man,
	src/utils/afmtodit/afmtodit.man, src/utils/hpftodit/hpftodit.man,
	src/utils/indxbib/indxbib.man, src/utils/lkbib/lkbib.man,
	src/utils/lookbib/lookbib.man, src/utils/pfbtops/pfbtops.man,
	src/utils/tfmtodit/tfmtodit.man, src/utils/xtotroff/xtotroff.man,
	tmac/groff_man.man, tmac/groff_trace.man: Do it.

2015-04-03  Werner LEMBERG  <wl@gnu.org>

	Fix Savannah bug #44708 (1/2).

	* tmac/andoc.tmac (reload_doc, reload_man): Don't use `de1',
	otherwise we can't manipulate the compatibility flag within the
	macro.

	* tmac/doc-common-u (Dt): Remove invalid leading whitespace.

2015-03-11  Deri James  <deri@chuzzlewit.myzen.co.uk>

	* src/devices/gropdf/gropdf.pl: Was not handling the final glyph
	correctly in the "standard" fonts which are not embedded. They
	actually have 257 glyphs (0-256) not 256 as I'd assumed, so the
	remappiing code needs to be applied for them as well as the
	embedded downloadable fonts.

2015-03-11  Deri James  <deri@chuzzlewit.myzen.co.uk>

	* src/devices/gropdf/gropdf.pl: Fix problem remappiing
	ellipsis (affects all glyphs > 255).

2015-03-07  Werner LEMBERG  <wl@gnu.org>

	* tmac/tmac.am (TMACSPECIALFILES): Removed.  No longer used.

2015-03-07  Ingo Schwarze  <schwarze@openbsd.org>

	* tmac/doc-common-u (Dd): Avoid warning `unbalanced .el request'.

2015-02-12  Werner LEMBERG  <wl@gnu.org>

	Minor fixes due to renaming `groff.texinfo' to `groff.texi'.

	* doc/doc.am (SUFFIXES): Update.
	* m4/groff.m4 (GROFF_MAKEINFO): Update.

2015-01-30  Bertrand Garrigues  <bertrand.garrigues@laposte.net>

	Automake migration and Gnulib integration.

	Gnulib:
	- Added gnulib as a git submodule.
	- Integrated bootstrap scripts from gnulib.
	- Gnulib m4 directory is now in `gnulib_m4', while Gnulib's .c
	files are located in `lib'.  `gnulib_m4' and `lib' are generated
	and distributed.

	Automake:
	- Removed Makefiles from the old build system.
	- Converted Makefile.in into Makefile.am.
	- Converted Makefile.sub files in all directories to a .am file.
	- Removed configure, src/include/config.hin (now generated).
	- Removed various helper scripts (config.guess, config.rpath...),
	now installed by bootstrap in `build-aux'.
	- Moved aclocal.m4 to acinclude.m4 (aclocal.m4 is now generated).
	- Makefile in non-recursive style.
	- Updated INSTALL.REPO (INSTALL is now a symlink to
	gnulib/doc/INSTALL, original INSTALL file moved to INSTALL.extra)
	- Added (empty) THANKS, AUTHORS files.
	- Added a document on the usage of automake in groff in
	doc/automake.pdf.

	Additional features:
	- Out-of-source build is supported.
	- Parallel build is possible (make -j).
	- Automatic targets from Automake: `make dist', `make distcheck'.
	- 'make check' is available for automatic testing, gdiffmk's test
	was plugged to this target.
	- Auto-detect if make has builtin variable `RM'.

2015-01-14  Ingo Schwarze  <schwarze@openbsd.org>

	Fix Savannah bug #43905.

	* src/libs/libgroff/glyphuni.cpp (glyph_to_unicode_list),
	* src/libs/libgroff/uniglyph.cpp (unicode_to_glyph_list): Remove
	double entries for `rk', `lk', `lt', `rt', `rb', and `lb'.

2014-12-16  Werner LEMBERG  <wl@gnu.org>

	Update Unicode-to-Unicode mapping to version 7.0.0.

	* src/libs/libgroff/make-uniuni: Update emitted copyright.

	* src/libs/libgroff/uniuni.cpp: Regenerated.

2014-11-29  Werner LEMBERG  <wl@gnu.org>

	Fix previous commit.

	We forgot to test whether the patch works if compiling from
	scratch...

	Problem reported by Bertrand Garrigues
	<bertrand.garrigues@laposte.net>.

	* src/include/lib.h (interpret_lf_args, normalize_for_lf): Move
	declarations to...
	* src/include/lf.h: This new file.

	* src/libs/libgroff/lf.cpp, src/preproc/pic/pic.h,
	src/preproc/preconv/preconv.cpp, src/preproc/refer/refer.h,
	src/preproc/soelim/soelim.cpp, src/preproc/tbl/table.h: Include
	`lf.h'.
	Make `lib.h' the first included header file.

	* src/preproc/eqn/eqn.h: Don't include `stringclass.h'.
	* src/preproc/eqn/main.cpp: Include `stringclass.h' and `lf.h'.

	* src/roff/groff/groff.cpp: Make `lib.h' the first included header
	file.

2014-11-10  Eli Zaretskii  <eliz@gnu.org>

	Improve native Windows port.

	This patch fixes two issues.

	  . Handle backslashes in `.lf' arguments for MSDOS and Windows.
	  . Fix file name quoting for the groff pipeline.

	* src/preproc/soelim/soelim.cpp (do_file):
	* src/preproc/refer/refer.cpp (do_file):
	* src/preproc/preconv/preconv.cpp (do_file):
	* src/preproc/pic/main.cpp (do_file):
	* src/preproc/eqn/main.cpp (do_file): Call `normalize_for_lf' to
	convert backslashes in the file name being processed to forward
	slashes.

	* src/include/lib.h (normalize_for_lf): Add prototype.

	* src/preproc/eqn/eqn.h:
	* src/preproc/pic/pic.h:
	* src/preproc/refer/refer.h:
	* src/preproc/tbl/table.h: Include stringclass.h before lib.h.

	* src/libs/libgroff/lf.cpp (normalize_for_lf): New function.

	* src/roff/groff/groff.cpp: Include stringclass.h before lib.h.
	(append_arg_to_string) [_WIN32 && !__CYGWIN__]: Use only "..." for
	quoting in native Windows builds.

2014-11-18  Deri James  <deri@chuzzlewit.myzen.co.uk>

	My commit '3fe78135c9fe666dadffde2a822b0535d8db6feb' introduced
	problem in subroutine `TextWid'.  Octal char `\nnn' returns width of
	4 char string rather than width of single character.

	* src/devices/gropdf/gropdf.pl: Change `TextWid' to recognise octal
	escaped characters (\nnn).

2014-11-07  Deri James  <deri@chuzzlewit.myzen.co.uk>

	See bug #43555.

	* src/devices/gropdf/gropdf.pl: Correct Date Format.

2014-11-04  Werner LEMBERG  <wl@gnu.org>

	* src/libs/gnulib/*: Regenerate autotool files.

2014-11-04  Werner LEMBERG  <wl@gnu.org>

Version 1.22.3 released
=======================

	* NEWS, README, doc/webpage.ms: Updated.

	* doc/texinfo.tex: Updated from `texinfo' repository.

2014-10-29  Bertrand Garrigues  <bertrand.garrigues@laposte.net>

	* Makefile.in (OTHERDIRS): Mention `afmtodit' first.

	Otherwise, some fonts in `devpdf' (`U-*') are not built.

2014-10-26  Eli Zaretskii  <eliz@gnu.org>
	    Werner LEMBERG  <wl@gnu.org>

	Add Windows `.cmd' wrapper files.

	* arch/mingw/*: New files, provided by Eli.

	* Makefile.in (make_winscripts, make_install_winscripts,
	make_uninstall_winscripts): New target variables.
	(MDEFINES): Add them.
	(OTHERDIRS): Add `arch/mingw'.

	* m4/groff.m4 (GROFF_CMD_FILES): New macro
	* configure.ac: Call it.
	* configure: Regenerated.

2014-10-23  Bertrand Garrigues  <bertrand.garrigues@laposte.net>

	Fix `install' and `uninstall' issues.

	* contrib/chem/Makefile.sub (install_data): Fix build with option
	--with-doc=no passed to configure (target `install_examples'
	should not be executed).

	* contrib/chem/Makefile.sub (uninstall_sub):  `uninstall' failed
	if directories to be removed were not present.

	* contrib/gpinyin/Makefile.sub (uninstall_sub): Ditto.

	* contrib/hdtbl/Makefile.sub (GENFILES): generated files should
	depend on the creation of the `examples' directory.

2014-10-23  Daiki Ueno  <ueno@gnu.org>

	* m4/iconv.m4: Really avoid false detection of non-working iconv.

2014-10-21  Daiki Ueno  <ueno@gnu.org>

	iconv: avoid false detection of non-working iconv

	The INBUF/OUTBUF arguments of iconv can be either 'const char **'
	or 'char **'.  If CC is g++, the difference causes a compile error
	and thus leads to a false detection of non-working iconv.
	Reported by Eli Zaretskii and Werner LEMBERG in:
	<https://lists.gnu.org/archive/html/bug-gnulib/2014-10/msg00023.html>.

	* m4/iconv.m4 (AM_ICONV_LINK): Try all possible argument types of
	iconv.  Bump serial number.

2014-10-20  Werner LEMBERG  <wl@gnu.org>

	* src/libs/gnulib/lib/wctype.in.h: Include `config.h'.

	Problem reported by Eli Zaretskii <eliz@gnu.org>.

	This is a temporary hack to make groff compile with MinGW.  After
	the switch to an automake infrastructure, together with proper use
	of `gnulib', we can safely replace the patched file with a standard
	version.

2014-10-19  Doug McIlroy  <doug@cs.dartmouth.edu>

	Fix Savannah bug #42151.

	* src/preproc/eqn/lex.cpp (file_input::read_line): Handle CR/LF.
	* src/preproc/pic/pic.cpp (file_input::read_line): Ditto.

2014-10-18  Werner LEMBERG  <wl@gnu.org>

	[mdoc] Add Darwin version string for OS X 10.10.

	* tmac/doc-common (doc-operating-system-Darwin-14.0.0): New string.

	* tmac/groff_mdoc.man: Updated.

2014-10-15  Werner LEMBERG  <wl@gnu.org>

	* doc/webpage.ms: Remove obsolete references to tarballs and diffs.

	Reported by Dave Kemper <saint.snit@gmail.com>.

2014-10-15  Colin Watson  <cjwatson@debian.org>

	Always distribute the parts of groff that require X11.

	* Makefile.in (ALLLIBDIRS): Clone from `LIBDIRS', but include
	src/devices/libxutil unconditionally.
	(ALLPROGDIRS): Clone from `PROGDIRS', but include
	src/devices/xditview and src/utils/xtotroff unconditionally.
	(DISTDIRS): Use `ALLLIBDIRS' and `ALLPROGDIRS' rather than `LIBDIRS'
	and `PROGDIRS'.

2014-10-14  Keith Marshall  <keith.d.marshall@ntlworld.com>

	Minor update to NEWS for pdfroff.

	* NEWS (pdfroff): Note use of PHASE register, and not pdf:href.map,
	to choose when to emit toc_relocation control record.

2014-10-13  Keith Marshall  <keith.d.marshall@ntlworld.com>

	For pdfroff, deduce "--no-toc-relocation" from input stream.

	* NEWS: Add notification; document the effect of changes, as recorded
	in contrib/pdfmark/ChangeLog.

2014-10-12  Ingo Schwarze  <schwarze@openbsd.org>

	[mdoc] Support `Mdocdate' CVS keyword substitution.
	This fixes Savannah bug #42968.

	This feature is used for OpenBSD manuals.

	* tmac/doc-common (Dd): Handle `$Mdocdate:' argument.

	* tmac/groff_mdoc.man: Document it.

2014-10-12  Ingo Schwarze  <schwarze@openbsd.org>

	[mdoc] Add `.At III' and `.St -iso8601'.
	This fixes Savannah bug #42971.

	* tmac/doc-syms: Add corresponding version strings.

	* tmac/groff_mdoc.man: Synchronize.

2014-10-12  Ingo Schwarze  <schwarze@openbsd.org>

	[mdoc] Update operating system release numbers.
	This fixes Savannah bug #42969.

	* tmac/doc-common: Update NetBSD, OpenBSD, FreeBSD, and DragonFly
	version strings.

	* tmac/groff_mdoc.man: Synchronize.

2014-10-12  Werner LEMBERG  <wl@gnu.org>

	* doc/Makefile.in: Use `LC_ALL' in addition to `LANG'.
	Suggested by Steffen.

2014-10-12  Werner LEMBERG  <wl@gnu.org>

	* doc/groff.texinfo: Make PDF version compilable with makeinfo 5.x.

	makeinfo 5.x handles macro expansion better, which changes the way
	how an \LE macro (for a less-than sign) has to be defined.  However,
	since we can't be sure that the latest version of `texinfo.tex' gets
	used with makeinfo 5.x only, we would have to support both 4.x and
	5.x.  No idea whether this is possible at all...  For this reason,
	we now simply use @value directly instead of wrapping it into a
	macro, avoiding any issues.

2014-10-12  Werner LEMBERG  <wl@gnu.org>

	[doc] Protect against picky `sed' programs.
	Problem reported by Axel Kielhorn <tex@axelkielhorn.de>.

	* doc/Makefile.in (GROFF_BIN_PATH, GROFF): Add `LANG=' to avoid
	interpretation of non-ASCII characters by sed.

2014-10-12  Michail Vidiassov  <master@iaas.msu.ru>

	* tmac/doc-common: Add new Darwin versions.

2014-10-12  Werner LEMBERG  <wl@gnu.org>

	* doc/groff.texinfo: s/which/that/ where apropriate.

2014-10-12  Werner LEMBERG  <wl@gnu.org>

	* doc/groff.texinfo: Various minor fixes.

	Most of those glitches have been found by comparing the info output
	from makeinfo 4.13 and the current SVN development version (of
	makeinfo).

2014-10-12  Werner LEMBERG  <wl@gnu.org>

	* doc/groff.texinfo: Improve indexing.

	Change @DefXXXItem and @DefXXXListEnd macros to not insert an index
	entry.  New macro variants with a trailing `x' (like `@DefreqItemx')
	can override this.

	Update macro calls where necessary.

2014-10-12  Werner LEMBERG  <wl@gnu.org>

	[doc] Improve call to generation of `groff.pdf'.
	Problem reported by Axel Kielhorn <tex@axelkielhorn.de>.

	Since `groff.texinfo' contains latin-1 characters, some sed
	implementations (like the one used on Mac OS 10.8) fail if called
	with the wrong locale.  Basically, this is a `texi2dvi' bug, but we
	can set `LANG' by ourselves to improve the situation.

	* doc/Makefile.in (.texinfo.dvi, .texinfo.pdf): Set `LANG'
	environment variable to empty string.

2014-10-12  Werner LEMBERG  <wl@gnu.org>

	[doc] Correctly handle `MAKEINFO' environment variable.
	Bug introduced in commit from 2014-03-29.

	* m4/groff.m4 (GROFF_MAKEINFO): Don't set MAKEINFO to empty string
	before actually testing it.

	* configure: Regenerated.

2014-10-11  Bertrand Garrigues  <bertrand.garrigues@laposte.net>

	Fix an issue on `make dist'.

	In order to make the tarball, `make dist' copies src/libs/gnulib
	directories into the `tmp' directory without the `.deps'
	directories, causing the failure of `make distclean' in
	tmp/src/libs/gnulib.  Forcing a call to `config.status' recreates
	the `.deps' directories.

	* Makefile.in (dist): For gnulib, call `config.status' before `make
	distclean'.

2014-10-11  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/*.pl: Remove call from `IPC', use normal system
	`instead'.

2014-10-11  Guillem Jover  <guillem@hadrons.org>

	Add support for various BSD versions.

	* tmac/doc-common: Add new FreeBSD and DragonFly versions.

2014-10-11  Keith Marshall  <keith.d.marshall@ntlworld.com>

	Refactor .psbb request handling code.

	* src/roff/troff/input.cpp (do_ps_file): Reimplement it, using...
	(psbb_locator): ...this new locally declared and implemented class;
	its constructor replaces all `do_ps_file()' capability, delegating
	to other class methods, as appropriate.
	(assign_registers): Encapsulate it, as a `psbb_locator' method.
	(ps_get_line): Likewise, also renaming it to become...
	(get_line): ...this class method; its internally defined `lastc'
	static variable also becomes a non-static class member variable.
	(PSBB_RANGE_IS_BAD, PSBB_RANGE_IS_SET, PSBB_RANGE_AT_END): New
	manifest constants; define them.  They are now used by...
	(parse_bounding_box): ...this function, now also encapsulated as
	a `psbb_locator' class method, to convey parsing status.
	(bounding_box): Struct obsoleted by `psbb_locator'; delete it.
	(ps_bbox_request): Delegate to `psbb_locator'.

2014-10-11  Werner LEMBERG  <wl@gnu.org>

	Various clean-ups.

	* NEWS: More updates.

	* REVISION: Set to 3.

	* doc/groff.texinfo: Update version and year.

	* configure: Regenerated.

	* src/roff/groff/groff.cpp (main) <'v'>: Update copyright year.

2014-10-11  Werner LEMBERG  <wl@gnu.org>

	Update generic GNU files to recent versions.

	* INSTALL.gen, config.guess, config.rpath, config.sub,
	contrib/groff_filenames/Makefile.sub, doc/fdl.texi, doc/texinfo.tex,
	doc/txi-en.tex, install-sh, m4/ax_prog_perl_version.m4,
	m4/codeset.m4, m4/fcntl-o.m4, m4/glibc21.m4, m4/iconv.m4,
	m4/lib-ld.m4, m4/lib-link.m4, m4/lib-prefix.m4, m4/localcharset.m4,
	src/include/localcharset.h, src/libs/gnulib/Makefile.in,
	src/libs/gnulib/aclocal.m4, src/libs/gnulib/build-aux/compile,
	src/libs/gnulib/build-aux/config.guess,
	src/libs/gnulib/build-aux/config.sub,
	src/libs/gnulib/build-aux/depcomp,
	src/libs/gnulib/build-aux/install-sh,
	src/libs/gnulib/build-aux/snippet/arg-nonnull.h,
	src/libs/gnulib/build-aux/snippet/c++defs.h,
	src/libs/gnulib/build-aux/snippet/warn-on-use.h,
	src/libs/gnulib/configure, src/libs/gnulib/lib/Makefile.in,
	src/libs/gnulib/lib/config.charset, src/libs/gnulib/lib/intprops.h,
	src/libs/gnulib/lib/localcharset.c,
	src/libs/gnulib/lib/localcharset.h, src/libs/gnulib/lib/ref-add.sin,
	src/libs/gnulib/lib/ref-del.sin, src/libs/gnulib/lib/stdbool.in.h,
	src/libs/gnulib/lib/stddef.in.h, src/libs/gnulib/lib/streq.h,
	src/libs/gnulib/lib/unitypes.in.h,
	src/libs/gnulib/lib/uniwidth.in.h,
	src/libs/gnulib/lib/uniwidth/cjk.h,
	src/libs/gnulib/lib/uniwidth/width.c, src/libs/gnulib/lib/verify.h,
	src/libs/gnulib/lib/wchar.in.h, src/libs/gnulib/lib/wctype-h.c,
	src/libs/gnulib/lib/wctype.in.h, src/libs/gnulib/lib/wcwidth.c,
	src/libs/gnulib/m4/00gnulib.m4, src/libs/gnulib/m4/Makefile.in,
	src/libs/gnulib/m4/codeset.m4, src/libs/gnulib/m4/configmake.m4,
	src/libs/gnulib/m4/extensions.m4, src/libs/gnulib/m4/fcntl-o.m4,
	src/libs/gnulib/m4/glibc21.m4, src/libs/gnulib/m4/gnulib-tool.m4,
	src/libs/gnulib/m4/inttypes-pri.m4,
	src/libs/gnulib/m4/localcharset.m4, src/libs/gnulib/m4/longlong.m4,
	src/libs/gnulib/m4/onceonly.m4, src/libs/gnulib/m4/wchar_t.m4,
	src/libs/gnulib/m4/wint_t.m4, src/libs/libgroff/config.charset,
	src/libs/libgroff/localcharset.c, src/libs/libgroff/ref-add.sin,
	src/libs/libgroff/ref-del.sin, src/preproc/refer/refer.man: Do it.

2014-10-11  Werner LEMBERG  <wl@gnu.org>

	* NEWS, MANIFEST: Updated.

2014-10-11  Werner LEMBERG  <wl@gnu.org>

	* Makefile.in (OTHERDIRS, NOMAKEDIRS): Remove `ideal' references.

2014-10-10  Bernd Warken  <groff-bernd.warken-72@web.de>

	* contrib/gideal: Temporarily remove this directory, because the
	documentation and the preprocessor are not yet finished for
	groff-1.2.23.

2014-10-10  Werner LEMBERG  <wl@gnu.org>

	* Makefile.in (dist): Clean up `src/libs/gnulib'.

2014-10-10  Werner LEMBERG  <wl@gnu.org>

	* doc/webpage.ms: Updates.

	The README and NEWS sections are not yet synchronized, though.

2014-10-09  Ingo Schwarze  <schwarze@openbsd.org>

	* Makefile.in: Let `clean' and `distclean' descend into gnulib.

	This fixes Savannah bug #42970.

2014-10-02  Bertrand Garrigues  <bertrand.garrigues@laposte.net>

	Set default X11 resources dir to `$prefix/lib/X11/app-defaults'.

	Previously, X11 resources for gxditview were installed in
	`/usr/X11/lib/X11/app-defaults', no matter which prefix was set.

	Now, gxditview resources are installed in
	`appresdir=$prefix/lib/X11/app-defaults'.  If `appresdir' is not a
	standard X11 resource directory, the environment variable
	`XFILESEARCHPATH' should be set to this path.

	The behaviour of `--with-appresdir' is unchanged: This option can
	still be used to set `appresdir', and its value will not be modified
	by the prefix.

	* m4/groff.m4 (GROFF_APPRESDIR_DEFAULT): Implement new behaviour.
	Fix detection app-defaults location on the system.
	(GROFF_APPRESDIR_CHECK): Updated.

	* configure.ac: Improve output of configuration.
	* configure: Regenerated.

	* NEWS: Mention it.

2014-09-27  Werner LEMBERG  <wl@gnu.org>

	Set `transparent' flag for `\[cq].
	Problem reported by Dave Kemper <saint.snit@gmail.com>.

	* src/roff/troff/input.cpp (init_charset_table): Do it.

	* doc/groff.texinfo (Sentences, Using Symbols), man/groff_diff.man:
	Document it.

2014-09-25  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/*.pl: Program more reasonable subs (functions).
	Repair details in many places.

2014-09-24  Keith Marshall  <keith.d.marshall@ntlworld.com>

	Refactor psbb line input function; avoid a buffer overrun.

	* src/roff/troff/input.cpp (ps_get_line): Declare it as `static'.
	Refactor, to avoid the overhead of character look-ahead and push-back
	on CR stream input.  Add new `dscopt' parameter, in place of internal
	`err' variable; update all call references, passing value of...
	(DSC_LINE_MAX_ENFORCE): ...this new manifest constant; define it.
	(DSC_LINE_MAX_IGNORED): Likewise; currently unused, but intended for
	future use as an alternative to `DSC_LINE_MAX_ENFORCE'.
	(DSC_LINE_MAX_CHECKED): New manifest constant; used internally only.
	(PS_LINE_MAX): Manifest constant, renamed for notional consistency...
	(DSC_LINE_MAX): ...to this; defined value remains as 255.
	(do_ps_file): Increase stack allocation for `buf' char array; former
	allocation of PS_LINE_MAX (now DSC_LINE_MAX) bytes exposed a potential
	buffer overrun, after reading DSC_LINE_MAX bytes; two additional bytes
	are required, to accommodate a terminating LF and NUL.  Add `dscopt'
	parameter, with value `DSC_LINE_MAX_ENFORCE', in each of three calls
	to `ps_get_line()'.

2014-09-20  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/groff/Makefile.sub: Remove too much deleting while
	running `make'.

2014-09-20  Bernd Warken  <groff-bernd.warken-72@web.de>

	* `Makefile.sub' in the whole groff source tree: Add $(RM) and
	change all `rm -f'.  Add directory test before `rmdir'.

2014-09-20  Bernd Warken  <groff-bernd.warken-72@web.de>

	* Man-pages (*.man) in the whole groff source tree: Improve
	documents by adding \[co], \[cq], \[aq] instead of ` or ' and use
	also \[co] as long as it makes sense.  Remove \[en] in the years
	date in order to allow the automatic license year increasing.

2014-09-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* <groff-source-top>/*: Improve the license information and Emacs
	setup.

2014-09-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* tmac/*: Improve the license information and Emacs setup.

2014-09-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/utils/xtotroff/*: Improve the license information and Emacs
	setup.

2014-09-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/utils/tfmtodit/*: Improve the license information and Emacs
	setup.

2014-09-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/utils/pfbtops/*: Improve the license information and Emacs
	setup.

2014-09-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/utils/lookbib/*: Improve the license information and Emacs
	setup.

2014-09-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/utils/lkbib/*: Improve the license information and Emacs
	setup.

2014-09-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/utils/indxbib/*: Improve the license information and Emacs
	setup.

2014-09-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/utils/hpftodit/*: Improve the license information and Emacs
	setup.

2014-09-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/utils/afmtodit/*: Improve the license information and Emacs
	setup.

2014-09-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/utils/addftinfo/*: Improve the license information and Emacs
	setup.

2014-09-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/troff/*: Improve the license information and Emacs
	setup.

2014-09-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/nroff/*: Improve the license information and Emacs
	setup.

2014-09-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/*: Improve the license information and Emacs
	setup.

2014-09-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/groff/*: Improve the license information and Emacs
	setup.

2014-09-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/preproc/tbl/*: Improve the license information and Emacs
	setup.

2014-09-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/preproc/soelim/*: Improve the license information and Emacs
	setup.

2014-09-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/preproc/refer/*: Improve the license information and Emacs
	setup.

2014-09-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/preproc/preconv/*: Improve the license information and Emacs
	setup.

2014-09-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/preproc/pic/*: Improve the license information and Emacs
	setup.

2014-09-17  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/preproc/html/*: Improve the license information and Emacs
	setup.

2014-09-17  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/preproc/grn/*: Improve the license information and Emacs
	setup.

2014-09-17  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/preproc/eqn/*: Improve the license information and Emacs
	setup.

2014-09-17  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/libs/libxutil/*: Improve the license information and Emacs
	setup.

2014-09-17  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/libs/libgroff/*: Improve the license information and Emacs
	setup.

2014-09-17  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/libs/libdriver/*: Improve the license information and Emacs
	setup.

2014-09-17  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/libs/libbib/*: Improve the license information and Emacs
	setup.

2014-09-17  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/libs/gnulib/*: Improve the license information and Emacs
	setup.  The former run of that was not yet complete.

2014-09-17  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/libs/gnulib/*: Improve the license information and Emacs
	setup.

2014-09-17  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/include/*: Improve the license information and Emacs setup.

2014-09-17  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/devices/grotty/*: Improve the license information and Emacs
	setup.

2014-09-17  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/devices/grops/*: Improve the license information and Emacs
	setup.

2014-09-17  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/devices/gropdf/*: Improve the license information and Emacs
	setup.

2014-09-17  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/devices/grolj4/*: Improve the license information and Emacs
	setup.

2014-09-17  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/devices/grolbp/*: Improve the license information and Emacs
	setup.

2014-09-17  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/devices/grohtml/*: Improve the license information and Emacs
	setup.

2014-09-17  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/devices/grodvi/*: Improve the license information and Emacs
	setup.

2014-09-15  Bernd Warken  <groff-bernd.warken-72@web.de>

	* man/*.man: Improve the license information (definiton of .co and
	.au).

2014-09-15  Bernd Warken  <groff-bernd.warken-72@web.de>

	* m4/*.m4: Improve the license information without changing the
	related information.

2014-09-06  Werner LEMBERG  <wl@gnu.org>

	Fix build issues.

	* m4/groff.m4: Fix typo.
	s/refer_dir/referdir/ for consistency.

	* configure: Regenerated.

	* Makefile.in: s/refer_dir/referdir/ for consistency.

	* src/preproc/refer/Makefile.sub (install_data, uninstall_sub):
	Don't handle binaries or manpages; this is handled elsewhere
	already.  Right now, only install and uninstall the `refer' data
	directory.

2014-09-04  Bernd Warken  <groff-bernd.warken-72@web.de>

	* configure: When I change the `configure' file manually, the
	refer data dir is created.  But when running aclocal/autoreconf,
	the dir is again not created.

2014-09-04  Bernd Warken  <groff-bernd.warken-72@web.de>

	* m4/groff.m4, configure.ac, Makefile.in,
	src/preproc/refer/Makefile.sub: Add information to create a refer
	data directory by installing.  That dir is not yet generated
	anyway.

2014-09-05  Werner LEMBERG  <wl@gnu.org>

	Regenerate configure files with correct parameters.

	* configure.ac: Comment out m4 macros still missing.

	* aclocal.m4, config.hin, configure: Regenerated.

2014-09-04  Bernd Warken  <groff-bernd.warken-72@web.de>

	* some files in doc: Change the copying years to package form.
	But many files have strange or no copying information.

2014-09-04  Bernd Warken  <groff-bernd.warken-72@web.de>

	* contrib/pic2graph/Makefile.sub: Change the copying years to
	package form.

2014-09-04  Bernd Warken  <groff-bernd.warken-72@web.de>

	* FDL: Replace the changed actual file by the original `fdl.txt'
	from <http://www.gnu.org/licenses/>.

2014-09-03  Bernd Warken  <groff-bernd.warken-72@web.de>

	* contrib/grap2graph/Makefile.sub: Remove `Last updates' from all
	files.  Add and repair copyright.  Write Emacs setup.

2014-09-03  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/preproc/refer/refer.man: Include more distances for better
	reading of the source file.  Add `%' for documentation of
	bibliographic database lines.

2014-09-03  Bernd Warken  <groff-bernd.warken-72@web.de>

	* tree contrib/eqn2graph: Remove `Last updates' from all files.
	Add and repair copyright.  Write Emacs setup.

2014-09-03  Bernd Warken  <groff-bernd.warken-72@web.de>

	* tree `arch': Remove `Last updates' from all files.  Add
	and repair copyright.  Write Emacs seetup.

2014-09-03  Bernd Warken  <groff-bernd.warken-72@web.de>

	* <groff top source directory>: Remove `Last updates' from all
	files.  Only `timestamp' values are left.

2014-09-03  Bernd Warken  <groff-bernd.warken-72@web.de>

	* <groff top source directory>: Repair copyright years from
	starting year to actual year for almost all files.

2014-09-03  Bernd Warken  <groff-bernd.warken-72@web.de>

	* autom4te.cache: Remove that tree after running
	`autoconf' or `autoreconf'.

	* .gitignore: Add all files within `autom4te.cache' to get rid of
	them automatically.  Not sure so far, if this works.

2014-09-03  Bernd Warken  <groff-bernd.warken-72@web.de>

	* BUG-REPORT, FDL, INSTALL*, MANIFEST, MORE.STUFF, NEWS, PROBLEMS,
	PROJECTS, README*: Remove Emacs settings for coding style.  Change
	copyright years from 1989-2014 and 1993-2014 into 2014 only.

2014-09-03  Bernd Warken  <groff-bernd.warken-72@web.de>

	* configure.ac, Makefile.in: Try to use /usr/local/share directory
	for `refer'.  Does not work so far.

2014-09-02  Bernd Warken  <groff-bernd.warken-72@web.de>

	* All Makefile*: Add Emacs settings and lacking licenses.

2014-09-02  Bernd Warken  <groff-bernd.warken-72@web.de>

	* BUG-REPORT, FDL, INSTALL*, MANIFEST, MORE.STUFF, NEWS, PROBLEMS,
	PROJECTS, README*: Add Emacs settings.

2014-09-02  Bernd Warken  <groff-bernd.warken-72@web.de>

	* PROJECTS: Add TODO for `refer'.

2014-08-31  Bernd Warken  <groff-bernd.warken-72@web.de>

	* man/roff.man (roff.7): Replace Heirloom links to more actual
	places.  Create macro definitions for authors (.au) and copying
	(.co).

2014-08-30  Bernd Warken  <groff-bernd.warken-72@web.de>

	* man/groff_font.man (groff_font.7): Restructure
	file format, but keep content.

2014-08-30  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/utils/addftinfo/addftinfo.man (addftinfo.1): Restructure
	file format, but keep content.

2014-08-30  Bernd Warken  <groff-bernd.warken-72@web.de>

	* man/roff.man (roff.7): Repair documentation of heirloom.

2014-08-28  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/grog.pl, src/roff/grog/subs.pl: Add `gpinyin'.

	* src/roff/grog/grog.man: Restructure `SEE ALSO'.

2014-08-28  Bernd Warken  <groff-bernd.warken-72@web.de>

	* contrib/gpinyin: Make it runnable, version 1.0.0.

2014-08-20  Bernd Warken  <groff-bernd.warken-72@web.de>

	* groff.7 (man/groff.man): Add further preprocessor regions.
	Repair documentation for Unicode.

2014-08-08  Bernd Warken  <groff-bernd.warken-72@web.de>

	* configure.ac, configure, Makefile.in, m4/groff.m4: Install paths
	for implementing contrib/gpinyin's sub.pl.

2014-08-06  Bernd Warken  <groff-bernd.warken-72@web.de>

	* man/groff_char.man: Add description for displaying `uxxxx' as
	`\[uxxxx]'.

2014-08-05  Bernd Warken  <groff-bernd.warken-72@web.de>

	* man/groff.man (groff.7): Replace \[rs] to \e as far as useful.

2014-08-05  Bernd Warken  <groff-bernd.warken-72@web.de>

	* man/groff.man (groff.7): Add documentation for the Unicode
	escapes \[u....] and \[u.....].

2014-08-02  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/groff/groff.man: Improve documentation for `utf8'.

2014-08-01  Bernd Warken  <groff-bernd.warken-72@web.de>

	* contrib/gpinyin: New preprocessor for having the European-style
	writing	`pinyin' for the Chinese language.

2014-07-22  Bernd Warken  <groff-bernd.warken-72@web.de>

	* groff.7 (man/groff.man): Add some useful special characters.

2014-07-21  Bernd Warken  <groff-bernd.warken-72@web.de>

	* tbl.1 (src/preproc/tbl/tbl.man): Add simple examples.

2014-07-12  Bernd Warken  <groff-bernd.warken-72@web.de>

	* groff.7 (man/groff.man): Add section about underlining.

2014-07-07  Bernd Warken  <groff-bernd.warken-72@web.de>

	* man/groff.man (groff.7): Add some basic special characters
	`\(xy'.

2014-07-06  Bernd Warken  <groff-bernd.warken-72@web.de>

	* grog, groffer: Minor repairing.

2014-07-06  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/subs.pl: Repair ligatures handling.

2014-07-06  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/subs.pl: Correct handling of standard input.

2014-07-06  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/groff/groff.man: Minor correction.

2014-07-06  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/*: Minor corrections.

2014-07-05  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/groff/groff.cpp: In `usage()' and `help()' order
	alphabetically.

2014-07-05  Bernd Warken  <groff-bernd.warken-72@web.de>

	* grog.pl, subs.pl: Heavily improve argument handling and `groff'
	command line creation.

2014-07-05  Bernd Warken  <groff-bernd.warken-72@web.de>

	* grog.man: Make file runnable for `doclifter'.

2014-07-05  Bernd Warken  <groff-bernd.warken-72@web.de>

	* grog.man: Replace all .de by copying.  Restrict all .char names
	to lenght 2 only.

2014-07-04  Bernd Warken  <groff-bernd.warken-72@web.de>

	* grog.man: Minor optimization.

2014-07-04  Bernd Warken  <groff-bernd.warken-72@web.de>

	* grog.man: Transform in classical man-page style.

2014-07-04  Bernd Warken  <groff-bernd.warken-72@web.de>

	* grog.pl, subs.pl: Add option `--warnings'.  Rename
	`--with_ligatures' to `--ligatures', but keep `--with_ligatures'
	for compatibility.

2014-07-03  Bernd Warken  <groff-bernd.warken-72@web.de>

	* Makefile.in: Remove directories `groffer/perl' and
	`groffer.shell', which don't exist any more.

2014-07-03  Bernd Warken  <groff-bernd.warken-72@web.de>

	* PROJECTS: Mention the start of the `ideal' project.

2014-06-21  Ingo Schwarze  <schwarze@openbsd.org>

	* Makefile.in: Unbreak make install:
	Add missing gideal dirs to the dist tarball.

2014-06-19  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/groff/groff.man: Correct the collection of the
	installation directories.

2014-06-19  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/groff/groff.man: Add the installation file and
	directory positions of the whole package with @...@.

2014-06-19  Bernd Warken  <groff-bernd.warken-72@web.de>

	* man/groff.man, src/roff/groff/groff.man: Add file position
	before and after installation and the latest update.

2014-06-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/grog.pl: Corrections about `require' and `our'
	definitions.

	* src/roff/grog/subs.pl: In the `groff' output command line, split
	the single character options collections into different
	1-character options, each with a leading minus `-'..
2014-06-20  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/subs.pl: Repair call of `push'.

2014-06-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/subs.pl: Minor correction at `do_first_line'.

2014-06-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/subs.pl: Adjust for first lines with non-preproc
	and not-tmac names to be ignored.

2014-06-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/grog.pl, src/roff/grog/subs.pl: Add new first line
	of roff files with the names of the needed preprocessors and the
	actual tmac, see 2014-06-17 Ulrich Lauther.  Replace the
	word `ideal' by `gideal', when the preprocessor is meant.

2014-06-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/Makefile.sub: Add $(RM).

	* src/roff/grog/grog.pl: Remove call to perl_test.pl.  `require
	5.6;' is enough as Perl test.

	* src/roff/grog/perl_test.pl: Remove this file.

2014-06-18  Bernd Warken  <groff-bernd.warken-72@web.de>

	* ChangeLog: Add Emacs-mode and a separator for the license.

2014-06-17  Ulrich Lauther  <ulrich.lauther@t-online.de>

	* grog: Invent new first comment line of roff files with long
	names of needed preprocessors and the tmac.

2014-06-17  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/subs.pl: Correct handling of option `-J' for
	ideal.

2014-06-17  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/groff/groff.cpp, src/roff/groff/pipeline.h,
	* src/roff/grog/subs.pl: Add `groff' option `-J' for `gideal'.

2014-06-16  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/subs.pl: Remove too early listing of 3 `groff'
	preprocessors options: gideal, glilypond, gperl.

2014-06-16  Bernd Warken  <groff-bernd.warken-72@web.de>

	* contrib/gideal: New project for installing `ideal' for `groff'.

	* Makefile.in: Add `gideal' for `OTHERDIRS'.

2014-06-15  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/grog.pl, src/roff/grog/subs.pl: Repair argument
	handling for output `groff' line.

2014-06-15  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/grog.pl, src/roff/grog/grog.man: Correct and add
	the documentation for filespec options.

2014-06-14  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/subs.pl: Activate handling of `--run', such that
	now the generated `groff' command line can run.

2014-06-14  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/subs.pl: Repair handling of filespec arguments.

2014-06-12  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/grog.pl, src/roff/grog/subs.pl: Add testing
	methods of Ralph Corderoy's `grog.sh' of 2006.  Add primary usage
	of file name extensions.

2014-06-10  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/grog.pl: Totally rewrite the `grog' version,
	starting at the last stable version.  Write many parts as `sub'
	functions.

	* src/roff/grog/subs.pl: New file by splitting the src file
	`grog.pl', such that all functions get into the new file
	`subs.pl'.

	* src/roff/grog/Makefile.sub: Add file `subs.pl', which goes into
	the `grog' libdir.

2014-06-03  James Cloos  <cloos@jhcloos.com>

	* src/roff/grog/grog.pl: The errors with `ligatures' come also
	from `TeX GYRE' fonts.  Print this information, when `grog' should
	work with the `pdf' device.

2014-06-02  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/grog.pl: The `grog' version of yesterday has many
	bugs.  So reinstall an old version of `grog'.

2014-06-01  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/Makefile.sub: Remove changing of first line
	`#! ...'.

2014-06-01  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/grog.pl: Remove `$Sp' mostly.  Reorder script.
	Check and repair requests.  Add final character `$' to many
	checked requests.

2014-06-01  Bernd Warken  <groff-bernd.warken-72@web.de>

	* man/roff.man: Move .TH at the beginning.

2014-05-29  Bernd Warken  <groff-bernd.warken-72@web.de>

	* man/groff.man: In special characters, add the mentioning of the
	`groff' writing `\[xy]'.

2014-05-27  Bernd Warken  <groff-bernd.warken-72@web.de>

	* man/groff_char.man: Finish notes in all tables.

2014-05-26  Bernd Warken  <groff-bernd.warken-72@web.de>

	* man/groff_char.man: Add notes in some tables, more will come.

2014-05-26  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/grog.pl: Add further first line characters for
	single character `groff' options.

	* src/roff/grog/grog.man: make generated options more readable.

2014-05-26  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/grog.pl: Add detection of `.\" [eprt]' as first
	line to `grog'.  Change usage of `$Sp' to reasonable efforts in
	`groff'.

	* src/roff/grog/grog.man, man/groff_char.man: Add website for
	license text, not only the postal address.

2014-04-03  Steffen Nurpmeso  <sdaoden@yandex.com>

	* */Makefile.*: Path quoting fixes, whitespace, formatting.

	Remove many quotes (and introduce a few as additional guards)
	since groff's build system is generally not set up to properly
	handle paths that need quoting.

2014-04-03  Steffen Nurpmeso  <sdaoden@yandex.com>

	* Makefile.comm (extraclean): Don't delete `old'.

	The rule calling `rm -f' was originally thought to remove private,
	temporary files.  However, we now have a subdirectory called `old'
	in `fonts/devps' that may not be removed, and trying so now causes
	an error because we no longer ignore the returned error code of
	`rm'.

2014-04-03  Steffen Nurpmeso  <sdaoden@yandex.com>

	* Makefile.in (OTHERDIRS): Fix directory order.

	This has been accidentally broken in commit 51476bee from
	2014-02-25.

2014-04-03  Steffen Nurpmeso  <sdaoden@yandex.com>

	* src/devices/gropdf/pdfmom.pl: Fix perl(1) warning.

2014-03-30  Werner LEMBERG  <wl@gnu.org>

	* configure: Regenerated.

2014-03-30  Steffen Nurpmeso  <sdaoden@yandex.com>

	* */Makefile.*: Put straight error-prevention prefixes for `rm'.

2014-03-30  Steffen Nurpmeso  <sdaoden@yandex.com>

	`uninstall' target: Avoid spurious and misleading error messages.

	* Makefile.comm (uninstall_dev): Improve.

	* font/devpdf/Makefile.sub (install_data): Remove superfluous `rm'.
	(uninstall_sub): Improve.

	* src/roff/groff/Makefile.sub (uninstall_sub): Fix.

2014-03-30  Steffen Nurpmeso  <sdaoden@yandex.com>

	Fixes for `uninstall' target.

	* Makefile.in (uninstall_dirs): Use `DESTDIR'.

	* src/libs/libgroff/Makefile.sub (uninstall_charset_data): Typo.

	* src/roff/groff/Makefile.sub (uninstall_sub): Typo.

	* src/roff/grog/Makefile.sub (uninstall_sub): Minor.

2014-03-30  Steffen Nurpmeso  <sdaoden@yandex.com>

	* src/roff/grog/Makefile.sub (install_data): Typo.

2014-03-29  Steffen Nurpmeso  <sdaoden@yandex.com>

	Add fine-tuning of doc generation to `configure'.

	* m4/groff.m4 (GROFF_DOC_CHECK): New macro, handling option
	`--with-doc' and its new arguments.  It sets
	`docadd_{html,info,other,pdf,examples}' and exports
	`make{_,_install_,_uninstall_}{otherdoc,examples}'.
	(GROFF_MAKEINFO): Extended to export
	`make{_,_install_,_uninstall_}infodoc'.
	(GROFF_HTML_PROGRAMS): Extended to export
	`make{_,_install_,_uninstall_}{htmldoc,htmlexamples}'.
	(GROFF_PDFDOC_PROGRAMS): Extended to export
	`make{_,_install_,_uninstall_}{pdfdoc,pdfexamples}'.
	(GROFF_INSTALL_INFO): Guard test with `docadd_info'.

	* configure.ac: Use GROFF_DOC_CHECK.
	* Makefile.in: Updated.

	* doc/Makefile.sub: Handle examples separately, controlled by
	$(make{_,_install_,_uninstall_}examples).

2014-03-27  Bjarni Ingi Gislason  <bjarniig@rhi.hi.is>

	* tmac/www.tmac (TAG): Define register `PN'.

2014-03-27  Bjarni Ingi Gislason  <bjarniig@rhi.hi.is>

	* tmac/an-ext.tmac (EX, EE): Preserve font family.

2014-03-17  Werner LEMBERG  <wl@gnu.org>

	* src/preproc/eqn/box.cpp (set_script_size): Fix minimum test.

	Problem reported by Ted Harding <ted.harding@wlandres.net> in a
	thread starting with

	http://lists.gnu.org/archive/html/groff/2014-03/msg00181.html

2014-03-16  Werner LEMBERG  <wl@gnu.org>

	Fix previous commit.

	Problem reported (with a patch) by Ingo Schwarze
	<schwarze@openbsd.org>.

	* doc/Makefile.sub (groff_bin_dirs): Add `preconv'.

	* doc/Makefile.in (groff_bin_dirs): Add `preconv'.
	(.me.txt): Call preconv.  Use UTF8 as output encoding.
	(.me.ps): Call preconv.

2014-03-14  Werner LEMBERG  <wl@gnu.org>

	[me] Add translation of `meintro.me' to French.

	Contributed by Grgoire Babey <gibux@gmx.ch>.

	* doc/meintro_fr.me: New file.
	* LICENSES, doc/Makefile.sub: Updated.

2014-03-13  Ingo Schwarze  <schwarze@openbsd.org> (tiny change)

	man: Correctly reset margins.

	See

	http://lists.gnu.org/archive/html/groff/2013-11/msg00026.html

	for more.

	* tmac/an-old.tmac (set-an-margin): Whenever (re)setting
	`\n[an-level]' to 1 (which happens when encountering `.TH', `.SH',
	and `.SS') make sure to also (re)set `\n[an-saved-margin1]' and
	`\n[an-saved-prevailing-indent1]' to a sane value such that an
	immediate `.RE' cannot wreak havoc.
	(TH, SH, SS): Updated.

2014-03-11  Ingo Schwarze  <schwarze@openbsd.org> (tiny change)

	* Makefile.in: Do not forget to install gropdf manuals.

	This got broken in 290eaaac6cfc33856cd683838accc72ccf3e5a84:
	src/devices/gropdf was split out of OTHERDIRS into SHPROGDIRS, and
	consequently, Makefile.man was no longer used there.  Note that
	Makefile.dev is *not* needed, even though it's below /devices/.

2014-03-11  Ingo Schwarze  <schwarze@openbsd.org> (tiny change)

	* src/roff/groff/Makefile.sub: POSIX conformance.

	- POSIX says that the meaning of the make(1) `$<' macro shall be
	   unspecified except in inference rules.  Consequently, use `$?'
	   for portability.

	   That's safe because the rules have only one prerequisite and
	   are not `.PHONY', so `$?' will always expand to one item.

	- While here, clean up two instances of superfluous use of cat(1).

2014-03-11  Ingo Schwarze  <schwarze@openbsd.org> (tiny change)

	* Makefile.in (dist): Improve.

	- Bugfix: Do not error out if one of the DISTDIRS
	   contains a subdirectory.
	- Make debugging easier by splitting the huge "cd tmp; ...; ..."
	   command sequence into several independent shell commands,
	   such that one can see which command actually fails.

2014-03-06  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Missing RE escape in grep.

	* src/devices/gropdf/pdfmom.pl: Escape '\' dot in grep RE.

2014-02-26  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/grog.pl: Add detection of `gperl' to `grog'.

2014-02-25  Bernd Warken  <groff-bernd.warken-72@web.de>

	* contrib/gperl: New preprocessor for Perl parts in groff files.

2014-02-15  Ingo Schwarze  <schwarze@openbsd.org>

	* tmac/groff_mdoc.man: Improve the manual page template.

	 - Add the EXIT STATUS section.  It is widely used in at least
	   NetBSD, FreeBSD, OpenBSD, and DragonFly manuals.
	 - Recommend the DIAGNOSTICS section for section 4 manuals.  Such
	   usage is very widespread, in particular for kernel printf
	   messages emitted by device drivers.
	 - Do not recommend the DIAGNOSTICS section for command return
	   values to the shell any longer.  While such usage historically
	   existed, it does not seem common nowadays, and in any case, using
	   the now well-established EXIT STATUS section seems preferable to
	   me.
	 - Mention the possibility to use ERRORS for section 4 manuals.
	   While most section 4 manuals have a DIAGNOSTICS section, only
	   some will need an ERRORS section, but these cases aren't exactly
	   rare, either.  Quite some device driver manuals explain how to
	   use the device using system calls like ioctl(2), open(2), read(2)
	   or write(2), in which case the ERRORS section is the natural
	   place to explain which errno values the driver may set during
	   such system calls.
	 - Mentioning signal handling as a content of the ERRORS section
	   seems redundant, it is already covered by talking about the
	   errno.  The case of errno == EINTR should be handled just like
	   all other errno cases.  For an example showing that there is no
	   need to single out error handling in any way, please look at a
	   typical read(2) manual page.
	 - Mention the CAVEATS section.  It first appeared in the 4.2BSD
	   execve(2) manual in 1983, was already used by several manuals by
	   the time of 4.4BSD-Lite2 in 1995, and is in whidespread use
	   today, not just in BSD base system manuals, but for example in
	   Perl manuals as well.

2014-02-14  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/grog.pl: Add detection of glilypond-parts in groff
	files.  For example `grog example.groff' from the glilypond source
	gets `glilypond example.groff | groff'.

2014-02-12  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/grog.pl: With the former bugfix of 2014-02-12,
	it's now possible to run `grog meref.me' etc., which wasn't
	possible before.  That addition of the macro handling was
	necessary for the automatic for `groffer'.

2014-02-12  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/grog/grog.pl: Add handling of macro definition and fix
	problems with @VERSION@.

2014-02-12  Rich Burridge  <rich.burridge@oracle.com>

	[grn] Prevent crash if more than 50 command line arguments.

	* src/preproc/grn/main.cpp (INIT_FILE_SIZE, FILE_SIZE_INCR): New
	macros.
	(add_file): New function.
	(main): Use it to add file arguments.

2014-01-29  Ulrich Sprlein  <uqs@FreeBSD.org>

	* tmac/doc-common: Add even more DragonFlyBSD releases.

2014-01-28  Ulrich Sprlein  <uqs@FreeBSD.org>

	* tmac/doc-common: Add some new *BSD version strings.

2014-01-06  Bernd Warken  <groff-bernd.warken-72@web.de>

	* man/roff.man: Add information of new archives for RUNOFF and
	roff_classical.

	* Makefile.in: Replace `contrib/RUNOFF' by
	`contrib/groff_filenames'.

2014-01-05  Bernd Warken  <groff-bernd.warken-72@web.de>
	    Werner LEMBERG  <wl@gnu.org>

	* groff/tmac/groff_man.man: Minor typos, formatting, reordering.

2014-01-05  Werner LEMBERG  <wl@gnu.org>

	Revert recent changes to `an-ext.tmac' and `groff_man.man'.

	* groff/tmac/an-ext.tmac (.FONT): Remove.  This doesn't belong into
	this file.

	* groff/tmac/groff_man.man: Reset to state previous to 2014-01-04.
	Useful changes will be re-committed in smaller, logical chunks.

2014-01-05  Bernd Warken  <groff-bernd.warken-72@web.de>

	* groff/tmac/an-ext.tmac: in .FONT change variable name `result'
	to `an_ext_FONT_result'.

2014-01-04  Bernd Warken  <groff-bernd.warken-72@web.de>

	* groff/tmac/an-ext.tmac: add new request .FONT for using
	different font names on a single line.

	* groff/tmac/groff_man.man: put under GPL2, reordered and enhanced.

2014-01-02  Deri James  <deri@chuzzlewit.myzen.co.uk>

	* src/devices/gropdf/gropdf.pl: gropdf use to fail when handling
	output from preconv, now works.

	* src/devices/gropdf/pdfmom.pl: can now be used as a pipeline, and
	improvements made to its switch handling and use with preconv.

	* tmac/pdf.tmac: changes to support preconv.

2014-01-02  Colin Watson  <cjwatson@debian.org>

	* font/devascii/Makefile.sub ($(FONTS)): Convert extended regex
	syntax to basic for sed.
	* font/devcp1047/Makefile.sub ($(FONTS)): Likewise.
	* font/devhtml/Makefile.sub ($(FONTS)): Likewise.
	* font/devlatin1/Makefile.sub ($(FONTS)): Likewise.
	* font/devutf8/Makefile.sub ($(FONTS)): Likewise.

2013-12-23  Bernd Warken  <groff-bernd.warken-72@web.de>

	* groff/src/roff/groff/groff.cpp: add groff option `-G' to the
	documentation in `synopsis()'.

2013-12-06  Mike Frysinger  <vapier@gentoo.org>

	Fix parallel build with gropdf and mom examples.

	The `contrib/mom/examples/' directory uses the helper script from
	`src/devices/gropdf/'.  Currently though, parallel builds might fail
	like so:

	  ...
	  make[2]: Entering directory `.../groff-1.22.2/contrib/mom'
	  <groff command> examples/letter.mom >examples/letter.pdf
	  <groff command> examples/mom-pdf.mom >examples/mom-pdf.pdf
	  /bin/sh: .../groff-1.22.2/src/devices/gropdf/pdfmom: No such file or directory
	  make[2]: *** [examples/letter.pdf] Error 127
	  /bin/sh: .../groff-1.22.2/src/devices/gropdf/pdfmom: No such file or directory
	  make[2]: *** [examples/mom-pdf.pdf] Error 127
	  make[2]: Leaving directory `.../groff-1.22.2/contrib/mom'
	  make[1]: *** [contrib/mom] Error 2
	  ...
	  make[2]: Entering directory `.../groff-1.22.2/src/devices/gropdf'
	  sed -f .../groff-1.22.2/arch/misc/shdeps.sed \
	      -e "s|@VERSION@|1.22.2|" \
	      -e "s|@PERLPATH@|/usr/bin/perl|" ./pdfmom.pl >pdfmom

	The top level makefile tries to account for this in general with
	OTHERDIRS, but looks like `src/devices/gropdf/' was added to this
	variable (which holds `contrib/mom/' too) because gropdf installs a
	shell script, and the other prog vars require it to be a dir of
	things to compile.

	  URL: http://crbug.com/324116
	  URL: https://bugs.gentoo.org/487276

	* Makefile.in (SHPROGDIRS): Declare.
	(PROGDIRS): Add $(SHPROGDIRS).
	(OTHERDIRS): Delete src/devices/gropdf.
	($(SHPROGDIRS):): Add to existing rule.
	($(OTHERDIRS):): Depend on $(SHPROGDIRS).

2013-12-08  Eric S. Raymond  <esr@thyrsus.com>

	Repository fully converted to git.

2013-11-21  Werner LEMBERG  <wl@gnu.org>

	* config.guess, config.sub: Updated from `config' repository.

2013-11-06  Werner LEMBERG  <wl@gnu.org>

	* src/libs/libgroff/tmpname.cpp (gen_tempname): Use O_BINARY.

	Problem reported by Charlie Van Dien <charlie@vandien.com>; see

	  http://lists.gnu.org/archive/html/groff/2013-10/msg00006.html

2013-11-06  Werner LEMBERG  <wl@gnu.org>

	* Makefile.comm (.man.n): Use C locale.

	Problem reported by Petr Man <petr@madnetwork.org>; fix suggested by
	Ralph Corderoy <ralph@inputplus.co.uk>.

2013-07-24  Ingo Schwarze  <schwarze@openbsd.org>

	[mdoc] Implement `.%C'.

	* tmac/doc.tmac, tmac/doc-common: Do it.
	* tmac/groff_mdoc.man: Updated.

2013-07-31  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Fix overprinting issue with Acrobat reader.

	Problem reported by Heinz-Jrgen Oertel <hj.oertel@t-online.de>.

	* src/devices/gropdf/gropdf.pl (do_t, FindChar): Use ascii octal
	notation (i.e., \015) when outputting characters with value < 32.
	This fixes a bug which affected acroread when control-M (cr) was
	embedded in a text string.

2013-07-16  Werner LEMBERG  <wl@gnu.org>

	* tmac/fallbacks.tmac: Make it work in compatibility mode.

	Problem reported by Y T <doarhop@hotmail.com>.

2013-07-16  Werner LEMBERG  <wl@gnu.org>

	* src/roff/grog/Makefile.sub (install_data, uninstall_sub): Typos.

2013-07-16  Werner LEMBERG  <wl@gnu.org>

	* Makefile.in (GREP, MDEFINES): Define and use plain grep.

	Necessary for Bernd's code to extract groff options.

2013-07-16  Ingo Schwarze  <schwarze@openbsd.org>

	* tmac/an-old.tmac (TP): Do not clobber line length after double
	call to `.TP'.

2013-07-02  Colin Watson  <cjwatson@debian.org>

	* doc/groff.texinfo: Fix syntax error in documentation of `\z'.

2013-07-02  Colin Watson  <cjwatson@debian.org>

	* src/devices/grolbp/lbp.cpp (main): Don't write trailer if no
	printer was created.

2013-06-19  Eric S. Raymond  <esr@thyrsus.com>

	* src/utils/lkbib/lbib.man: Move running text out of synopsis.

2013-05-06  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/groff/Makefile.sub: Replace `cpp' by `groff.cpp'.

2013-05-06  Bernd Warken  <groff-bernd.warken-72@web.de>

	* Makefile.in: Add new `contrib' directory `RUNOFF'.

2013-05-01  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/groff/Makefile.sub: Remove all `.PHONY:' lines.

2013-04-30  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/groff/Makefile.sub: Replace `egrep' by `$(GREP)'.
	commands.  Don't use $(CCSRCS) any more.

2013-04-30  Bernd Warken  <groff-bernd.warken-72@web.de>

	* Makefile.in, m4/groff.m4: Add `@libprogramdir@' and
	`$libprogramdir' (usually `/usr/local/lib/groff').  Change
	`$libdir/groff' into $libprogramdir for several `groff' programs.
	Run `autoreconf -I m4'.

	* src/roff/groff/MAkefile.sub: Add $(DESTDIR) and $(srcdir) in
	order to support installation outside of source code.

	* contrib/glilypond/Makefile.sub, contrib/glilypond/glilypond.pl:
	Correct the install directories.

2013-04-29  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/groff/Makefile.sub: Replace some variables by shell
	commands.  Improve the output for the `make' runs.

2013-04-28  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/groff/Makefile.sub: Make this Makefile compatible.

2013-04-28  Bernd Warken  <groff-bernd.warken-72@web.de>
2013-04-28  Werner LEMBERG  <wl@gnu.org>

	* src/roff/groff/Makefile.sub: Use `make' variables to get
	`groff' options from `getopt' in `groff.cpp'.  Create 2 files
	`groff_opts_no_arg.txt' and `groff_opts_with_arg.txt'.

2013-04-26  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/groff/read_groff_options.pl: Remove this file.  It's
	no longer needed.

	* src/roff/groff/Makefile.sub: Get the `groff' options from the
	use of `getopt...' in `groff.cpp' using `$(EGREP)' and `sed'.
	Store this information in a new file `groff_options.txt', which
	is copied to `groff libdir' during the installation.

2013-04-26  Werner LEMBERG  <wl@gnu.org>

	Various minor fixes.

	* INSTALL.gen: Take the newest version from the `gnulib'
	repository.

	* configure: Regenerated.

2013-04-26  Bernd Warken  <groff-bernd.warken-72@web.de>

	* INSTALL.gen: Restore an older version from `2006' in
	`groff-1.21'.

	* FOR-RELEASE: New file which describes how to prepare `groff'
	for a new release.

2013-04-26  Bernd Warken  <groff-bernd.warken-72@web.de>

	* src/roff/groff/read_groff_options.pl: Reads `groff' options
	from `groff.cpp' and writes them into the file `groff_options.info'.

	* src/roff/groff/Makefile.sub: Have the generated file
	`groff_options.info' be installed into the `groff libdir'.

2013-04-16  Bernd Warken  <groff-bernd.warken-72@web.de>

	* INSTALL.gen: Replace this file by the daily `git' version of
	`automake' `INSTALL' file.

	* INSTALL.autotools: Remove file.

	* INSTALL.CVS: New file, moved from `INSTALL.autotools'.

	* m4/ax_prog_perl_version.m4: New file, taken from package
	`autoconf-archive-2013.04.06'.

	* m4/groff.m4: Remove unnecessary blank line.

	* Makefile.in: Add `$(PERLVERSION)'.

	* aclocal.m4: Run `autoreconf -I m4' (this includes
	`aclocal -I m4').  This creates a suitable `aclocal.m4'.  Remove
	generated subdirectory `autom4te.cache'.

	* src/roff/grog/Makefile.sub: Correct `sed' command.  Use `tabs'
	that are needed by `GNU make'.

2013-04-16  Bernd Warken  <groff-bernd.warken-72@web.de>

	* Makefile.sub: Add `m4/ax_compare_version.m4'.

	* aclocal.m4: Run the latest `aclocal -I m4' which generates a
	suitable content in that file.

	* INSTALL.autotools: Information of the usage of `GNU autotools'
	with `groff'.

	* INSTALL.gen: Move `autotool' parts to file `INSTALL.autotools'.

2013-04-15  Bernd Warken  <groff-bernd.warken-72@web.de>

	* m4/groff.m4: Replace tabs by spaces.  Use a double line between
	AC_DEFUNs.

2013-04-15  Bernd Warken  <groff-bernd.warken-72@web.de>

	In the whole `groff' system, rename autoconf variable `$PERLPATH'
	to `$PERL', which has the same content.  But `$PERL' suits to
	`AX_PROG_PERL_VERSION' in m4 macro `GROFF_PERL' in `m4/groff.m4'.

	* src/utils/afmtodit/Makefile.sub,
	* src/devices/gropdf/gropdf.pl,
	* src/devices/gropdf/Makefile.sub,
	* src/devices/gropdf/pdfmom.pl,
	* arch/djgpp/config.site,
	* font/devpdf/Makefile.sub,
	* contrib/mm/Makefile.sub,
	* m4/groff.m4,
	* Makefile.in: Replace `$PERLPATH' by `$PERL'.

	* m4/ax_compare_version.m4: New file, copied from daily version of
	`GNU autoconf-archive'.

	`autoconf' was not yet run, a newer version is needed.

2013-04-15  Bernd Warken  <groff-bernd.warken-72@web.de>

	* README, INSTALL, INSTALL.gen, MANIFEST: Add documentation in the
	top directory about some parts of `autotools' and `glilypond'.

2013-04-15  Bernd Warken  <groff-bernd.warken-72@web.de>

	* configure.ac: Add information of the macro `GROFF_PERL'.

	* Makefile.in: Add definitions of the macro variables and their
	`@...@' counterparts.

	Run `autoreconf -I m4'.

2013-04-15  Bernd Warken  <groff-bernd.warken-72@web.de>
2013-04-15  Werner LEMBERG  <wl@gnu.org>
2013-04-15  Ralph Carderoy  <ralph@inputplus.co.uk>

	Add Perl test to configuration.  During the run of `configure' the
	program is broken with error when there is no `Perl' or the `perl'
	program is too old.

	* m4/groff.m4: Add macro `GROFF_PERL' that tests the availability
	of the `perl' program and tests wether this has a version of at
	most `v5.6.1'.  Define variables $PERL and $PERLPATH for the full
	name of the `perl' program and $PERLVERSION as the lest version.

2013-04-13  Keith Marshall  <keithmarshall@users.sourceforge.net>

	Avoid consideration of autotool cache for CVS inclusion.

	* .cvsignore (autom4te.cache): Add reference.

2013-04-13  Bernd Warken  <groff-bernd.warken-72@web.de>

	* `autotools': During the run of `autoconf' and `autoreconf' a
	subdirectory `autom4te.cache' was created.  I first added this to
	groff CVS and removed it again after an email-discussion.

2013-04-12  Bernd Warken  <groff-bernd.warken-72@web.de>

	* `grog': Remove the shell version of `grog'.  Now there is only
	Perl version.

	* src/roff/grog/perl.sh: Remove this file.

	* src/roff/grog/Makefile.sub: This file handles the removement of
	the shell version.

	* src/roff/grog/perl_test.pl: New file for testing the available
	Perl version in the system to be installed into.  This file will
	be installed into the grog lib-directory.

2013-04-12  Bernd Warken  <groff-bernd.warken-72@web.de>

	* `grog': In the following, the file `grog.pl' will be split.  For
	the coming files, a lib-directory is needed for storage.

	* m4/groff.m4, configure.ac: Add libdir information for `grog'.

	* Makefile.in: Add @grog_dir@.

	Run `autoconf'.

	`grog' has now a lib-directory at `$prefix/lib/groff/grog'.

2013-04-11  Bernd Warken  <groff-bernd.warken-72@web.de>

	* contrib/groffer/: There is a free `git' package containing all
	old `groffer' versions `v0.*' and `v1.*'.  The new versions
	`groffer 2.*' will actually not be included.  This package can be
	got at:

	$ git clone git@github.com:RUNOFF/groffer.git

2013-04-11  Bernd Warken  <groff-bernd.warken-72@web.de>

	* contrib/glilypond/: There is a free `git' package containing all
	old versions of the former name `groff_lilypond v0.*'.  They work
	with `lilypond' parts in `roff' files, but were not installed.
	This package can be got at:

	$ git clone git@github.com:RUNOFF/groff_lilypond.git

	The new versions `glilypond v1.*' are not included there.

2013-04-11  Bernd Warken  <groff-bernd.warken-72@web.de>

	* man/roff.man: For roff(7), add information about the free git
	package RUNOFF.git with documentation about historical RUNOFF and
	the available files written in the classical RUNOFF language..

2013-03-29  Bernd Warken  <groff-bernd.warken-72@web.de>

	Rename `groff_lilypond' to `glilypond'.  So remove the former
	source directory `<groff_src_dir>/contrib/lilypond' and newly
	install `<groff_src_dir>/contrib/glilypond', which now has many
	files.  The new version starts at `v1.0'.

	* m4/groff.m4, configure.ac: Add libdir information for
	`glilypond'.

	* Makefile.in: Add `<groff_src_dir>/contrib/glilypond'.

	Run `autoconf'.

	`glilypond' can now be installed to the system.

2013-03-17  Ingo Schwarze  <schwarze@openbsd.org>

	* font/devpdf/Makefile.sub: Build system fixes.

	(GROFF_FONT_FILES): Avoid installing Makefile.sub.orig when it's
	around.
	(install): Create $(DESTDIR)$(fontsubdir)/util when missing.

2013-03-05  Werner LEMBERG  <wl@gnu.org>

	* doc/groff.texinfo: Improve documentation of `\s'.

	Reported by Jim Avera <james_avera@yahoo.com>.

2013-02-16  Werner LEMBERG  <wl@gnu.org>

	* doc/groff.texinfo: Improve documentation of `.substring'.

	Reported by Jim Avera <james_avera@yahoo.com>.

2013-02-13  Werner LEMBERG  <wl@gnu.org>

	* doc/groff.texinfo: Fix if-else example.

	Reported by Jim Avera <james_avera@yahoo.com>.

2013-02-10  Werner LEMBERG  <wl@gnu.org>

	[grops] Make binary `%%BeginData' work; support `fontset' resource.

	* src/devices/grops/psrm.cpp (resource_table): Add `fontset'.

	(resource_manager::read_resource_arg): Do a case insensitive
	comparison.  The PostScript Reference Manual gives the following
	example for a CFF resource (example 5.7):

	%!PS-Adobe-3.0 Resource-FontSet
	%%DocumentNeedResources: ProcSet (FontSetInit)
	%%Title: (FontSet/CFFRoman27)
	%%Version: 1.000
	%%EndComments
	%%IncludeResource: ProcSet (FontSetInit)
	%%BeginResource: FontSet (CFFRoman27)
	/FontSetInit /ProcSet findresource begin
	%%BeginData: 622532 Binary Bytes
	/CFFRoman27 622503 StartData
	... 622,503 bytes of binary data ...
	%%EndData
	%%EndResource
	%%EOF

	Note the `ProcSet' and `FontSet' keywords.  While the old DSC
	(Document Structure Convention) documentation doesn't cover
	`FontSet' at all (the DSC documentation predates the invention of
	CFF), it describes only `procset' (all letters downcase), and it
	also says that the DSC parser works in a case sensitive manner.

	In other words, `ProcSet' is not valid according to the DSC
	documentation, only `procset' is.  So much about today's validity
	of DSC...  This patch adapts grops's code to the PostScript
	reality.

	(resource_manager::do_begin_data): Fix typo (present since the
	beginning) which prevented correct handling of binary data.

	* src/devices/grops/ps.h (resource_type): Add RESOURCE_FONTSET.

2013-02-10  Bernd Warken  <groff-bernd.warken-72@web.de>

	* contrib/lilypond: New files for adding lilypond parts into groff
	files.

2013-02-07  Werner LEMBERG  <wl@gnu.org>

Version 1.22.2 released
=======================

	* NEWS, REVISION, doc/groff.texinfo, doc/webpage.ms: Updated.

	* configure: Regenerated.

	* doc/texinfo.tex: Updated from `texinfo' repository.

	* src/roff/groff/groff.cpp (main) <'v'>: Update copyright year.

2013-02-07  Werner LEMBERG  <wl@gnu.org>

	* src/libs/gnulib/*: Update `gnulib' files.

2013-02-02  Gilles Espinasse  <g.esp@free.fr>

	[grohtml] Don't ignore return value of `dup'.

	* src/preproc/html/pushback.cpp (pushBackBuffer::pushBackBuffer,
	pushBackBuffer::~pushBackBuffer): Abort if `dup' fails.

2013-01-30  Bernd Warken  <groff-bernd.warken-72@web.de>

	* tmac/groff_man.man: Fix wrong connection for tbl(1).

2013-01-29  Werner LEMBERG  <wl@gnu.org>

	* doc/groff.texinfo: Fix documentation of .LP macro in ms.
	Problem reported by Omari Norman <omari@smileystation.com>.

2013-01-29  Werner LEMBERG  <wl@gnu.org>

	* doc/Makefile.sub (uninstall_sub): Handle `gnu.eps'.

2013-01-29  Werner LEMBERG  <wl@gnu.org>

	Building clean-ups.

	* Makefile.in: Use $(top_srcdir) where appropriate.
	* Makefile.sub (M4MACROS): Add `fcntl-o.m4' and `localcharset.m4'.

	* font/devpdf/Makefile.sub (UTILFILES): Removed, unused.
	(MOSTLYCLEANADD): Add `BuildFoundries'.
	* src/devices/gropdf/Makefile.sub (MOSTLYCLEANADD): Add `pdfmom'.

2013-01-24  Bernd Warken  <groff-bernd.warken-72@web.de>

	* Add a shell command to 'MANIFEST' that displays all man source
	files and their section.

2013-01-22  Bernd Warken  <groff-bernd.warken-72@web.de>

	* Add email address in all files having the name.

2013-01-14  Deri James  <deri@chuzzlewit.myzen.co.uk>

	* src/devices/gropdf/gropdf.pl (do_x, do_p, do_s, Set_LWidth): The
	grops driver defaults to round linecaps and linejoins, gropdf
	incorrectly used butt caps and miter joins.

	(Since the MOM package expects to use butt caps and miter joins
	(emitting the necessary postscript code to change the caps and
	joins), gropdf now parses the same postscript commands.)

	* src/devices/gropdf/gropdf.man: Document the handling of linecaps
	and linejoins.

	* tmac/pdf.tmac (pdfbookmark): Fix bug where the current
	PDFOUTLINE.FOLDLEVEL may not be honoured if warnings of the type

	macro warning: adjusted level n bookmark; should be <= n

	Added copyright and mention debt owed to Keith Marshall for
	original `pdfmark.tmac', upon which `pdf.tmac' is largely based.

	* font/devpdf/Foundry.in, font/devpdf/util/BuildFoundries.pl
	(LocateFile): The font for EURO had the wrong entry in the
	`download' file (it pointed to The font in the build directory,
	which is wrong).  It has always been permissable to include a path
	along with the font name in the Foundry file, but until now the
	font had to exist to be valid.  It is now permitted to start the
	path with an asterisk which tells BuildFoundry to use the
	path/filename in the download file without checking if the font
	exists.  This allows the font to be found in `../devps' even
	though it is not there during the build (if source and build are
	different), but will be there after the install.

2013-01-13  Werner LEMBERG  <wl@gnu.org>

	[eqn] Fix display of matrices in nroff output.

	Problem reported by Andy Spencer <andy753421@gmail.com>.

	* src/preproc/eqn/pile.cpp (pile_box::compute_metrics,
	matrix_box::compute_metrics): Fix rounding.

2013-01-07  Deri James  <deri@chuzzlewit.myzen.co.uk>

	* tmac/europs.tmac: Protect against missing fonts.

2013-01-07  Deri James  <deri@chuzzlewit.myzen.co.uk>

	* font/devpdf/util/BuildFoundries.pl (LoadFoundry): Improve
	warning.

2013-01-07  Werner LEMBERG  <wl@gnu.org>

	[tbl] Allow characters #, `, and ' as eqn delimiters.

	While problems ` and ' have been unintentionally introduced rather
	recently, the limitation regarding # was there from the beginning.

	At the same time, fix a small bug causing `.lf' requests not
	starting a line.

	* src/preproc/tbl/table.cpp (table::init_output)
	(table::compute_expand_width, table::compute_separation_factor)
	(table::define_bottom_macro, table::do_bottom): Temporarily switch
	off eqn delimiters, wrapping the code into a `.ig' block.  This
	uses the new functionality just added to eqn.

	* src/preproc/eqn/eqn.man, src/preproc/tbl/tbl.man: Updated.

2013-01-06  Werner LEMBERG  <wl@gnu.org>

	[eqn] Add `delim on'.

	* src/preproc/eqn/lex.cpp (start_delim_saved, end_delim_saved):
	New global variables.
	(do_delim): Handle `delim on' to restore previous start and end
	delimiters.

	* src/preproc/eqn/eqn.man, NEWS: Document it.

2013-01-02  Deri James  <deri@chuzzlewit.myzen.co.uk>

	[gropdf] Various minor fixes.

	* src/devices/gropdf/gropdf (do_x) <'X'> <'pdfpic'>: Using

	\X'pdf: pdfpic'

	with a zero width now works correctly.

	(LoadPDF): Scale width in proportion to given height.

	(do_s): In some circumstances a font size change is emitted before
	current font is established.  Fix handles this situation.

2012-12-30  Werner LEMBERG  <wl@gnu.org>

Version 1.22.1 released
=======================

	Due to CVE-2012-3386, ftp.gnu.org rejected uploading of version
	1.22 -- in other words, 1.22 has never been released.

	* NEWS, REVISION, doc/groff.texinfo, doc/webpage.ms: Updated.

	* Makefile.in (NOMAKEDIRS): Updated.

2012-12-30  Werner LEMBERG  <wl@gnu.org>

	* src/libs/gnulib/*: Update `gnulib' files.

	Because we currently don't support `gnulib-tool' directly but add
	everything to the CVS repository, and many internal details of the
	gnulib setup has changed, it is necessary to do redo the import.

	. Temporarily rename `src/libs/gnulib' to `src/libs/gnulib.old'.

	. Call

	    gnulib-tool --create-testdir \
	                --dir=src/libs/gnulib \
	                wcwidth

	. Manually move directories `src/libs/gnulib/gl{lib,m4}' to
	`src/libs/gnulib/{lib,m4}', and do `s/gllib/lib/' and `s/glm4/m4/'
	in all files to `convert' the gnulib testbed to a standard gnulib
	configuration as maintained by gnulib-tool.  Additionally, remove
	the directory `src/libs/gnulib/gltests' and the references to
	`gltests' in all files.

	(All of this could be done with a script, but I hope that this is
	eventually replaced with migrating groff as a whole to gnulib and
	its setup).

	. Call

	    gnulib-tool --add-import \
	                --dir=src/libs/gnulib \
	                wcwidth

	to update everything.

	. Merge the changed, new, and deleted files into `gnulib.old',
	delete `gnulib', rename `gnulib.old' to `gnulib', then commit.

2012-12-28  Werner LEMBERG  <wl@gnu.org>

	[doc] More documentation generation rules.

	* doc/Makefile.in (.texinfo.txt): New rule.
	(.texinfo.html): Use `LANG='.
	(split-html): New target.

2012-12-28  Werner LEMBERG  <wl@gnu.org>

	* doc/fixinfo.sh: Make it work with makinfo 4.13 also.

2012-12-28  Werner LEMBERG  <wl@gnu.org>

	Split ChangeLog.

	* ChangeLog: Split off older entries into...
	* ChangeLog.121: this new file.

2012-12-28  Werner LEMBERG  <wl@gnu.org>

Version 1.22 released
=====================

	* NEWS, VERSION, doc/groff.texinfo, doc/webpage.ms: Updated.

	* config.guess, config.sub: Updated from `config' repository.

	* INSTALL.gen: Updated from `gnulib' repository (file `INSTALL').

	* aclocal.m4, configure: Regenerated.

	* doc/texinfo.tex: Updated from `texinfo' repository.

	* src/roff/groff/groff.cpp (main) <'v'>: Update copyright year.

2012-12-27  Bjarni Ingi Gislason  <bjarniig@rhi.hi.is>

	* man/groff_font.man: Typographical improvements and typos.

2012-12-27  Bjarni Ingi Gislason  <bjarniig@rhi.hi.is>

	* man/ditroff.man: Typographical improvements and typos.

2012-12-18  Bjarni Ingi Gislason  <bjarniig@rhi.hi.is>

	* man/groff_diff.man: Typographical improvements and typos.

2012-12-16  Bjarni Ingi Gislason  <bjarniig@rhi.hi.is>

	* man/groff.man: Typographical improvements (and one typo).
	* man/groff_char.man: Typographical improvements.

2012-10-17  Deri James  <deri@chuzzlewit.myzen.co.uk>

	* src/devices/gropdf/gropdf.pl (do_D): The command \D't N' moves
	horizontal position by 'N'.  gropdf now obeys this rule.
	(do_t): Fixed kerning issue where width of non-kerned text could
	be wrongly calculated using previous kern factor.

2012-09-21  Werner LEMBERG  <wl@gnu.org>

	* doc/groff.texinfo: Improve documentation of `.ad'.

2012-09-20  Werner LEMBERG  <wl@gnu.org>

	* doc/Makefile.sub (uninstall_sub): Fix removal of info files.

2012-09-20  Werner LEMBERG  <wl@gnu.org>

	Simplify environment handling.

	Suggested by Ivan Shmakov <oneingray@gmail.com>.

	* doc/Makefile.in, doc/Makefile.sub (GROFF): Don't use export.

2012-09-20  Deri James  <deri@chuzzlewit.myzen.co.uk>

	[gropdf] Various minor fixes.

	* font/devpdf/Foundry.in: Add font path to debian `gsfonts'
	package.

	* font/devpdf/util/BuildFoundries.pl: Handle missing fonts in a
	more sane way, do NOT abort the complete make run!

	* src/devices/gropdf/gropdf: Accept papersize names (i.e. A4) as
	either upper or lower case.  The -p (papersize) option should be
	length,width (currently reversed - width,length)

	* src/devices/gropdf/pdfmom.pl: Support use of GROFF_BIN_PATH.

2012-09-11  Ralph Corderoy  <ralph@inputplus.co.uk>
	    Werner LEMBERG <wl@gnu.org>

	* src/preproc/tbl/tbl.man: Better document `d' column specifier.

2012-08-31  Deri James  <deri@chuzzlewit.myzen.co.uk>

	Add `pdfmom' to handle mom documents with gropdf.

	* Makefile.in (OTHERDIRS): Move contrib/mom to be run after
	devices/gropdf.

	* src/devices/gropdf/gropdf.pl: Various fixes:

	. Correct image scaling issue.
	. Handle relative horizontal movement 'h' followed by absolute
	vertical movement 'V'.
	. Correct handling of track kerning.

	* src/devices/gropdf/pdfmom.pl: New wrapper for mom (pdfmom)
	using gropdf or grops driver.
	* src/devices/gropdf/pdfmom.man: New man page.
	* src/devices/gropdf/Makefile.sub: Updated to handle new files.

2012-08-31  Deri James  <deri@chuzzlewit.myzen.co.uk>

	* Makefile.in (OTHERDIRS): Move contrib/mom to be run after
	devices/gropdf.

	* src/devices/gropdf/gropdf.pl: Various fixes:

	. Correct image scaling issue.
	. Handle relative horizontal movement 'h' followed by absolute
	    vertical movement 'V'.
	. Correct handling of track kerning.

	* src/devices/gropdf/pdfmom.pl: New wrapper for mom (pdfmom)
	using gropdf or grops driver.
	* src/devices/gropdf/pdfmom.man: New man page.
	* src/devices/gropdf/Makefile.sub: Updated to handle new files.

2012-08-31  Julien Moutinho  <julm+groff@autogeree.net>

	* tmac/www.tmac (www-push-li): Fix indentation.

	See

	http://lists.gnu.org/archive/html/bug-groff/2012-08/msg00009.html

	for the full report.

2012-08-08  Eric S. Raymond  <esr@thyrsus.com>

	TBLization, as discussed on the list.  There's a rewrite of
	this file in planning, but this gets the content clean for now.

	* tmac/groff_mdoc.man: In this file.

2012-08-09  Werner LEMBERG  <wl@gnu.org>

	Provide proper Unicode mapping from and to dotless j.

	* src/libs/libgroff/glyphuni.cpp (glyph_to_unicode_list),
	src/libs/libgroff/uniglyph.cpp (unicode_to_glyph_list): Add it.

2012-08-08  Eric S. Raymond  <esr@thyrsus.com>

	Added Unicode code point for dotless j.

	* man/groff_char.man: In this file.

2012-08-08  Werner LEMBERG  <wl@gnu.org>

	* man/groff_char.man: Clean-ups.

2012-08-08  Eric S. Raymond  <esr@thyrsus.com>

	Elimination of nasty presentation-level macro tangles makes
	structural translation to XML possible.

	* man/groff_char.man: Clean up the mess, use real TBL tables.

2012-07-23  Eric S. Raymond  <esr@thyrsus.com>

	More elimination of low-level troff hackery in the documentation
	so it can be lifted to structural markup.

	* tmac/groff_me.man: Use TBL rather than wacky diversions and .ti
	requests.

2012-07-24  Werner LEMBERG  <wl@gnu.org>

	Fix appearance of groff.texinfo's HTML output.

	Cartouches within an `example' environment don't work.

	* doc/groff.texinfo (CartoucheExample, endCartoucheExample): New
	macros.  Use them where appropriate.

2012-07-17  Ingo Schwarze  <schwarze@usta.de>

	[mdoc] Make `Fl' correctly restore fonts.

	* tmac/doc.tmac (doc-flag-recursion): Do it.

2012-07-07  Eric S. Raymond  <esr@thyrsus.com>

	* src/preproc/eqn/eqn.man, src/preproc/grn/grnn.man,
	src/devices/grodvi/grodvi.man, src/devices/grolj4/grolj4.man,
	src/devices/grops/grops.man, src/utils/lkbib/lkbib.man,
	src/utils/indxbib/indxbib.man, src/utils/tfmtodit/tfmtodit.man,
	src/utils/xtotroff/xtotroff.man:
	Remove running text in the synopses of various manual pages,
	as it badly screws up attempts to mechanically parse them.

	* contrib/mom/groff_mom.man: Use .URL rather than .UR/.UE, as this
	is now preferred for manual pages.

2012-07-03  Werner LEMBERG  <wl@gnu.org>

	Fix Unicode mapping of Greek stroked and curly phi.

	Problem reported by Alkis Georgopoulos <alkisg@gmail.com>;
	see

	https://bugs.launchpad.net/ubuntu/+source/groff/+bug/1008115

	* src/libs/libgroff/uniglyph.cpp (unicode_to_glyph_list): Flip
	values of U+03C6 and U+03D5.

2012-06-13  Deri James  <deri@chuzzlewit.demon.co.uk>

	* src/devices/gropdf/gropdf.pl: When using variable page
	sizes (with \X'papersize ...') ensure final page is correct
	size.

2012-05-24  Werner LEMBERG  <wl@gnu.org>

	* src/roff/grog/grog.pl (process): Fix .so handling.

	This does the same as the previous commit.

2012-05-24  Denis M. Wilson  <dmw@oxytropis.plus.com>

	* src/roff/grog/grog.sh: Fix .so handling.

	See

	http://lists.gnu.org/archive/html/bug-groff/2012-05/msg00000.html

	for the report and the bug fix.

2012-05-24  Ivan Shmakov  <oneingray@gmail.com>

	Add some generic fallback characters.

	* tmac/fallbacks.tmac: New file.
	* tmac/troffrc: Include it.
	* tmac/Makefile.sub (NORMALFILES): Include it.

2012-05-20  Deri James  <deri@chuzzlewit.demon.co.uk>

	* doc/groff.texinfo: Add extra info about `.asciify'.
	Document new gropdf options -u and -s.

	* src/devices/gropdf/gropdf.man: Remove references to Type 42
	fonts, they do not work in PDFs.

	Document new option -s which adds `statistics' line to end of PDF
	file showing number of pages in document.  This has always been
	the default behaviour (to add this line), all other software seems
	to ignore it as intended, but `gs' sometimes complains, so the
	default is now to omit the statistics.

	Document new option -u[cmapfilename] to allow a user ToUnicode
	CMap instead of gropdf's default.  If no `cmapfilename' given then
	do not include any ToUnicode CMap.

	* src/devices/gropdf/gropdf.pl <top>: Allow `bundled' flags on
	command line (i.e. -de = -d -e).

	Use $RT_SEP as multi path separator, not hard coded `:'.  Update
	all users.

	New flags -u and -s.  Once a custom papersize has been set as
	\X'papersize x,y' make it sticky so all following pages use custom
	size.  When importing pdf with \X'pdf: pdfpic ...' do not compress
	objects which are already compressed! This caused problems with
	PDFs created with ImageMagick, now fixed.

	(IsText, PutLine, do_t): The troff `u' command can contain a
	kerning adjustment number, this was not being handled, now fixed.

	(do_c): The troff `c' command was not being handled correctly, now
	fixed.
	(FindChar, RemapChr, do_N): Handle fonts with more than 255 glyphs.
	($ucmap): Define CMap ToUnicode to convert ligatures
	(fl,fi,ff,ffl,ffi) back to individual characters, useful for
	cut'n'paste and text searching.
	(LoadFont): Handle it.
	(ToPoints, GetPoints): Handle `z' unit.
	(do_x, FixPDFColour, PutHotSpot): Allow Annotation colour to be
	groff colour, i.e. 0-65535 *3, or #rrggbb, or #rrrrbbbbgggg.
	(do_p):The papersize width/length in switch -p were reversed,
	corrected.

	* src/devices/gropdf/Makefile.sub (gropdf): Use $RT_SEP.
	Use $fontpath rather than $fontdir (this ensures site-font is
	included in searches).

	* tmac/pdf.tmac (PDFBOOKMARK.VIEW, PDFHREF.VIEW, PDFPAGE.Y): Fix
	strings.
	(pdfbookmark): Correct handling of bookmark levels.
	Convert \[em] to hyphen in bookmarks

	Rather use -N than -T for "named" bookmarks (-T already used for
	"tag" in pdfmark.tmac)

	(.pdfclean): New macro which attempts to asciify bookmark text.
	(.pdfpagename): New wrapper macro for \X'pdf: pagename'.
	(.pdfswitchtopage): New wrapper macro for \X'pdf: switchtopage'.

2012-03-10  Werner LEMBERG  <wl@gnu.org>

	Fix compiler warnings.

	* src/preproc/html/pre-html.cpp (alterDeviceTo): Avoid ambiguous
	if-else clause.

	* src/preproc/grn/main.cpp (sccsid): Comment out.

	* src/roff/troff/number.cpp (parse_expr) <case '*'>: Add cast.

	* src/devices/xditview/Makefile.sub (EXTRA_CFLAGS): Add `-Dlint'
	so that unused static ID arrays don't cause a warning.

	(Some) problems reported by Bjarni Ingi Gislason
	<bjarniig@rhi.hi.is>.

2012-03-05  Werner LEMBERG  <wl@gnu.org>

	* tmac/an-ext.tmac (SY): Handle argument with spaces correctly.

	Problem reported by Bjarni Ingi Gislason <bjarniig@rhi.hi.is>.

2012-03-01  Bjarni Ingi Gislason  <bjarniig@rhi.hi.is>

	[an-old] Fix warnings.

	* tmac/an-old.tmac (an-init): Insert missing braces.

2012-02-26  Werner LEMBERG  <wl@gnu.org>

	Update configuration files from `gnulib' and `config' repositories.

	This also fixes a problem with `iconv' on Solaris 10, as reported
	in

	http://lists.gnu.org/archive/html/bug-groff/2012-02/msg00007.html

	* configure.ac: Call `gl_LOCALCHARSET.
	Call `AM_ICONV' as C++.

	* config.guess, config.rpath, config.sub, install-sh, mkinstalldir:
	Updated.

	* m4/codeset.m4, m4/glib21.m4, m4/iconv.m4, m4/lib-ld.m4,
	m4/lib-link.m4, m4/lib-prefix.m4: Updated.
	* m4/fcntl-o.m4, m4/localcharset.m4: New files.

	* Makefile.in: Updated.

	* src/include/localcharset.h, src/libs/libgroff/config.charset,
	src/libs/libgroff/localcharset.c: Updated.

	* aclocal.m4, configure, src/include/config.hin: Regenerated.

2012-02-20  Werner LEMBERG  <wl@gnu.org>

	Update `gnulib' files.

	The invocation was

	gnulib-tool --add-import \
	              --dir=src/libs/gnulib \
	              wcwidth

	Additionally, src/libs/gnulib/configure.ac was adjusted from a
	`test' run as described in the change from 2010-12-13.

	* src/libs/gnulib/*: Updated.

2012-02-15  Deri James  <deri@chuzzlewit.demon.co.uk>

	[gropdf] Fixes and omissions.

	* src/devices/gropdf/gropdf.pl (<top>, do_u): Add facility to
	handle track kerning (.tkf).

	(do_x, do_p, do_t): If pages are reordered using `pagename' and
	`switchtopage' keep track of outline bookmarks.
	(do_x): Handle multiple files on gropdf command line, stitch
	multiple groff_out files together.  In the main read loop any argc
	values not consumed by options are taken as input files and
	processed in order.  What prevented it working properly before is
	the way an `x i' (initialize) record has been handled.  It now
	processes the initialization code only in the first file.

	(PutHotSpot): Allow user to control size of hotspot bounding box
	on clickable links by setting PDFHREF.LEADING

	* tmac/pdf.tmac (PDFHREF.LEADING): Adjust value.
	(pdf*href): Pass value of PDFHREF.LEADING to gropdf.

2012-02-10  Deri James  <deri@chuzzlewit.demon.co.uk>

	[gropdf] Fix compatibility issues with pdfmark.

	* tmac/pdf.tmac (PDFHREF.VIEW.LEADING): Fix value.
	(pdf:href.opt-X): Add check for -X option for .pdfhref.

2012-02-08  Werner LEMBERG  <wl@gnu.org>

	* src/preproc/pic/main.cpp (do_file): Check for invalid characters.

	Problem reported by Doug McIlroy <doug@cs.dartmouth.edu>.

2012-01-25  Ingo Schwarze  <schwarze@usta.de>

	[mdoc] * tmac/doc-syms: Fix meaning of XBD acronym.

2012-01-25  Tadziu Hoffmann  <hoffmann@usm.uni-muenchen.de>

	* tmac/e.tmac (bl): Make it work inside blocks.

	See threads starting with

	http://lists.gnu.org/archive/html/groff/2011-12/msg00055.html
	http://lists.gnu.org/archive/html/groff/2012-01/msg00000.html

2012-01-10  Bruno Haible  <bruno@clisp.org>

	Fix handling of MAKEFLAGS variable.

	* Makefile.in (MAKE_K_FLAGS): Improved definition,
	as explained and discussed in

	http://lists.gnu.org/archive/html/groff/2012-01/msg00039.html

2012-01-03  Ingo Schwarze  <schwarze@usta.de>

	Improve parallel builds.

	Some hdtbl and mom examples want PostScript formatting which
	requires the `DESC' file to be ready; however, the top-level
	`Makefile.in' doesn't currently enforce the proper order of
	building of `font/dev' before `contrib/hdtbl', `contrib/mom', and
	so on.

	Given that `font/dev' and the contrib examples are in different
	child processes of the recursive make system, it doesn't seem
	possible to solve this using clean Makefile dependencies.  We now
	enforce the order by splitting the shell command invoking
	recursive make in the top level `Makefile.in'.

	* Makefile.in (ALLDIRS): Remove `OTHERDIRS'.
	(dodirs): Updated.
	(`$(TARGETS)'): Handle `OTHERDIRS' separately.

2012-01-03  Kristaps Dzonsons  <kristaps@bsd.lv>

	[mdoc] Add `-isoC-2011'.

	* tmac/doc-syms (doc-str-St--isoC-2011): Add it.
	* tmac/groff_mdoc.man: Document it.

2011-12-26  Deri James  <deri@chuzzlewit.demon.co.uk>

	* font/devpdf/Makefile.sub: Only build fonts on first `make'.

2011-12-08  Werner LEMBERG  <wl@gnu.org>

	* doc/groff.texinfo (.tl): Improve documentation.
	Wording suggested by Keith Marshall
	<keithmarshall@users.sourceforge.net>.

2011-12-01  Werner LEMBERG  <wl@gnu.org>

	[me] Fix behaviour of centered block.
	Problem and possible fix reported in thread starting at

	http://lists.gnu.org/archive/html/groff/2011-11/msg00002.html

	* tmac/e.tmac (`(c'): Always start with a new line.

2011-12-01  Ingo Schwarze  <schwarze@usta.de>

	[man] Print volume headers like mdoc.

	* tmac/an-old.tmac (an-init): Add default volume name if fifth
	argument to `.TH' is missing.

2011-11-22  Werner LEMBERG  <wl@gnu.org>

	* tmac/groff_man.man: Minor documentation improvements.
	Suggested by Jeff Conrad <jeff_conrad@msn.com>.

2011-11-14  Werner LEMBERG  <wl@gnu.org>

	* doc/groff.texinfo: Improve doc for calling undefined identifiers.

2011-11-14  Werner LEMBERG  <wl@gnu.org>

	* src/preproc/tbl/tbl.man: Improve documentation of `_' and
	friends.

2011-10-31  Werner LEMBERG  <wl@gnu.org>

	Fix compiler warnings.

	* src/preproc/eqn/main.cpp (do_file), src/roff/troff/env.cpp
	(environment::print_env), src/roff/troff/mtsm.cpp
	(statem::display_state): Add syntactical sugar.

	* src/utils/tfmtodit/tfmtodit.cpp (char_info_word): Use `unsigned
	char' for all members.

	* src/devices/grohtml/html-text.cpp (html_text::remove_def):
	Remove unused variable `q'.

	* src/devices/grohtml/post-html.cpp
	(html_printer::lookahead_for_tables): Remove unused variable `left'
	and `seen_text'.

2011-10-23  Ingo Schwarze  <schwarze@openbsd.org>

	[mdoc] Synchronize string tables with the mandoc(1) utility.

	* tmac/doc-common: Add many architecture names used in NetBSD and
	OpenBSD (and "arm" from FreeBSD) and remove the duplicate OS
	version entry for Darwin-10.6.0.

	* tmac/doc-syms: Add many library names used in NetBSD and FreeBSD.

	* tmac/groff_mdoc.man: Document all supported architecture names)
	(OS versions, and library names.

2011-09-11  Joseph Koshy  <jkoshy@users.sourceforge.net>

	[mdoc] Add some library strings.

	* tmac/doc-syms: Add `libdwarf' and `libelf'.
	* tmac/groff_mdoc.man: Document them.

2011-08-14  Deri James  <deri@chuzzlewit.demon.co.uk>

	[gropdf] More minor fixes.

	* font/devpdf/Makefile.sub (MOSTLYCLEANADD): Don't attempt to
	install 'util/BuildFoundries', only used in 'make'.

	* src/devices/gropdf/gropdf.pl (<top>, GetType1): Make STDOUT and
	any font files read to be accessed in binary rather than text mode.
	Prevents errors when running on systems set up for UTF-8.

2011-08-10  Deri James  <deri@chuzzlewit.demon.co.uk>

	[gropdf] Minor updates and fixes.

	* src/devices/gropdf/gropdf.pl: Change command line option `-fy'
	to `-y' for consistency.

	Better support for Windows platform.
	(do_x): Handle keywords `pagename' and `switchtopage'.

	* doc/groff.texinfo, src/devices/gropdf/gropdf.man: Updated.

	* font/devpdf/Foundry: Renamed to...
	* font/devpdf/Foundry.in: This.
	Add default alias font names.

	* font/devpdf/util/BuildFoundries.pl: This is now an installation
	helper script and gets not longer installed.
	Support alternative font file names (separated with `!').

	* font/devpdf/Makefile.sub: Fixes to work with a separate build
	directory.
	Font files are now build at `make' time; this makes `test-groff'
	work with -Tpdf.

	* font/devpdf/util/Makefile.sub: Removed.

	* Makefile.in (DEVDIRS, OTHERDIRS, EXTRADIRS): Handle devpdf
	specially.

2011-07-29  Daiki Ueno  <ueno@unixuser.org>

	Fix cross building.  Problem reported by Christophe Jarry
	<christophe.jarry@ouvaton.org>.

	* Makefile.in ($GNULIBDIRS): Pass original config arguments to
	src/libs/gnulib/configure.

2011-06-25  Deri James  <deri@chuzzlewit.demon.co.uk>

	Add new output device `gropdf'.

	* font/devpdf/*: New device files for gropdf.
	* src/devices/gropdf/*: New device.

	* Makefile.comm (install_dev, uninstall_dev): Handle more
	subdirectories.
	* Makefile.in (DEVDIRS, OTHERDIRS, EXTRADIRS): Add directories
	related to gropdf.
	* MANIFEST: Updated.
	* test-groff.in (GROFF_BIN_PATH): Updated.

	* tmac/Makefile.sub (NORMALFILES): Updated.
	* tmac/pdf.tmac: New file.
	* tmac/troffrc: Updated.

	* doc/groff.texinfo: Document it.
	* doc/Makefile.in, doc/Makefile.sub (groff_bin_dirs): Udpated.
	* doc/pic.ms: Updated.

	* man/groff_out.man, src/devices/grops/grops.man,
	src/preproc/pic/pic.man, src/roff/groff/groff.man,
	src/utils/afmtodit/afmtodit.man, src/utils/pfbtops/pfbtops.man:
	Updated.

	* contrib/pdfmark/pdfmark.ms: Updated.

2011-07-20  George HELFFRICH  <ghfbsd@gmail.com>

	Improve line numbering support in tbl and with me macros.

	* tmac/e.tmac (n1, n2, TH, PS): Implement it.
	(@h, @n, @o, @t, @k, )b, (c, (q, )q, (l, )l, (f, @q, PE): Updated.
	* doc/meref.me: Document changes.

	* src/preproc/tbl/table.cpp (ROW_START_LINE_REG)
	(ROW_SAVE_LINE_REG, ROW_MAX_LINE_REG, REPEATED_NM_SET_MACRO)
	(REPEATED_NM_SUS_MACRO): New macros.

	(table::init_output): Define REPEATED_NM_SET_MACRO and
	REPEATED_NM_SUS_MACRO.
	(table::print_single_hline, table::print_double_hline,
	table::define_bottom_macro, table::do_row, table::do_top,
	table::do_bottom): Updated.

	* doc/webpage.ms: Updated.

2011-07-12  Ted Harding  <ted.harding@wlandres.net>
	    Werner LEMBERG <wl@gnu.org>

	* src/preproc/tbl/tbl.man: Mention trick to get abutting rules.

2011-07-03  Ben Laurie  <benl@FreeBSD.org>

	Fix clang warnings.

	* src/libs/libdriver/input.cpp (odd): Use parentheses.

	* src/roff/troff/mtsm.cpp (state_set::is_in): Fix parentheses;
	previous code always tested for bit 0.

2011-07-03  Guillem Jover  <guillem@debian.org>

	mdoc: Update more OS versions strings.

	* tmac/doc-common: Add versions strings for NetBSD, OpenBSD,
	FreeBSD, and DragonFly.

2011-04-08  Michail Vidiassov  <master@iaas.msu.ru>

	mdoc: Update various strings related to Mac OS X and FreeBSD.

	* tmac/doc-common: Add strings for FreeBSD 8.2 and Darwin 9.7-11.0.
	* tmac/doc-syms: Add strings -lbsm and -lSystem.

2011-03-29  Christian Weisgerber  <naddy@mips.inka.de>

	Fix compilation issues with gcc 2.95.

	* src/roff/troff/input.cpp (my_input_iterator): Define as an alias
	for `input_iterator' which is predefined by an old libstdc++.

2011-03-29  Ingo Schwarze  <schwarze@usta.de>

	Add another POSIX standard.

	* tmac/doc-syms: Add POSIX 1003.1b.

2011-03-29  Christian Weisgerber  <naddy@mips.inka.de>

	Fix build with non-GNU make.

	* Makefile.in ($TARGETS): We must not pass `$MDEFINES' recursively
	down to the sub-makes started in src/libs/gnulib, because that
	directory has its own values for `$top_srcdir' etc., and
	overriding those from the command line will cause the build to
	fail.  Currently, `$MAKEOVERRIDES' will prevent the recursive
	passing of those overrides with GNU make, but not with other
	make(1) implementations.  It looks like all targets that require
	`$MDEFINES' set them explicitly anyway, so we shouldn't need to
	set `$MDEFINES' on the top level.

2011-03-21  Jan Vcelak  <jvcelak@redhat.com>
	    Bernd Warken <groff-bernd.warken-72@web.de>

	[groffer] Remove hardcoded path to 'libdir/groff/groffer'
	directory.

	* configure.ac: add GROFFERDIR variables.

	* Makefile.in: add and handle variable groffer_dir

	* m4/groff.m4: set up the --with-grofferdir command line option.

2011-03-18  Werner LEMBERG  <wl@gnu.org>

	[troff] Improve error message.

	* src/roff/troff/input.cc (token::delimiter): Improve error
	message.  Suggested by Doug McIlroy <doug@cs.dartmouth.edu>.

2011-03-04  Werner LEMBERG  <wl@gnu.org>

	[mdoc] Within .An, .Aq, .Ao, and .Ac now use `<' and `>'.
	Problem reported by Ulrich Sprlein <uqs@spoerlein.net>

	* tmac/doc.tmac (Aq, Ao, Ac): Implement it to follow RFC 822 and
	RFC 2822.

2011-02-14  Werner LEMBERG  <wl@gnu.org>

	* doc/groff.texinfo: Add another example for .em request
	Based on a patch from Anton Shepelev <anton.txt@gmail.com>.

2011-01-31  Werner LEMBERG  <wl@gnu.org>

	More fixes for Savannah bug #32301.

	* src/devices/grops/Makefile.sub (XLIBS),
	src/devices/grodvi/Makefile.sub, src/devices/grolj4/Makefile.sub,
	src/devices/grohtml/Makefile.sub, src/devices/grolbp/Makefile.sub:
	Add $(LIBGNU).

2011-01-31  Werner LEMBERG  <wl@gnu.org>

	Fix Savannah bug #32301.

	* src/roff/groff/Makefile.sub (XLIBS),
	src/preproc/grn/Makefile.sub, src/preproc/html/Makefile.sub: Add
	$(LIBGNU).

2011-01-29  Krzysztof elechowski  <giecrilj@stegny.2a.pl>

	* doc/groff.texinfo: Complete documentation on output devices.

2011-01-28  Werner LEMBERG  <wl@gnu.org>

	Handle `refer*.tmac'.

	* tmac/Makefile.sub (NORMALFILES): Add `refer*.tmac'.
	* tmac/refer-mm.tmac: Moved to contrib/mm.

2011-01-28  Werner LEMBERG  <wl@gnu.org>

	Improve `refer' support of -me.

	* tmac/refer.tmac, tmac/refer-me.tmac, tmac/refer-ms.tmac,
	tmac/refer-mm.tmac: New files.  The code in refer.tmac is
	based on the old code from `s.tmac'.

	* tmac/s.tmac: Remove direct refer support and include
	`refer-ms.tmac' instead.
	* tmac/e.tmac: Remove direct refer support and include
	`refer-me.tmac' instead.

	* NEWS: Updated.

2011-01-22  Werner LEMBERG  <wl@gnu.org>

	[groff.texinfo]: Updates.

	* doc/groff.texinfo: Document groff's `-j' option.
	Add dummy section for `chem' preprocessor.

2011-01-22  Werner LEMBERG  <wl@gnu.org>

	Update `grog'.

	* src/roff/grog/{groff.sh,groff.pl}: `groff' now calls `pic'
	automatically if `grap' or `chem' is used.
	`chem' has been folded into `groff'.
	* src/roff/grog/grog.man: Updated.

2011-01-22  Werner LEMBERG  <wl@gnu.org>

	Make `groff -G' imply `-p'.

	* src/roff/groff/groff.cpp (main): Implement it.
	* src/roff/groff/groff.man: Updated.

2011-01-22  Werner LEMBERG  <wl@gnu.org>

	Integrate `chem' into `groff' (new option -j).

	* src/roff/groff/groff.cpp (CHEM_INDEX): New constant.
	(main) ['j']: Add `chem'.
	(synopsis, help): Updated.
	* src/roff/troff/pipeline.h (MAX_COMMANDS): Increase to 14.

	* src/roff/groff/groff.man: Document new command line option.
	* NEWS: Updated.

2011-01-22  Werner LEMBERG  <wl@gnu.org>

	* doc/groff.texinfo: `chem' is now part of groff.

2011-01-22  Werner LEMBERG  <wl@gnu.org>

	* doc/groff.texinfo: Improve description of `.de'.

	Based on suggestions by Ted Harding and Deri James.

2011-01-20  Colin Watson  <cjwatson@debian.org>

	Fix handling of wide characters in no-SGR mode.

	* src/devices/grotty/tty.cpp (tty_printer::make_underline): Only
	emit a single backspace in no-SGR mode.  less (at least)
	backspaces over a character at a time.
	(tty_printer::make_bold): Likewise.

2011-01-19  Werner LEMBERG  <wl@gnu.org>

	* src/preproc/pic/pic.man: Add pic manual to `SEE ALSO' section.

2011-01-14  Werner LEMBERG  <wl@gnu.org>

	Split ChangeLog.

	* ChangeLog: Split off older entries into...
	* ChangeLog.119, ChangeLog.120: these new files.

2011-01-15  Colin Watson  <cjwatson@debian.org>

	* Makefile.comm (INCLUDES): Fix typo.

2011-01-05  Werner LEMBERG  <wl@gnu.org>

	* doc/webpage.ms: Fix rendering of title image.


________________________________________________________________________

##### License

Copyright 2011-2018 Free Software Foundation, Inc.

Copying and distribution of this file, with or without modification,
are permitted in any medium without royalty provided the copyright
notice and this notice are preserved.


##### Editor settings
Local Variables:
fill-column: 72
mode: change-log
version-control: never
End:
vim:set autoindent textwidth=72:
